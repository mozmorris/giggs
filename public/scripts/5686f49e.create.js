!function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,this.each(h?function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}:function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:0>d?"left":c>0?"right":"center",vertical:0>f?"top":e>0?"bottom":"middle"};l>n&&h(c+d)<n&&(i.horizontal="center"),m>p&&h(e+f)<p&&(i.vertical="middle"),i.important=g(h(c),h(d))>g(h(e),h(f))?"horizontal":"vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||c<h(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||h(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(jQuery),function(a){var b=0,c={},d={};c.height=c.paddingTop=c.paddingBottom=c.borderTopWidth=c.borderBottomWidth="hide",d.height=d.paddingTop=d.paddingBottom=d.borderTopWidth=d.borderBottomWidth="show",a.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var b=this.options;this.prevShow=this.prevHide=a(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),b.collapsible||b.active!==!1&&null!=b.active||(b.active=0),this._processPanels(),b.active<0&&(b.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():a(),content:this.active.length?this.active.next():a()}},_createIcons:function(){var b=this.options.icons;b&&(a("<span>").addClass("ui-accordion-header-icon ui-icon "+b.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(b.header).addClass(b.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),a=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){return"active"===a?void this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b||this.options.active!==!1||this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),void("disabled"===a&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!b)))},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._eventHandler(b);break;case c.HOME:f=this.headers[0];break;case c.END:f=this.headers[d-1]}f&&(a(b.target).attr("tabIndex",-1),a(f).attr("tabIndex",0),f.focus(),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().focus()},refresh:function(){var b=this.options;this._processPanels(),b.active===!1&&b.collapsible===!0||!this.headers.length?(b.active=!1,this.active=a()):b.active===!1?this._activate(0):this.active.length&&!a.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(b.active=!1,this.active=a()):this._activate(Math.max(0,b.active-1)):b.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var c,d=this.options,e=d.heightStyle,f=this.element.parent(),g=this.accordionId="ui-accordion-"+(this.element.attr("id")||++b);this.active=this._findActive(d.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(b){var c=a(this),d=c.attr("id"),e=c.next(),f=e.attr("id");d||(d=g+"-header-"+b,c.attr("id",d)),f||(f=g+"-panel-"+b,e.attr("id",f)),c.attr("aria-controls",f),e.attr("aria-labelledby",d)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(d.event),"fill"===e?(c=f.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.headers.each(function(){c-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===e&&(c=0,this.headers.next().each(function(){c=Math.max(c,a(this).css("height","").height())}).height(c))},_activate:function(b){var c=this._findActive(b)[0];c!==this.active[0]&&(c=c||this.active[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return"number"==typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var c={keydown:"_keydown"};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,c),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e[0]===d[0],g=f&&c.collapsible,h=g?a():e.next(),i=d.next(),j={oldHeader:d,oldPanel:i,newHeader:g?a():e,newPanel:h};b.preventDefault(),f&&!c.collapsible||this._trigger("beforeActivate",b,j)===!1||(c.active=g?!1:this.headers.index(e),this.active=f?a():e,this._toggle(j),d.removeClass("ui-accordion-header-active ui-state-active"),c.icons&&d.children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),f||(e.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),c.icons&&e.children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),e.next().addClass("ui-accordion-content-active")))},_toggle:function(b){var c=b.newPanel,d=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=c,this.prevHide=d,this.options.animate?this._animate(c,d,b):(d.hide(),c.show(),this._toggleComplete(b)),d.attr({"aria-hidden":"true"}),d.prev().attr("aria-selected","false"),c.length&&d.length?d.prev().attr({tabIndex:-1,"aria-expanded":"false"}):c.length&&this.headers.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),c.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(a,b,e){var f,g,h,i=this,j=0,k=a.length&&(!b.length||a.index()<b.index()),l=this.options.animate||{},m=k&&l.down||l,n=function(){i._toggleComplete(e)};return"number"==typeof m&&(h=m),"string"==typeof m&&(g=m),g=g||m.easing||l.easing,h=h||m.duration||l.duration,b.length?a.length?(f=a.show().outerHeight(),b.animate(c,{duration:h,easing:g,step:function(a,b){b.now=Math.round(a)}}),void a.hide().animate(d,{duration:h,easing:g,complete:n,step:function(a,c){c.now=Math.round(a),"height"!==c.prop?j+=c.now:"content"!==i.options.heightStyle&&(c.now=Math.round(f-b.outerHeight()-j),j=0)}})):b.animate(c,h,g,n):a.animate(d,h,g,n)},_toggleComplete:function(a){var b=a.oldPanel;b.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,a)}})}(jQuery),function(a){a.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=f?!0:g?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,void(c=!0);b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:case f.NUMPAD_ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault());if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),void this._change(a))}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(d){d.target===b.element[0]||d.target===c||a.contains(c,d.target)||b.close()})})},menufocus:function(b,c){if(this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)});var d=c.item.data("ui-autocomplete-item");!1!==this._trigger("focus",b,{item:d})?b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(d.value):this.liveRegion.text(d.value)},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item"),d=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d,this.selectedItem=c})),!1!==this._trigger("select",a,{item:c})&&this._value(c.value),this.term=this._value(),this.close(a),this.selectedItem=c}}),this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])
}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):this._trigger("search",b)!==!1?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var b=++this.requestIndex;return a.proxy(function(a){b===this.requestIndex&&this.__response(a),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").append(a("<a>").text(c.label)).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this._value(this.term),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var b;this._superApply(arguments),this.options.disabled||this.cancelSearch||(b=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.text(b))}})}(jQuery),function(a){var b,c="ui-button ui-widget ui-state-default ui-corner-all",d="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",e=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},f=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,e),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var d=this,g=this.options,h="checkbox"===this.type||"radio"===this.type,i=h?"":"ui-state-active";null===g.label&&(g.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(c).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){g.disabled||this===b&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){g.disabled||a(this).removeClass(i)}).bind("click"+this.eventNamespace,function(a){g.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),h&&this.element.bind("change"+this.eventNamespace,function(){d.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return g.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(g.disabled)return!1;a(this).addClass("ui-state-active"),d.buttonElement.attr("aria-pressed","true");var b=d.element[0];f(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return g.disabled?!1:(a(this).addClass("ui-state-active"),b=this,void d.document.one("mouseup",function(){b=null}))}).bind("mouseup"+this.eventNamespace,function(){return g.disabled?!1:void a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){return g.disabled?!1:void((b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",g.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(c+" ui-state-active "+d).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(this.element.prop("disabled",!!b),void(b&&this.buttonElement.removeClass("ui-state-focus"))):void this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?f(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var b=this.buttonElement.removeClass(d),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),e=this.options.icons,f=e.primary&&e.secondary,g=[];e.primary||e.secondary?(this.options.text&&g.push("ui-button-text-icon"+(f?"s":e.primary?"-primary":"-secondary")),e.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+e.primary+"'></span>"),e.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+e.secondary+"'></span>"),this.options.text||(g.push(f?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):g.push("ui-button-text-only"),b.addClass(g.join(" "))}}),a.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(a,b){function c(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},a.extend(this._defaults,this.regional[""]),this.dpDiv=d(a("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function d(b){var c="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return b.delegate(c,"mouseout",function(){a(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate(c,"mouseover",function(){a.datepicker._isDisabledDatepicker(f.inline?b.parent()[0]:f.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))})}function e(b,c){a.extend(b,c);for(var d in c)null==c[d]&&(b[d]=c[d]);return b}a.extend(a.ui,{datepicker:{version:"1.10.4"}});var f,g="datepicker";a.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return e(this._defaults,a||{}),this},_attachDatepicker:function(b,c){var d,e,f;d=b.nodeName.toLowerCase(),e="div"===d||"span"===d,b.id||(this.uuid+=1,b.id="dp"+this.uuid),f=this._newInst(a(b),e),f.settings=a.extend({},c||{}),"input"===d?this._connectDatepicker(b,f):e&&this._inlineDatepicker(b,f)},_newInst:function(b,c){var e=b[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:e,input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:c?d(a("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(b,c){var d=a(b);c.append=a([]),c.trigger=a([]),d.hasClass(this.markerClassName)||(this._attachments(d,c),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(c),a.data(b,g,c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var d,e,f,g=this._get(c,"appendText"),h=this._get(c,"isRTL");c.append&&c.append.remove(),g&&(c.append=a("<span class='"+this._appendClass+"'>"+g+"</span>"),b[h?"before":"after"](c.append)),b.unbind("focus",this._showDatepicker),c.trigger&&c.trigger.remove(),d=this._get(c,"showOn"),("focus"===d||"both"===d)&&b.focus(this._showDatepicker),("button"===d||"both"===d)&&(e=this._get(c,"buttonText"),f=this._get(c,"buttonImage"),c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:f,alt:e,title:e}):a("<button type='button'></button>").addClass(this._triggerClass).html(f?a("<img/>").attr({src:f,alt:e,title:e}):e)),b[h?"before":"after"](c.trigger),c.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput===b[0]?a.datepicker._hideDatepicker():a.datepicker._datepickerShowing&&a.datepicker._lastInput!==b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1}))},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=this._get(a,"dateFormat");g.match(/[DM]/)&&(b=function(a){for(c=0,d=0,e=0;e<a.length;e++)a[e].length>c&&(c=a[e].length,d=e);return d},f.setMonth(b(this._get(a,g.match(/MM/)?"monthNames":"monthNamesShort"))),f.setDate(b(this._get(a,g.match(/DD/)?"dayNames":"dayNamesShort"))+20-f.getDay())),a.input.attr("size",this._formatDate(a,f).length)}},_inlineDatepicker:function(b,c){var d=a(b);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(c.dpDiv),a.data(b,g,c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&this._disableDatepicker(b),c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,d,f,h){var i,j,k,l,m,n=this._dialogInst;return n||(this.uuid+=1,i="dp"+this.uuid,this._dialogInput=a("<input type='text' id='"+i+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),n=this._dialogInst=this._newInst(this._dialogInput,!1),n.settings={},a.data(this._dialogInput[0],g,n)),e(n.settings,f||{}),c=c&&c.constructor===Date?this._formatDate(n,c):c,this._dialogInput.val(c),this._pos=h?h.length?h:[h.pageX,h.pageY]:null,this._pos||(j=document.documentElement.clientWidth,k=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,m=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[j/2-100+l,k/2-150+m]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),n.settings.onSelect=d,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],g,n),this},_destroyDatepicker:function(b){var c,d=a(b),e=a.data(b,g);d.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),a.removeData(b,g),"input"===c?(e.append.remove(),e.trigger.remove(),d.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===c||"span"===c)&&d.removeClass(this.markerClassName).empty())},_enableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,g);e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!1,f.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().removeClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}))},_disableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,g);e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!0,f.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().addClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}),this._disabledInputs[this._disabledInputs.length]=b)},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]===a)return!0;return!1},_getInst:function(b){try{return a.data(b,g)}catch(c){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(c,d,f){var g,h,i,j,k=this._getInst(c);return 2===arguments.length&&"string"==typeof d?"defaults"===d?a.extend({},a.datepicker._defaults):k?"all"===d?a.extend({},k.settings):this._get(k,d):null:(g=d||{},"string"==typeof d&&(g={},g[d]=f),void(k&&(this._curInst===k&&this._hideDatepicker(),h=this._getDateDatepicker(c,!0),i=this._getMinMaxDate(k,"min"),j=this._getMinMaxDate(k,"max"),e(k.settings,g),null!==i&&g.dateFormat!==b&&g.minDate===b&&(k.settings.minDate=this._formatDate(k,i)),null!==j&&g.dateFormat!==b&&g.maxDate===b&&(k.settings.maxDate=this._formatDate(k,j)),"disabled"in g&&(g.disabled?this._disableDatepicker(c):this._enableDatepicker(c)),this._attachments(a(c),k),this._autoSize(k),this._setDate(k,h),this._updateAlternate(k),this._updateDatepicker(k))))},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(b){var c,d,e,f=a.datepicker._getInst(b.target),g=!0,h=f.dpDiv.is(".ui-datepicker-rtl");if(f._keyEvent=!0,a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker(),g=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",f.dpDiv),e[0]&&a.datepicker._selectDay(b.target,f.selectedMonth,f.selectedYear,e[0]),c=a.datepicker._get(f,"onSelect"),c?(d=a.datepicker._formatDate(f),c.apply(f.input?f.input[0]:null,[d,f])):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target),g=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target),g=b.ctrlKey||b.metaKey;break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?1:-1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D"),g=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?-1:1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D"),g=b.ctrlKey||b.metaKey;break;default:g=!1}else 36===b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):g=!1;g&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(b){var c,d,e=a.datepicker._getInst(b.target);return a.datepicker._get(e,"constrainInput")?(c=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),d=String.fromCharCode(null==b.charCode?b.keyCode:b.charCode),b.ctrlKey||b.metaKey||" ">d||!c||c.indexOf(d)>-1):void 0},_doKeyUp:function(b){var c,d=a.datepicker._getInst(b.target);if(d.input.val()!==d.lastVal)try{c=a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,a.datepicker._getFormatConfig(d)),c&&(a.datepicker._setDateFromField(d),a.datepicker._updateAlternate(d),a.datepicker._updateDatepicker(d))}catch(e){}return!0},_showDatepicker:function(b){if(b=b.target||b,"input"!==b.nodeName.toLowerCase()&&(b=a("input",b.parentNode)[0]),!a.datepicker._isDisabledDatepicker(b)&&a.datepicker._lastInput!==b){var c,d,f,g,h,i,j;c=a.datepicker._getInst(b),a.datepicker._curInst&&a.datepicker._curInst!==c&&(a.datepicker._curInst.dpDiv.stop(!0,!0),c&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0])),d=a.datepicker._get(c,"beforeShow"),f=d?d.apply(b,[b,c]):{},f!==!1&&(e(c.settings,f),c.lastVal=null,a.datepicker._lastInput=b,a.datepicker._setDateFromField(c),a.datepicker._inDialog&&(b.value=""),a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight),g=!1,a(b).parents().each(function(){return g|="fixed"===a(this).css("position"),!g}),h={left:a.datepicker._pos[0],top:a.datepicker._pos[1]},a.datepicker._pos=null,c.dpDiv.empty(),c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),a.datepicker._updateDatepicker(c),h=a.datepicker._checkOffset(c,h,g),c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":g?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),c.inline||(i=a.datepicker._get(c,"showAnim"),j=a.datepicker._get(c,"duration"),c.dpDiv.zIndex(a(b).zIndex()+1),a.datepicker._datepickerShowing=!0,a.effects&&a.effects.effect[i]?c.dpDiv.show(i,a.datepicker._get(c,"showOptions"),j):c.dpDiv[i||"show"](i?j:null),a.datepicker._shouldFocusInput(c)&&c.input.focus(),a.datepicker._curInst=c))}},_updateDatepicker:function(b){this.maxRows=4,f=b,b.dpDiv.empty().append(this._generateHTML(b)),this._attachHandlers(b),b.dpDiv.find("."+this._dayOverClass+" a").mouseover();var c,d=this._getNumberOfMonths(b),e=d[1],g=17;b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),e>1&&b.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",g*e+"em"),b.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),b===a.datepicker._curInst&&a.datepicker._datepickerShowing&&a.datepicker._shouldFocusInput(b)&&b.input.focus(),b.yearshtml&&(c=b.yearshtml,setTimeout(function(){c===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml),c=b.yearshtml=null},0))},_shouldFocusInput:function(a){return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(b,c,d){var e=b.dpDiv.outerWidth(),f=b.dpDiv.outerHeight(),g=b.input?b.input.outerWidth():0,h=b.input?b.input.outerHeight():0,i=document.documentElement.clientWidth+(d?0:a(document).scrollLeft()),j=document.documentElement.clientHeight+(d?0:a(document).scrollTop());return c.left-=this._get(b,"isRTL")?e-g:0,c.left-=d&&c.left===b.input.offset().left?a(document).scrollLeft():0,c.top-=d&&c.top===b.input.offset().top+h?a(document).scrollTop():0,c.left-=Math.min(c.left,c.left+e>i&&i>e?Math.abs(c.left+e-i):0),c.top-=Math.min(c.top,c.top+f>j&&j>f?Math.abs(f+h):0),c},_findPos:function(b){for(var c,d=this._getInst(b),e=this._get(d,"isRTL");b&&("hidden"===b.type||1!==b.nodeType||a.expr.filters.hidden(b));)b=b[e?"previousSibling":"nextSibling"];return c=a(b).offset(),[c.left,c.top]},_hideDatepicker:function(b){var c,d,e,f,h=this._curInst;!h||b&&h!==a.data(b,g)||this._datepickerShowing&&(c=this._get(h,"showAnim"),d=this._get(h,"duration"),e=function(){a.datepicker._tidyDialog(h)},a.effects&&(a.effects.effect[c]||a.effects[c])?h.dpDiv.hide(c,a.datepicker._get(h,"showOptions"),d,e):h.dpDiv["slideDown"===c?"slideUp":"fadeIn"===c?"fadeOut":"hide"](c?d:null,e),c||e(),this._datepickerShowing=!1,f=this._get(h,"onClose"),f&&f.apply(h.input?h.input[0]:null,[h.input?h.input.val():"",h]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){var c=a(b.target),d=a.datepicker._getInst(c[0]);(c[0].id!==a.datepicker._mainDivId&&0===c.parents("#"+a.datepicker._mainDivId).length&&!c.hasClass(a.datepicker.markerClassName)&&!c.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||c.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!==d)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,d){var e=a(b),f=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(f,c+("M"===d?this._get(f,"showCurrentAtPos"):0),d),this._updateDatepicker(f))},_gotoToday:function(b){var c,d=a(b),e=this._getInst(d[0]);this._get(e,"gotoCurrent")&&e.currentDay?(e.selectedDay=e.currentDay,e.drawMonth=e.selectedMonth=e.currentMonth,e.drawYear=e.selectedYear=e.currentYear):(c=new Date,e.selectedDay=c.getDate(),e.drawMonth=e.selectedMonth=c.getMonth(),e.drawYear=e.selectedYear=c.getFullYear()),this._notifyChange(e),this._adjustDate(d)},_selectMonthYear:function(b,c,d){var e=a(b),f=this._getInst(e[0]);f["selected"+("M"===d?"Month":"Year")]=f["draw"+("M"===d?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10),this._notifyChange(f),this._adjustDate(e)},_selectDay:function(b,c,d,e){var f,g=a(b);a(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(g[0])||(f=this._getInst(g[0]),f.selectedDay=f.currentDay=a("a",e).html(),f.selectedMonth=f.currentMonth=c,f.selectedYear=f.currentYear=d,this._selectDate(b,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(b){var c=a(b);this._selectDate(c,"")},_selectDate:function(b,c){var d,e=a(b),f=this._getInst(e[0]);c=null!=c?c:this._formatDate(f),f.input&&f.input.val(c),this._updateAlternate(f),d=this._get(f,"onSelect"),d?d.apply(f.input?f.input[0]:null,[c,f]):f.input&&f.input.trigger("change"),f.inline?this._updateDatepicker(f):(this._hideDatepicker(),this._lastInput=f.input[0],"object"!=typeof f.input[0]&&f.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c,d,e,f=this._get(b,"altField");f&&(c=this._get(b,"altFormat")||this._get(b,"dateFormat"),d=this._getDate(b),e=this.formatDate(c,d,this._getFormatConfig(b)),a(f).each(function(){a(this).val(e)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},iso8601Week:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},parseDate:function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(c="object"==typeof c?c.toString():c+"",""===c)return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=-1,q=-1,r=-1,s=-1,t=!1,u=function(a){var c=e+1<b.length&&b.charAt(e+1)===a;return c&&e++,c},v=function(a){var b=u(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e=new RegExp("^\\d{1,"+d+"}"),f=c.substring(i).match(e);if(!f)throw"Missing number at position "+i;return i+=f[0].length,parseInt(f[0],10)},w=function(b,d,e){var f=-1,g=a.map(u(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];return c.substr(i,d.length).toLowerCase()===d.toLowerCase()?(f=b[0],i+=d.length,!1):void 0}),-1!==f)return f+1;throw"Unknown name at position "+i},x=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;e<b.length;e++)if(t)"'"!==b.charAt(e)||u("'")?x():t=!1;else switch(b.charAt(e)){case"d":r=v("d");break;case"D":w("D",l,m);break;case"o":s=v("o");break;case"m":q=v("m");break;case"M":q=w("M",n,o);break;case"y":p=v("y");break;case"@":h=new Date(v("@")),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"!":h=new Date((v("!")-this._ticksTo1970)/1e4),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"'":u("'")?x():t=!0;break;default:x()}if(i<c.length&&(g=c.substr(i),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===p?p=(new Date).getFullYear():100>p&&(p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(k>=p?0:-100)),s>-1)for(q=1,r=s;;){if(f=this._getDaysInMonth(p,q-1),f>=r)break;q++,r-=f}if(h=this._daylightSavingAdjust(new Date(p,q-1,r)),h.getFullYear()!==p||h.getMonth()+1!==q||h.getDate()!==r)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(a,b,c){if(!b)return"";var d,e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=function(b){var c=d+1<a.length&&a.charAt(d+1)===b;return c&&d++,c},j=function(a,b,c){var d=""+b;if(i(a))for(;d.length<c;)d="0"+d;return d},k=function(a,b,c,d){return i(a)?d[b]:c[b]},l="",m=!1;if(b)for(d=0;d<a.length;d++)if(m)"'"!==a.charAt(d)||i("'")?l+=a.charAt(d):m=!1;else switch(a.charAt(d)){case"d":l+=j("d",b.getDate(),2);break;case"D":l+=k("D",b.getDay(),e,f);break;case"o":l+=j("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);
break;case"m":l+=j("m",b.getMonth()+1,2);break;case"M":l+=k("M",b.getMonth(),g,h);break;case"y":l+=i("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":l+=b.getTime();break;case"!":l+=1e4*b.getTime()+this._ticksTo1970;break;case"'":i("'")?l+="'":m=!0;break;default:l+=a.charAt(d)}return l},_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=b+1<a.length&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;b<a.length;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":c+="0123456789";break;case"D":case"M":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_get:function(a,c){return a.settings[c]!==b?a.settings[c]:this._defaults[c]},_setDateFromField:function(a,b){if(a.input.val()!==a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e=this._getDefaultDate(a),f=e,g=this._getFormatConfig(a);try{f=this.parseDate(c,d,g)||e}catch(h){d=b?"":d}a.selectedDay=f.getDate(),a.drawMonth=a.selectedMonth=f.getMonth(),a.drawYear=a.selectedYear=f.getFullYear(),a.currentDay=d?f.getDate():0,a.currentMonth=d?f.getMonth():0,a.currentYear=d?f.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,d){var e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(c){try{return a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),c,a.datepicker._getFormatConfig(b))}catch(d){}for(var e=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,f=e.getFullYear(),g=e.getMonth(),h=e.getDate(),i=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,j=i.exec(c);j;){switch(j[2]||"d"){case"d":case"D":h+=parseInt(j[1],10);break;case"w":case"W":h+=7*parseInt(j[1],10);break;case"m":case"M":g+=parseInt(j[1],10),h=Math.min(h,a.datepicker._getDaysInMonth(f,g));break;case"y":case"Y":f+=parseInt(j[1],10),h=Math.min(h,a.datepicker._getDaysInMonth(f,g))}j=i.exec(c)}return new Date(f,g,h)},g=null==c||""===c?d:"string"==typeof c?f(c):"number"==typeof c?isNaN(c)?d:e(c):new Date(c.getTime());return g=g&&"Invalid Date"===g.toString()?d:g,g&&(g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),this._daylightSavingAdjust(g)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),e===a.selectedMonth&&f===a.selectedYear||c||this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&""===a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_attachHandlers:function(b){var c=this._get(b,"stepMonths"),d="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){var b={prev:function(){a.datepicker._adjustDate(d,-c,"M")},next:function(){a.datepicker._adjustDate(d,+c,"M")},hide:function(){a.datepicker._hideDatepicker()},today:function(){a.datepicker._gotoToday(d)},selectDay:function(){return a.datepicker._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return a.datepicker._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a.datepicker._selectMonthYear(d,this,"Y"),!1}};a(this).bind(this.getAttribute("data-event"),b[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=new Date,P=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth(),O.getDate())),Q=this._get(a,"isRTL"),R=this._get(a,"showButtonPanel"),S=this._get(a,"hideIfNoPrevNext"),T=this._get(a,"navigationAsDateFormat"),U=this._getNumberOfMonths(a),V=this._get(a,"showCurrentAtPos"),W=this._get(a,"stepMonths"),X=1!==U[0]||1!==U[1],Y=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(a,"min"),$=this._getMinMaxDate(a,"max"),_=a.drawMonth-V,ab=a.drawYear;if(0>_&&(_+=12,ab--),$)for(b=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-U[0]*U[1]+1,$.getDate())),b=Z&&Z>b?Z:b;this._daylightSavingAdjust(new Date(ab,_,1))>b;)_--,0>_&&(_=11,ab--);for(a.drawMonth=_,a.drawYear=ab,c=this._get(a,"prevText"),c=T?this.formatDate(c,this._daylightSavingAdjust(new Date(ab,_-W,1)),this._getFormatConfig(a)):c,d=this._canAdjustMonth(a,-1,ab,_)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>":S?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>",e=this._get(a,"nextText"),e=T?this.formatDate(e,this._daylightSavingAdjust(new Date(ab,_+W,1)),this._getFormatConfig(a)):e,f=this._canAdjustMonth(a,1,ab,_)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>":S?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>",g=this._get(a,"currentText"),h=this._get(a,"gotoCurrent")&&a.currentDay?Y:P,g=T?this.formatDate(g,h,this._getFormatConfig(a)):g,i=a.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(a,"closeText")+"</button>",j=R?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Q?i:"")+(this._isInRange(a,h)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+g+"</button>":"")+(Q?"":i)+"</div>":"",k=parseInt(this._get(a,"firstDay"),10),k=isNaN(k)?0:k,l=this._get(a,"showWeek"),m=this._get(a,"dayNames"),n=this._get(a,"dayNamesMin"),o=this._get(a,"monthNames"),p=this._get(a,"monthNamesShort"),q=this._get(a,"beforeShowDay"),r=this._get(a,"showOtherMonths"),s=this._get(a,"selectOtherMonths"),t=this._getDefaultDate(a),u="",w=0;w<U[0];w++){for(x="",this.maxRows=4,y=0;y<U[1];y++){if(z=this._daylightSavingAdjust(new Date(ab,_,a.selectedDay)),A=" ui-corner-all",B="",X){if(B+="<div class='ui-datepicker-group",U[1]>1)switch(y){case 0:B+=" ui-datepicker-group-first",A=" ui-corner-"+(Q?"right":"left");break;case U[1]-1:B+=" ui-datepicker-group-last",A=" ui-corner-"+(Q?"left":"right");break;default:B+=" ui-datepicker-group-middle",A=""}B+="'>"}for(B+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?Q?f:d:"")+(/all|right/.test(A)&&0===w?Q?d:f:"")+this._generateMonthYearHeader(a,_,ab,Z,$,w>0||y>0,o,p)+"</div><table class='ui-datepicker-calendar'><thead><tr>",C=l?"<th class='ui-datepicker-week-col'>"+this._get(a,"weekHeader")+"</th>":"",v=0;7>v;v++)D=(v+k)%7,C+="<th"+((v+k+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+m[D]+"'>"+n[D]+"</span></th>";for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(ab,_),ab===a.selectedYear&&_===a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,E)),F=(this._getFirstDayOfMonth(ab,_)-k+7)%7,G=Math.ceil((F+E)/7),H=X&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=this._daylightSavingAdjust(new Date(ab,_,1-F)),J=0;H>J;J++){for(B+="<tr>",K=l?"<td class='ui-datepicker-week-col'>"+this._get(a,"calculateWeek")(I)+"</td>":"",v=0;7>v;v++)L=q?q.apply(a.input?a.input[0]:null,[I]):[!0,""],M=I.getMonth()!==_,N=M&&!s||!L[0]||Z&&Z>I||$&&I>$,K+="<td class='"+((v+k+6)%7>=5?" ui-datepicker-week-end":"")+(M?" ui-datepicker-other-month":"")+(I.getTime()===z.getTime()&&_===a.selectedMonth&&a._keyEvent||t.getTime()===I.getTime()&&t.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" ui-state-disabled":"")+(M&&!r?"":" "+L[1]+(I.getTime()===Y.getTime()?" "+this._currentClass:"")+(I.getTime()===P.getTime()?" ui-datepicker-today":""))+"'"+(M&&!r||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='click' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!r?"&#xa0;":N?"<span class='ui-state-default'>"+I.getDate()+"</span>":"<a class='ui-state-default"+(I.getTime()===P.getTime()?" ui-state-highlight":"")+(I.getTime()===Y.getTime()?" ui-state-active":"")+(M?" ui-priority-secondary":"")+"' href='#'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I);B+=K+"</tr>"}_++,_>11&&(_=0,ab++),B+="</tbody></table>"+(X?"</div>"+(U[0]>0&&y===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=B}u+=x}return u+=j,a._keyEvent=!1,u},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this._get(a,"changeMonth"),r=this._get(a,"changeYear"),s=this._get(a,"showMonthAfterYear"),t="<div class='ui-datepicker-title'>",u="";if(f||!q)u+="<span class='ui-datepicker-month'>"+g[b]+"</span>";else{for(i=d&&d.getFullYear()===c,j=e&&e.getFullYear()===c,u+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=d.getMonth())&&(!j||k<=e.getMonth())&&(u+="<option value='"+k+"'"+(k===b?" selected='selected'":"")+">"+h[k]+"</option>");u+="</select>"}if(s||(t+=u+(!f&&q&&r?"":"&#xa0;")),!a.yearshtml)if(a.yearshtml="",f||!r)t+="<span class='ui-datepicker-year'>"+c+"</span>";else{for(l=this._get(a,"yearRange").split(":"),m=(new Date).getFullYear(),n=function(a){var b=a.match(/c[+\-].*/)?c+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(b)?m:b},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=d?Math.max(o,d.getFullYear()):o,p=e?Math.min(p,e.getFullYear()):p,a.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)a.yearshtml+="<option value='"+o+"'"+(o===c?" selected='selected'":"")+">"+o+"</option>";a.yearshtml+="</select>",t+=a.yearshtml,a.yearshtml=null}return t+=this._get(a,"yearSuffix"),s&&(t+=(!f&&q&&r?"":"&#xa0;")+u),t+="</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"===c?b:0),e=a.drawMonth+("M"===c?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+("D"===c?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),("M"===c||"Y"===c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&c>b?c:b;return d&&e>d?d:e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(0>b?b:e[0]*e[1]),1));return 0>b&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c,d,e=this._getMinMaxDate(a,"min"),f=this._getMinMaxDate(a,"max"),g=null,h=null,i=this._get(a,"yearRange");return i&&(c=i.split(":"),d=(new Date).getFullYear(),g=parseInt(c[0],10),h=parseInt(c[1],10),c[0].match(/[+\-].*/)&&(g+=d),c[1].match(/[+\-].*/)&&(h+=d)),(!e||b.getTime()>=e.getTime())&&(!f||b.getTime()<=f.getTime())&&(!g||b.getFullYear()>=g)&&(!h||b.getFullYear()<=h)},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick),a.datepicker.initialized=!0),0===a("#"+a.datepicker._mainDivId).length&&a("body").append(a.datepicker.dpDiv);var c=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!==b&&"getDate"!==b&&"widget"!==b?"option"===b&&2===arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c))},a.datepicker=new c,a.datepicker.initialized=!1,a.datepicker.uuid=(new Date).getTime(),a.datepicker.version="1.10.4"}(jQuery),function(a){var b={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},c={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c,d=this;if(this._isOpen&&this._trigger("beforeClose",b)!==!1){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{c=this.document[0].activeElement,c&&"body"!==c.nodeName.toLowerCase()&&a(c).blur()}catch(e){}this._hide(this.uiDialog,this.options.hide,function(){d._trigger("close",b)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(a,b){var c=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return c&&!b&&this._trigger("focus",a),c},open:function(){var b=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var a=this.element.find("[autofocus]");a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement,c=this.uiDialog[0]===b||a.contains(this.uiDialog[0],b);c||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),void this.close(b);if(b.keyCode===a.ui.keyCode.TAB){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(e.focus(1),b.preventDefault()):(d.focus(1),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){d.position=[f.position.left-c.document.scrollLeft(),f.position.top-c.document.scrollTop()],a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){d.height=a(this).height(),d.width=a(this).width(),a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(d){var e=this,f=!1,g={};a.each(d,function(a,d){e._setOption(a,d),a in b&&(f=!0),a in c&&(g[a]=d)}),f&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",g)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return a(b.target).closest(".ui-dialog").length?!0:!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=this,c=this.widgetFullName;a.ui.dialog.overlayInstances||this._delay(function(){a.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(d){b._allowInteraction(d)||(d.preventDefault(),a(".ui-dialog:visible:last .ui-dialog-content").data(c)._focusTabbable())})}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),a.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(a.ui.dialog.overlayInstances--,a.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),a.ui.dialog.overlayInstances=0,a.uiBackCompat!==!1&&a.widget("ui.dialog",a.ui.dialog,{_position:function(){var b,c=this.options.position,d=[],e=[0,0];c?(("string"==typeof c||"object"==typeof c&&"0"in c)&&(d=c.split?c.split(" "):[c[0],c[1]],1===d.length&&(d[1]=d[0]),a.each(["left","top"],function(a,b){+d[a]===d[a]&&(e[a]=d[a],d[a]=b)}),c={my:d[0]+(e[0]<0?e[0]:"+"+e[0])+" "+d[1]+(e[1]<0?e[1]:"+"+e[1]),at:d.join(" ")}),c=a.extend({},a.ui.dialog.prototype.options.position,c)):c=a.ui.dialog.prototype.options.position,b=this.uiDialog.is(":visible"),b||this.uiDialog.show(),this.uiDialog.position(c),b||this.uiDialog.hide()}})}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)
},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=Math.abs(j-t)<=p,e=Math.abs(k-s)<=p,f=Math.abs(h-r)<=p,g=Math.abs(i-q)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=Math.abs(j-s)<=p,e=Math.abs(k-t)<=p,f=Math.abs(h-q)<=p,g=Math.abs(i-r)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}a.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b,c=this.options,d=c.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(d)?d:function(a){return a.is(d)},this.proportions=function(){return arguments.length?void(b=arguments[0]):b?b:b={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},a.ui.ddmanager.droppables[c.scope]=a.ui.ddmanager.droppables[c.scope]||[],a.ui.ddmanager.droppables[c.scope].push(this),c.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];b<c.length;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,c,d){if(!c.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=(a.positionAbs||a.position.absolute).top,i=g+a.helperProportions.width,j=h+a.helperProportions.height,k=c.offset.left,l=c.offset.top,m=k+c.proportions().width,n=l+c.proportions().height;switch(d){case"fit":return g>=k&&m>=i&&h>=l&&n>=j;case"intersect":return k<g+a.helperProportions.width/2&&i-a.helperProportions.width/2<m&&l<h+a.helperProportions.height/2&&j-a.helperProportions.height/2<n;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,b(f,l,c.proportions().height)&&b(e,k,c.proportions().width);case"touch":return(h>=l&&n>=h||j>=l&&n>=j||l>h&&j>n)&&(g>=k&&m>=g||i>=k&&m>=i||k>g&&i>m);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;d<f.length;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;e<h.length;e++)if(h[e]===f[d].element[0]){f[d].proportions().height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions({width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight}))}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery),function(a,b){var c="ui-effects-";a.effects={effect:{}},function(a,b){function c(a,b,c){var d=l[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a)}function d(b){var c=j(),d=c._rgba=[];return b=b.toLowerCase(),o(i,function(a,e){var f,g=e.re.exec(b),h=g&&e.parse(g),i=e.space||"rgba";return h?(f=c[i](h),c[k[i].cache]=f[k[i].cache],d=c._rgba=f._rgba,!1):void 0}),d.length?("0,0,0,0"===d.join()&&a.extend(d,f.transparent),c):f[b]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a}var f,g="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",h=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],j=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},k={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},m=j.support={},n=a("<p>")[0],o=a.each;n.style.cssText="background-color:rgba(1,1,1,.5)",m.rgba=n.style.backgroundColor.indexOf("rgba")>-1,o(k,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),j.fn=a.extend(j.prototype,{parse:function(e,g,h,i){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(g),g=b);var l=this,m=a.type(e),n=this._rgba=[];return g!==b&&(e=[e,g,h,i],m="array"),"string"===m?this.parse(d(e)||f._default):"array"===m?(o(k.rgba.props,function(a,b){n[b.idx]=c(e[b.idx],b)}),this):"object"===m?(e instanceof j?o(k,function(a,b){e[b.cache]&&(l[b.cache]=e[b.cache].slice())}):o(k,function(b,d){var f=d.cache;o(d.props,function(a,b){if(!l[f]&&d.to){if("alpha"===a||null==e[a])return;l[f]=d.to(l._rgba)}l[f][b.idx]=c(e[a],b,!0)}),l[f]&&a.inArray(null,l[f].slice(0,3))<0&&(l[f][3]=1,d.from&&(l._rgba=d.from(l[f])))}),this):void 0},is:function(a){var b=j(a),c=!0,d=this;return o(k,function(a,e){var f,g=b[e.cache];return g&&(f=d[e.cache]||e.to&&e.to(d._rgba)||[],o(e.props,function(a,b){return null!=g[b.idx]?c=g[b.idx]===f[b.idx]:void 0})),c}),c},_space:function(){var a=[],b=this;return o(k,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=j(a),e=d._space(),f=k[e],g=0===this.alpha()?j("transparent"):this,h=g[f.cache]||f.to(g._rgba),i=h.slice();return d=d[f.cache],o(f.props,function(a,e){var f=e.idx,g=h[f],j=d[f],k=l[e.type]||{};null!==j&&(null===g?i[f]=j:(k.mod&&(j-g>k.mod/2?g+=k.mod:g-j>k.mod/2&&(g-=k.mod)),i[f]=c((j-g)*b+g,e)))}),this[e](i)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=j(b)._rgba;return j(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),j.fn.parse.prototype=j.fn,k.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===j?0:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},k.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},o(k,function(d,e){var f=e.props,g=e.cache,i=e.to,k=e.from;j.fn[d]=function(d){if(i&&!this[g]&&(this[g]=i(this._rgba)),d===b)return this[g].slice();var e,h=a.type(d),l="array"===h||"object"===h?d:arguments,m=this[g].slice();return o(f,function(a,b){var d=l["object"===h?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=j(k(m)),e[g]=m,e):j(m)},o(f,function(b,c){j.fn[b]||(j.fn[b]=function(e){var f,g=a.type(e),i="alpha"===b?this._hsla?"hsla":"rgba":d,j=this[i](),k=j[c.idx];return"undefined"===g?k:("function"===g&&(e=e.call(this,k),g=a.type(e)),null==e&&c.empty?this:("string"===g&&(f=h.exec(e),f&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1))),j[c.idx]=e,this[i](j)))})})}),j.hook=function(b){var c=b.split(" ");o(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=j(f||e),!m.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(i){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(i){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=j(b.elem,c),b.end=j(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},j.hook(g),a.cssHooks.borderColor={expand:function(a){var b={};return o(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},f=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function c(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]])for(d=e.length;d--;)c=e[d],"string"==typeof e[c]&&(f[a.camelCase(c)]=e[c]);else for(c in e)"string"==typeof e[c]&&(f[c]=e[c]);return f}function d(b,c){var d,e,g={};for(d in c)e=c[d],b[d]!==e&&(f[d]||(a.fx.step[d]||!isNaN(parseFloat(e)))&&(g[d]=e));return g}var e=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(jQuery.style(a.elem,c,a.end),a.setAttr=!0)}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(b,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").addBack():g;j=j.map(function(){var b=a(this);return{el:b,start:c(this)}}),f=function(){a.each(e,function(a,c){b[c]&&g[c+"Class"](b[c])})},f(),j=j.map(function(){return this.end=c(this.el[0]),this.diff=d(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(c){return function(d,e,f,g,h){return"boolean"==typeof e||e===b?f?a.effects.animateClass.call(this,e?{add:d}:{remove:d},f,g,h):c.apply(this,arguments):a.effects.animateClass.call(this,{toggle:d},e,f,g)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function d(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function e(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"!=typeof b||a.effects.effect[b]?a.isFunction(b)?!0:"object"!=typeof b||b.effect?!1:!0:!0}a.extend(a.effects,{version:"1.10.4",save:function(a,b){for(var d=0;d<b.length;d++)null!==b[d]&&a.data(c+b[d],a[0].style[b[d]])},restore:function(a,d){var e,f;for(f=0;f<d.length;f++)null!==d[f]&&(e=a.data(c+d[f]),e===b&&(e=""),a.css(d[f],e))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(g){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function b(b){function d(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=c.complete,h=c.mode;(e.is(":hidden")?"hide"===h:"show"===h)?(e[h](),d()):g.call(e[0],c,d)}var c=d.apply(this,arguments),e=c.mode,f=c.queue,g=a.effects.effect[c.effect];return a.fx.off||!g?e?this[e](c.duration,c.complete):this.each(function(){c.complete&&c.complete.call(this)}):f===!1?this.each(b):this.queue(f||"fx",b)},show:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="show",this.effect.call(this,c)}}(a.fn.show),hide:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="hide",this.effect.call(this,c)}}(a.fn.hide),toggle:function(a){return function(b){if(e(b)||"boolean"==typeof b)return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="toggle",this.effect.call(this,c)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}()}(jQuery),function(a){var b=/up|down|vertical/,c=/up|left|vertical|horizontal/;a.effects.effect.blind=function(d,e){var f,g,h,i=a(this),j=["position","top","bottom","left","right","height","width"],k=a.effects.setMode(i,d.mode||"hide"),l=d.direction||"up",m=b.test(l),n=m?"height":"width",o=m?"top":"left",p=c.test(l),q={},r="show"===k;i.parent().is(".ui-effects-wrapper")?a.effects.save(i.parent(),j):a.effects.save(i,j),i.show(),f=a.effects.createWrapper(i).css({overflow:"hidden"}),g=f[n](),h=parseFloat(f.css(o))||0,q[n]=r?g:0,p||(i.css(m?"bottom":"right",0).css(m?"top":"left","auto").css({position:"absolute"}),q[o]=r?h:g+h),r&&(f.css(n,0),p||f.css(o,h+g)),f.animate(q,{duration:d.duration,easing:d.easing,queue:!1,complete:function(){"hide"===k&&i.hide(),a.effects.restore(i,j),a.effects.removeWrapper(i),e()}})}}(jQuery),function(a){a.effects.effect.bounce=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"effect"),j="hide"===i,k="show"===i,l=b.direction||"up",m=b.distance,n=b.times||5,o=2*n+(k||j?1:0),p=b.duration/o,q=b.easing,r="up"===l||"down"===l?"top":"left",s="up"===l||"left"===l,t=g.queue(),u=t.length;for((k||j)&&h.push("opacity"),a.effects.save(g,h),g.show(),a.effects.createWrapper(g),m||(m=g["top"===r?"outerHeight":"outerWidth"]()/3),k&&(f={opacity:1},f[r]=0,g.css("opacity",0).css(r,s?2*-m:2*m).animate(f,p,q)),j&&(m/=Math.pow(2,n-1)),f={},f[r]=0,d=0;n>d;d++)e={},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q).animate(f,p,q),m=j?2*m:m/2;j&&(e={opacity:0},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q)),g.queue(function(){j&&g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}),u>1&&t.splice.apply(t,[1,0].concat(t.splice(u,o+1))),g.dequeue()}}(jQuery),function(a){a.effects.effect.clip=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"hide"),j="show"===i,k=b.direction||"vertical",l="vertical"===k,m=l?"height":"width",n=l?"top":"left",o={};a.effects.save(g,h),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e="IMG"===g[0].tagName?d:g,f=e[m](),j&&(e.css(m,0),e.css(n,f/2)),o[m]=j?f:0,o[n]=j?0:f/2,e.animate(o,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){j||g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}})}}(jQuery),function(a){a.effects.effect.drop=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","opacity","height","width"],g=a.effects.setMode(e,b.mode||"hide"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i?"pos":"neg",l={opacity:h?1:0};a.effects.save(e,f),e.show(),a.effects.createWrapper(e),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0)/2,h&&e.css("opacity",0).css(j,"pos"===k?-d:d),l[j]=(h?"pos"===k?"+=":"-=":"pos"===k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()
}})}}(jQuery),function(a){a.effects.effect.explode=function(b,c){function d(){t.push(this),t.length===l*m&&e()}function e(){n.css({visibility:"visible"}),a(t).remove(),p||n.hide(),c()}var f,g,h,i,j,k,l=b.pieces?Math.round(Math.sqrt(b.pieces)):3,m=l,n=a(this),o=a.effects.setMode(n,b.mode||"hide"),p="show"===o,q=n.show().css("visibility","hidden").offset(),r=Math.ceil(n.outerWidth()/m),s=Math.ceil(n.outerHeight()/l),t=[];for(f=0;l>f;f++)for(i=q.top+f*s,k=f-(l-1)/2,g=0;m>g;g++)h=q.left+g*r,j=g-(m-1)/2,n.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*r,top:-f*s}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:r,height:s,left:h+(p?j*r:0),top:i+(p?k*s:0),opacity:p?0:1}).animate({left:h+(p?0:j*r),top:i+(p?0:k*s),opacity:p?1:0},b.duration||500,b.easing,d)}}(jQuery),function(a){a.effects.effect.fade=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"toggle");d.animate({opacity:e},{queue:!1,duration:b.duration,easing:b.easing,complete:c})}}(jQuery),function(a){a.effects.effect.fold=function(b,c){var d,e,f=a(this),g=["position","top","bottom","left","right","height","width"],h=a.effects.setMode(f,b.mode||"hide"),i="show"===h,j="hide"===h,k=b.size||15,l=/([0-9]+)%/.exec(k),m=!!b.horizFirst,n=i!==m,o=n?["width","height"]:["height","width"],p=b.duration/2,q={},r={};a.effects.save(f,g),f.show(),d=a.effects.createWrapper(f).css({overflow:"hidden"}),e=n?[d.width(),d.height()]:[d.height(),d.width()],l&&(k=parseInt(l[1],10)/100*e[j?0:1]),i&&d.css(m?{height:0,width:k}:{height:k,width:0}),q[o[0]]=i?e[0]:k,r[o[1]]=i?e[1]:0,d.animate(q,p,b.easing).animate(r,p,b.easing,function(){j&&f.hide(),a.effects.restore(f,g),a.effects.removeWrapper(f),c()})}}(jQuery),function(a){a.effects.effect.highlight=function(b,c){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,b.mode||"show"),g={backgroundColor:d.css("backgroundColor")};"hide"===f&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&d.hide(),a.effects.restore(d,e),c()}})}}(jQuery),function(a){a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()}}(jQuery),function(a){a.effects.effect.puff=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"hide"),f="hide"===e,g=parseInt(b.percent,10)||150,h=g/100,i={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:e,complete:c,percent:f?g:100,from:f?i:{height:i.height*h,width:i.width*h,outerHeight:i.outerHeight*h,outerWidth:i.outerWidth*h}}),d.effect(b)},a.effects.effect.scale=function(b,c){var d=a(this),e=a.extend(!0,{},b),f=a.effects.setMode(d,b.mode||"effect"),g=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===f?0:100),h=b.direction||"both",i=b.origin,j={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()},k={y:"horizontal"!==h?g/100:1,x:"vertical"!==h?g/100:1};e.effect="size",e.queue=!1,e.complete=c,"effect"!==f&&(e.origin=i||["middle","center"],e.restore=!0),e.from=b.from||("show"===f?{height:0,width:0,outerHeight:0,outerWidth:0}:j),e.to={height:j.height*k.y,width:j.width*k.x,outerHeight:j.outerHeight*k.y,outerWidth:j.outerWidth*k.x},e.fade&&("show"===f&&(e.from.opacity=0,e.to.opacity=1),"hide"===f&&(e.from.opacity=1,e.to.opacity=0)),d.effect(e)},a.effects.effect.size=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","width","height","overflow","opacity"],i=["position","top","bottom","left","right","overflow","opacity"],j=["width","height","overflow"],k=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],m=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=a.effects.setMode(g,b.mode||"effect"),o=b.restore||"effect"!==n,p=b.scale||"both",q=b.origin||["middle","center"],r=g.css("position"),s=o?h:i,t={height:0,width:0,outerHeight:0,outerWidth:0};"show"===n&&g.show(),d={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()},"toggle"===b.mode&&"show"===n?(g.from=b.to||t,g.to=b.from||d):(g.from=b.from||("show"===n?t:d),g.to=b.to||("hide"===n?t:d)),f={from:{y:g.from.height/d.height,x:g.from.width/d.width},to:{y:g.to.height/d.height,x:g.to.width/d.width}},("box"===p||"both"===p)&&(f.from.y!==f.to.y&&(s=s.concat(l),g.from=a.effects.setTransition(g,l,f.from.y,g.from),g.to=a.effects.setTransition(g,l,f.to.y,g.to)),f.from.x!==f.to.x&&(s=s.concat(m),g.from=a.effects.setTransition(g,m,f.from.x,g.from),g.to=a.effects.setTransition(g,m,f.to.x,g.to))),("content"===p||"both"===p)&&f.from.y!==f.to.y&&(s=s.concat(k).concat(j),g.from=a.effects.setTransition(g,k,f.from.y,g.from),g.to=a.effects.setTransition(g,k,f.to.y,g.to)),a.effects.save(g,s),g.show(),a.effects.createWrapper(g),g.css("overflow","hidden").css(g.from),q&&(e=a.effects.getBaseline(q,d),g.from.top=(d.outerHeight-g.outerHeight())*e.y,g.from.left=(d.outerWidth-g.outerWidth())*e.x,g.to.top=(d.outerHeight-g.to.outerHeight)*e.y,g.to.left=(d.outerWidth-g.to.outerWidth)*e.x),g.css(g.from),("content"===p||"both"===p)&&(l=l.concat(["marginTop","marginBottom"]).concat(k),m=m.concat(["marginLeft","marginRight"]),j=h.concat(l).concat(m),g.find("*[width]").each(function(){var c=a(this),d={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()};o&&a.effects.save(c,j),c.from={height:d.height*f.from.y,width:d.width*f.from.x,outerHeight:d.outerHeight*f.from.y,outerWidth:d.outerWidth*f.from.x},c.to={height:d.height*f.to.y,width:d.width*f.to.x,outerHeight:d.height*f.to.y,outerWidth:d.width*f.to.x},f.from.y!==f.to.y&&(c.from=a.effects.setTransition(c,l,f.from.y,c.from),c.to=a.effects.setTransition(c,l,f.to.y,c.to)),f.from.x!==f.to.x&&(c.from=a.effects.setTransition(c,m,f.from.x,c.from),c.to=a.effects.setTransition(c,m,f.to.x,c.to)),c.css(c.from),c.animate(c.to,b.duration,b.easing,function(){o&&a.effects.restore(c,j)})})),g.animate(g.to,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){0===g.to.opacity&&g.css("opacity",g.from.opacity),"hide"===n&&g.hide(),a.effects.restore(g,s),o||("static"===r?g.css({position:"relative",top:g.to.top,left:g.to.left}):a.each(["top","left"],function(a,b){g.css(b,function(b,c){var d=parseInt(c,10),e=a?g.to.left:g.to.top;return"auto"===c?e+"px":d+e+"px"})})),a.effects.removeWrapper(g),c()}})}}(jQuery),function(a){a.effects.effect.shake=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(e,b.mode||"effect"),h=b.direction||"left",i=b.distance||20,j=b.times||3,k=2*j+1,l=Math.round(b.duration/k),m="up"===h||"down"===h?"top":"left",n="up"===h||"left"===h,o={},p={},q={},r=e.queue(),s=r.length;for(a.effects.save(e,f),e.show(),a.effects.createWrapper(e),o[m]=(n?"-=":"+=")+i,p[m]=(n?"+=":"-=")+2*i,q[m]=(n?"-=":"+=")+2*i,e.animate(o,l,b.easing),d=1;j>d;d++)e.animate(p,l,b.easing).animate(q,l,b.easing);e.animate(p,l,b.easing).animate(o,l/2,b.easing).queue(function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}),s>1&&r.splice.apply(r,[1,0].concat(r.splice(s,k+1))),e.dequeue()}}(jQuery),function(a){a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})}}(jQuery),function(a){a.effects.effect.transfer=function(b,c){var d=a(this),e=a(b.to),f="fixed"===e.css("position"),g=a("body"),h=f?g.scrollTop():0,i=f?g.scrollLeft():0,j=e.offset(),k={top:j.top-h,left:j.left-i,height:e.innerHeight(),width:e.innerWidth()},l=d.offset(),m=a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(b.className).css({top:l.top-h,left:l.left-i,height:d.innerHeight(),width:d.innerWidth(),position:f?"fixed":"absolute"}).animate(k,b.duration,b.easing,function(){m.remove(),c()})}}(jQuery),function(a){a.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,a.proxy(function(a){this.options.disabled&&a.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(b){var c=a(b.target).closest(".ui-menu-item");!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.select(b),b.isPropagationStopped()||(this.mouseHandled=!0),c.has(".ui-menu").length?this.expand(b):!this.element.is(":focus")&&a(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){var c=a(b.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.children(".ui-menu-item").eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var d,e,f,g,h,i=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:i=!1,e=this.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1,clearTimeout(this.filterTimer),f===e?g=!0:f=e+f,h=new RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())}),d=g&&-1!==d.index(this.active.next())?this.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),h=new RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())})),d.length?(this.focus(b,d),d.length>1?(this.previousFilter=f,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}i&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,c=this.options.icons.submenu,d=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),d.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),d=b.prev("a"),e=a("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);d.attr("aria-haspopup","true").prepend(e),b.attr("aria-labelledby",d.attr("id"))}),b=d.add(this.element),b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),b.children(":not(.ui-menu-item)").each(function(){var b=a(this);/[^\-\u2014\u2013\s]/.test(b.text())||b.addClass("ui-widget-content ui-menu-divider")}),b.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.height(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.children(".ui-menu-item")[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d-e<0}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item").first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)}})}(jQuery),function(a,b){a.widget("ui.progressbar",{version:"1.10.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(a){return a===b?this.options.value:(this.options.value=this._constrainedValue(a),void this._refreshValue())},_constrainedValue:function(a){return a===b&&(a=this.options.value),this.indeterminate=a===!1,"number"!=typeof a&&(a=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,a))},_setOptions:function(a){var b=a.value;delete a.value,this._super(a),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(a,b){"max"===a&&(b=Math.max(this.min,b)),this._super(a,b)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var b=this.options.value,c=this._percentage();this.valueDiv.toggle(this.indeterminate||b>this.min).toggleClass("ui-corner-right",b===this.options.max).width(c.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=a("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":b}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==b&&(this.oldValue=b,this._trigger("change")),b===this.options.max&&this._trigger("complete")}})}(jQuery),function(a){function b(a){return parseInt(a,10)||0}function c(a){return!isNaN(parseInt(a,10))}a.widget("ui.resizable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;c<b.length;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=a(this.handles[c],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(c){var d,e,f,g=this.options,h=this.element.position(),i=this.element;return this.resizing=!0,/absolute/.test(i.css("position"))?i.css({position:"absolute",top:i.css("top"),left:i.css("left")}):i.is(".ui-draggable")&&i.css({position:"absolute",top:h.top,left:h.left}),this._renderProxy(),d=b(this.helper.css("left")),e=b(this.helper.css("top")),g.containment&&(d+=a(g.containment).scrollLeft()||0,e+=a(g.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:d,top:e},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:i.width(),height:i.height()},this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalPosition={left:d,top:e},this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio="number"==typeof g.aspectRatio?g.aspectRatio:this.originalSize.width/this.originalSize.height||1,f=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===f?this.axis+"-resize":f),i.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(b){var c,d=this.helper,e={},f=this.originalMousePosition,g=this.axis,h=this.position.top,i=this.position.left,j=this.size.width,k=this.size.height,l=b.pageX-f.left||0,m=b.pageY-f.top||0,n=this._change[g];return n?(c=n.apply(this,[b,l,m]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),this.position.top!==h&&(e.top=this.position.top+"px"),this.position.left!==i&&(e.left=this.position.left+"px"),this.size.width!==j&&(e.width=this.size.width+"px"),this.size.height!==k&&(e.height=this.size.height+"px"),d.css(e),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(e)||this._trigger("resize",b,this.ui()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&a.ui.hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b,d,e,f,g,h=this.options;g={minWidth:c(h.minWidth)?h.minWidth:0,maxWidth:c(h.maxWidth)?h.maxWidth:1/0,minHeight:c(h.minHeight)?h.minHeight:0,maxHeight:c(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(b=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,b>g.minWidth&&(g.minWidth=b),e>g.minHeight&&(g.minHeight=e),d<g.maxWidth&&(g.maxWidth=d),f<g.maxHeight&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,d=this.size,e=this.axis;return c(a.height)?a.width=a.height*this.aspectRatio:c(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===e&&(a.left=b.left+(d.width-a.width),a.top=null),"nw"===e&&(a.top=b.top+(d.height-a.height),a.left=b.left+(d.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,d=this.axis,e=c(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=c(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=c(a.width)&&b.minWidth&&b.minWidth>a.width,h=c(a.height)&&b.minHeight&&b.minHeight>a.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(d),l=/nw|ne|n/.test(d);return g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight),g&&k&&(a.left=i-b.minWidth),e&&k&&(a.left=i-b.maxWidth),h&&l&&(a.top=j-b.minHeight),f&&l&&(a.top=j-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var a,b,c,d,e,f=this.helper||this.element;for(a=0;a<this._proportionallyResizeElements.length;a++){if(e=this._proportionallyResizeElements[a],!this.borderDif)for(this.borderDif=[],c=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],d=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")],b=0;b<c.length;b++)this.borderDif[b]=(parseInt(c[b],10)||0)+(parseInt(d[b],10)||0);e.css({height:f.height()-this.borderDif[0]-this.borderDif[2]||0,width:f.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("ui-resizable"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};
e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c,d,e,f,g,h,i,j=a(this).data("ui-resizable"),k=j.options,l=j.element,m=k.containment,n=m instanceof a?m.get(0):/parent/.test(m)?l.parent().get(0):m;n&&(j.containerElement=a(n),/document/.test(m)||m===document?(j.containerOffset={left:0,top:0},j.containerPosition={left:0,top:0},j.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(c=a(n),d=[],a(["Top","Right","Left","Bottom"]).each(function(a,e){d[a]=b(c.css("padding"+e))}),j.containerOffset=c.offset(),j.containerPosition=c.position(),j.containerSize={height:c.innerHeight()-d[3],width:c.innerWidth()-d[1]},e=j.containerOffset,f=j.containerSize.height,g=j.containerSize.width,h=a.ui.hasScroll(n,"left")?n.scrollWidth:g,i=a.ui.hasScroll(n)?n.scrollHeight:f,j.parentData={element:n,left:e.left,top:e.top,width:h,height:i}))},resize:function(b){var c,d,e,f,g=a(this).data("ui-resizable"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio),g.position.top=g._helper?i.top:0),g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top,c=Math.abs((g._helper?g.offset.left-l.left:g.offset.left-l.left)+g.sizeDiff.width),d=Math.abs((g._helper?g.offset.top-l.top:g.offset.top-i.top)+g.sizeDiff.height),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f&&(c-=Math.abs(g.parentData.left)),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio))},stop:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).data("ui-resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("ui-resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("ui-resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size,e=b.originalSize,f=b.originalPosition,g=b.axis,h="number"==typeof c.grid?[c.grid,c.grid]:c.grid,i=h[0]||1,j=h[1]||1,k=Math.round((d.width-e.width)/i)*i,l=Math.round((d.height-e.height)/j)*j,m=e.width+k,n=e.height+l,o=c.maxWidth&&c.maxWidth<m,p=c.maxHeight&&c.maxHeight<n,q=c.minWidth&&c.minWidth>m,r=c.minHeight&&c.minHeight>n;c.grid=h,q&&(m+=i),r&&(n+=j),o&&(m-=i),p&&(n-=j),/^(se|s|e)$/.test(g)?(b.size.width=m,b.size.height=n):/^(ne)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.top=f.top-l):/^(sw)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.left=f.left-k):(n-j>0?(b.size.height=n,b.position.top=f.top-l):(b.size.height=j,b.position.top=f.top+e.height-j),m-i>0?(b.size.width=m,b.position.left=f.left-k):(b.size.width=i,b.position.left=f.left+e.width-i))}})}(jQuery),function(a){a.widget("ui.selectable",a.ui.mouse,{version:"1.10.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var b,c=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){b=a(c.options.filter,c.element[0]),b.addClass("ui-selectee"),b.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=b.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(b){var c=this,d=this.options;this.opos=[b.pageX,b.pageY],this.options.disabled||(this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.pageX,top:b.pageY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||b.ctrlKey||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().addBack().each(function(){var d,e=a.data(this,"selectable-item");return e?(d=!b.metaKey&&!b.ctrlKey||!e.$element.hasClass("ui-selected"),e.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting"),e.unselecting=!d,e.selecting=d,e.selected=d,d?c._trigger("selecting",b,{selecting:e.element}):c._trigger("unselecting",b,{unselecting:e.element}),!1):void 0}))},_mouseDrag:function(b){if(this.dragged=!0,!this.options.disabled){var c,d=this,e=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;return f>h&&(c=h,h=f,f=c),g>i&&(c=i,i=g,g=c),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var c=a.data(this,"selectable-item"),j=!1;c&&c.element!==d.element[0]&&("touch"===e.tolerance?j=!(c.left>h||c.right<f||c.top>i||c.bottom<g):"fit"===e.tolerance&&(j=c.left>f&&c.right<h&&c.top>g&&c.bottom<i),j?(c.selected&&(c.$element.removeClass("ui-selected"),c.selected=!1),c.unselecting&&(c.$element.removeClass("ui-unselecting"),c.unselecting=!1),c.selecting||(c.$element.addClass("ui-selecting"),c.selecting=!0,d._trigger("selecting",b,{selecting:c.element}))):(c.selecting&&((b.metaKey||b.ctrlKey)&&c.startselected?(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.$element.addClass("ui-selected"),c.selected=!0):(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.startselected&&(c.$element.addClass("ui-unselecting"),c.unselecting=!0),d._trigger("unselecting",b,{unselecting:c.element}))),c.selected&&(b.metaKey||b.ctrlKey||c.startselected||(c.$element.removeClass("ui-selected"),c.selected=!1,c.$element.addClass("ui-unselecting"),c.unselecting=!0,d._trigger("unselecting",b,{unselecting:c.element})))))}),!1}},_mouseStop:function(b){var c=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}})}(jQuery),function(a){var b=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(c){var d,e,f,g,h=a(c.target).data("ui-slider-handle-index");switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(c.target).addClass("ui-state-active"),d=this._start(c,h),d===!1))return}switch(g=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(h):this.value(),c.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-g)}this._slide(c,h,f)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}function c(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||c(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d&&(!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e))?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var c="x"===this.options.axis||b(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||b(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(a){var c=b(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=b(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&c||"up"===e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d]),e=f.length-1;e>=0;e--)g=a.data(f[e],this.widgetFullName),g&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();
return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(d){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",d,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||c(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(!n||b(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height))&&(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),Math.abs(l-k)<g&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down"));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(d,h,null,!0):this._rearrange(d,null,this.containers[p].element,!0),this._trigger("change",d,this._uiHash()),this.containers[p]._trigger("change",d,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(jQuery),function(a){function b(a){return function(){var b=this.element.val();a.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("change")}}a.widget("ui.spinner",{version:"1.10.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var b={},c=this.element;return a.each(["min","max","step"],function(a,d){var e=c.attr(d);void 0!==e&&e.length&&(b[d]=e)}),b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",a)))},mousewheel:function(a,b){if(b){if(!this.spinning&&!this._start(a))return!1;this._spin((b>0?1:-1)*this.options.step,a),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100),a.preventDefault()}},"mousedown .ui-spinner-button":function(b){function c(){var a=this.element[0]===this.document[0].activeElement;a||(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d}))}var d;d=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),b.preventDefault(),c.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,c.call(this)}),this._start(b)!==!1&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){return a(b.currentTarget).hasClass("ui-state-active")?this._start(b)===!1?!1:void this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*a.height())&&a.height()>0&&a.height(a.height()),this.options.disabled&&this.disable()},_keydown:function(b){var c=this.options,d=a.ui.keyCode;switch(b.keyCode){case d.UP:return this._repeat(null,1,b),!0;case d.DOWN:return this._repeat(null,-1,b),!0;case d.PAGE_UP:return this._repeat(null,c.page,b),!0;case d.PAGE_DOWN:return this._repeat(null,-c.page,b),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){return this.spinning||this._trigger("start",a)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(a,b,c){a=a||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,c)},a),this._spin(b*this.options.step,c)},_spin:function(a,b){var c=this.value()||0;this.counter||(this.counter=1),c=this._adjustValue(c+a*this._increment(this.counter)),this.spinning&&this._trigger("spin",b,{value:c})===!1||(this._value(c),this.counter++)},_increment:function(b){var c=this.options.incremental;return c?a.isFunction(c)?c(b):Math.floor(b*b*b/5e4-b*b/500+17*b/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){var b=a.toString(),c=b.indexOf(".");return-1===c?0:b.length-c-1},_adjustValue:function(a){var b,c,d=this.options;return b=null!==d.min?d.min:0,c=a-b,c=Math.round(c/d.step)*d.step,a=b+c,a=parseFloat(a.toFixed(this._precision())),null!==d.max&&a>d.max?d.max:null!==d.min&&a<d.min?d.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,b){if("culture"===a||"numberFormat"===a){var c=this._parse(this.element.val());return this.options[a]=b,void this.element.val(this._format(c))}("max"===a||"min"===a||"step"===a)&&"string"==typeof b&&(b=this._parse(b)),"icons"===a&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(b.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(b.down)),this._super(a,b),"disabled"===a&&(b?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:b(function(a){this._super(a),this._value(this.element.val())}),_parse:function(a){return"string"==typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a),""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(a,b){var c;""!==a&&(c=this._parse(a),null!==c&&(b||(c=this._adjustValue(c)),a=this._format(c))),this.element.val(a),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:b(function(a){this._stepUp(a)}),_stepUp:function(a){this._start()&&(this._spin((a||1)*this.options.step),this._stop())},stepDown:b(function(a){this._stepDown(a)}),_stepDown:function(a){this._start()&&(this._spin((a||1)*-this.options.step),this._stop())},pageUp:b(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:b(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){return arguments.length?void b(this._value).call(this,a):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(a,b){function c(){return++e}function d(a){return a=a.cloneNode(!1),a.hash.length>1&&decodeURIComponent(a.href.replace(f,""))===decodeURIComponent(location.href.replace(f,""))}var e=0,f=/#.*$/;a.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var b=this,c=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",c.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),c.active=this._initialActive(),a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(c.active):a(),this._refresh(),this.active.length&&this.load(c.active)},_initialActive:function(){var b=this.options.active,c=this.options.collapsible,d=location.hash.substring(1);return null===b&&(d&&this.tabs.each(function(c,e){return a(e).attr("aria-controls")===d?(b=c,!1):void 0}),null===b&&(b=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===b||-1===b)&&(b=this.tabs.length?0:!1)),b!==!1&&(b=this.tabs.index(this.tabs.eq(b)),-1===b&&(b=c?!1:0)),!c&&b===!1&&this.anchors.length&&(b=0),b},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var c=a(this.document[0].activeElement).closest("li"),d=this.tabs.index(c),e=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:d++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:e=!1,d--;break;case a.ui.keyCode.END:d=this.anchors.length-1;break;case a.ui.keyCode.HOME:d=0;break;case a.ui.keyCode.SPACE:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d);case a.ui.keyCode.ENTER:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d===this.options.active?!1:d);default:return}b.preventDefault(),clearTimeout(this.activating),d=this._focusNextTab(d,e),b.ctrlKey||(c.attr("aria-selected","false"),this.tabs.eq(d).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",d)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},_handlePageNav:function(b){return b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(b,c){function d(){return b>e&&(b=0),0>b&&(b=e),b}for(var e=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,b){return"active"===a?void this._activate(b):"disabled"===a?void this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),b||this.options.active!==!1||this._activate(0)),"event"===a&&this._setupEvents(b),void("heightStyle"===a&&this._setupHeightStyle(b)))},_tabId:function(a){return a.attr("aria-controls")||"ui-tabs-"+c()},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)}),this._processTabs(),b.active!==!1&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=a(),this.anchors.each(function(c,e){var f,g,h,i=a(e).uniqueId().attr("id"),j=a(e).closest("li"),k=j.attr("aria-controls");d(e)?(f=e.hash,g=b.element.find(b._sanitizeSelector(f))):(h=b._tabId(j),f="#"+h,g=b.element.find(f),g.length||(g=b._createPanel(h),g.insertAfter(b.panels[c-1]||b.tablist)),g.attr("aria-live","polite")),g.length&&(b.panels=b.panels.add(g)),k&&j.data("ui-tabs-aria-controls",k),j.attr({"aria-controls":f.substring(1),"aria-labelledby":i}),g.attr("aria-labelledby",i)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c,d=0;c=this.tabs[d];d++)b===!0||-1!==a.inArray(d,b)?a(c).addClass("ui-state-disabled").attr("aria-disabled","true"):a(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var c={click:function(a){a.preventDefault()}};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,c),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,d=this.element.parent();"fill"===b?(c=d.height(),c-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e.closest("li"),g=f[0]===d[0],h=g&&c.collapsible,i=h?a():this._getPanelForTab(f),j=d.length?this._getPanelForTab(d):a(),k={oldTab:d,oldPanel:j,newTab:h?a():f,newPanel:i};b.preventDefault(),f.hasClass("ui-state-disabled")||f.hasClass("ui-tabs-loading")||this.running||g&&!c.collapsible||this._trigger("beforeActivate",b,k)===!1||(c.active=h?!1:this.tabs.index(f),this.active=g?a():f,this.xhr&&this.xhr.abort(),j.length||i.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),i.length&&this.load(this.tabs.index(f),b),this._toggle(b,k))},_toggle:function(b,c){function d(){f.running=!1,f._trigger("activate",b,c)}function e(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),g.length&&f.options.show?f._show(g,f.options.show,d):(g.show(),d())}var f=this,g=c.newPanel,h=c.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),e()),h.attr({"aria-expanded":"false","aria-hidden":"true"}),c.oldTab.attr("aria-selected","false"),g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),g.attr({"aria-expanded":"true","aria-hidden":"false"}),c.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(b){var c,d=this._findActive(b);d[0]!==this.active[0]&&(d.length||(d=this.active),c=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return b===!1?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(c){var d=this.options.disabled;d!==!1&&(c===b?d=!1:(c=this._getIndex(c),d=a.isArray(d)?a.map(d,function(a){return a!==c?a:null}):a.map(this.tabs,function(a,b){return b!==c?b:null})),this._setupDisabled(d))},disable:function(c){var d=this.options.disabled;if(d!==!0){if(c===b)d=!0;else{if(c=this._getIndex(c),-1!==a.inArray(c,d))return;d=a.isArray(d)?a.merge([c],d).sort():[c]}this._setupDisabled(d)}},load:function(b,c){b=this._getIndex(b);var e=this,f=this.tabs.eq(b),g=f.find(".ui-tabs-anchor"),h=this._getPanelForTab(f),i={tab:f,panel:h};d(g[0])||(this.xhr=a.ajax(this._ajaxSettings(g,c,i)),this.xhr&&"canceled"!==this.xhr.statusText&&(f.addClass("ui-tabs-loading"),h.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){h.html(a),e._trigger("load",c,i)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&e.panels.stop(!1,!0),f.removeClass("ui-tabs-loading"),h.removeAttr("aria-busy"),a===e.xhr&&delete e.xhr},1)})))},_ajaxSettings:function(b,c,d){var e=this;return{url:b.attr("href"),beforeSend:function(b,f){return e._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},d))}}},_getPanelForTab:function(b){var c=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+c))}})}(jQuery),function(a){function b(b,c){var d=(b.attr("aria-describedby")||"").split(/\s+/);d.push(c),b.data("ui-tooltip-id",c).attr("aria-describedby",a.trim(d.join(" ")))}function c(b){var c=b.data("ui-tooltip-id"),d=(b.attr("aria-describedby")||"").split(/\s+/),e=a.inArray(c,d);-1!==e&&d.splice(e,1),b.removeData("ui-tooltip-id"),d=a.trim(d.join(" ")),d?b.attr("aria-describedby",d):b.removeAttr("aria-describedby")}var d=0;a.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var b=a(this).attr("title")||"";return a("<a>").text(b).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(b,c){var d=this;return"disabled"===b?(this[c?"_disable":"_enable"](),void(this.options[b]=c)):(this._super(b,c),void("content"===b&&a.each(this.tooltips,function(a,b){d._updateContent(b)})))},_disable:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d[0],b.close(e,!0)}),this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},open:function(b){var c=this,d=a(b?b.target:this.element).closest(this.options.items);d.length&&!d.data("ui-tooltip-id")&&(d.attr("title")&&d.data("ui-tooltip-title",d.attr("title")),d.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&d.parents().each(function(){var b,d=a(this);d.data("ui-tooltip-open")&&(b=a.Event("blur"),b.target=b.currentTarget=this,c.close(b,!0)),d.attr("title")&&(d.uniqueId(),c.parents[this.id]={element:this,title:d.attr("title")},d.attr("title",""))}),this._updateContent(d,b))},_updateContent:function(a,b){var c,d=this.options.content,e=this,f=b?b.type:null;return"string"==typeof d?this._open(b,a,d):(c=d.call(a[0],function(c){a.data("ui-tooltip-open")&&e._delay(function(){b&&(b.type=f),this._open(b,a,c)})}),void(c&&this._open(b,a,c)))},_open:function(c,d,e){function f(a){j.of=a,g.is(":hidden")||g.position(j)
}var g,h,i,j=a.extend({},this.options.position);if(e){if(g=this._find(d),g.length)return void g.find(".ui-tooltip-content").html(e);d.is("[title]")&&(c&&"mouseover"===c.type?d.attr("title",""):d.removeAttr("title")),g=this._tooltip(d),b(d,g.attr("id")),g.find(".ui-tooltip-content").html(e),this.options.track&&c&&/^mouse/.test(c.type)?(this._on(this.document,{mousemove:f}),f(c)):g.position(a.extend({of:d},this.options.position)),g.hide(),this._show(g,this.options.show),this.options.show&&this.options.show.delay&&(i=this.delayedShow=setInterval(function(){g.is(":visible")&&(f(j.of),clearInterval(i))},a.fx.interval)),this._trigger("open",c,{tooltip:g}),h={keyup:function(b){if(b.keyCode===a.ui.keyCode.ESCAPE){var c=a.Event(b);c.currentTarget=d[0],this.close(c,!0)}},remove:function(){this._removeTooltip(g)}},c&&"mouseover"!==c.type||(h.mouseleave="close"),c&&"focusin"!==c.type||(h.focusout="close"),this._on(!0,d,h)}},close:function(b){var d=this,e=a(b?b.currentTarget:this.element),f=this._find(e);this.closing||(clearInterval(this.delayedShow),e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title")),c(e),f.stop(!0),this._hide(f,this.options.hide,function(){d._removeTooltip(a(this))}),e.removeData("ui-tooltip-open"),this._off(e,"mouseleave focusout keyup"),e[0]!==this.element[0]&&this._off(e,"remove"),this._off(this.document,"mousemove"),b&&"mouseleave"===b.type&&a.each(this.parents,function(b,c){a(c.element).attr("title",c.title),delete d.parents[b]}),this.closing=!0,this._trigger("close",b,{tooltip:f}),this.closing=!1)},_tooltip:function(b){var c="ui-tooltip-"+d++,e=a("<div>").attr({id:c,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return a("<div>").addClass("ui-tooltip-content").appendTo(e),e.appendTo(this.document[0].body),this.tooltips[c]=b,e},_find:function(b){var c=b.data("ui-tooltip-id");return c?a("#"+c):a()},_removeTooltip:function(a){a.remove(),delete this.tooltips[a.attr("id")]},_destroy:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d[0],b.close(e,!0),a("#"+c).remove(),d.data("ui-tooltip-title")&&(d.attr("title",d.data("ui-tooltip-title")),d.removeData("ui-tooltip-title"))})}})}(jQuery),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.6.0";var y=x.each=x.forEach=function(a,b,d){if(null==a)return a;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return;return a};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,x.property(b))},x.where=function(a,b){return x.filter(a,x.matches(b))},x.findWhere=function(a,b){return x.find(a,x.matches(b))},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-1/0,e=-1/0;return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;e>h&&(d=a,e=h)}),d},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=x.values(a)),a[x.random(a.length-1)]):x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return null==a?x.identity:x.isFunction(a)?a:x.property(a)};x.sortBy=function(a,b,c){return b=B(b),x.pluck(x.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={};return c=B(c),y(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};x.groupBy=C(function(a,b,c){x.has(a,b)?a[b].push(c):a[b]=[c]}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.partition=function(a,b){var c=[],d=[];return y(a,function(a){(b(a)?c:d).push(a)}),[c,d]},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.contains(b,a)})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===x&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:x.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=x.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=x.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=x.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return x.partial(b,a)},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=function(a){if(!x.isObject(a))return[];if(v)return v(a);var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.constant=function(a){return function(){return a}},x.property=function(a){return function(b){return b[a]}},x.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},x.now=Date.now||function(){return(new Date).getTime()};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(){var a,b=this,c=b.Backbone,d=[],e=d.push,f=d.slice,g=d.splice;a="undefined"!=typeof exports?exports:b.Backbone={},a.VERSION="1.0.0";var h=b._;h||"undefined"==typeof require||(h=require("underscore")),a.$=b.jQuery||b.Zepto||b.ender||b.$,a.noConflict=function(){return b.Backbone=c,this},a.emulateHTTP=!1,a.emulateJSON=!1;var i=a.Events={on:function(a,b,c){if(!k(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!k(this,"once",a,[b,c])||!b)return this;var d=this,e=h.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,g,i,j,l,m;if(!this._events||!k(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:h.keys(this._events),i=0,j=g.length;j>i;i++)if(a=g[i],f=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=f.length;m>l;l++)e=f[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=f.call(arguments,1);if(!k(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&l(c,b),d&&l(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}},j=/\s+/,k=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(j.test(c)){for(var f=c.split(j),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},l=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},m={listenTo:"on",listenToOnce:"once"};h.each(m,function(a,b){i[b]=function(b,c,d){var e=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=h.uniqueId("l"));return e[f]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}}),i.bind=i.on,i.unbind=i.off,h.extend(a,i);var n=a.Model=function(a,b){var c,d=a||{};b||(b={}),this.cid=h.uniqueId("c"),this.attributes={},h.extend(this,h.pick(b,o)),b.parse&&(d=this.parse(d,b)||{}),(c=h.result(this,"defaults"))&&(d=h.defaults({},d,c)),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)},o=["url","urlRoot","collection"];h.extend(n.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,f,g,i,j,k,l;if(null==a)return this;if("object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;f=c.unset,i=c.silent,g=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=h.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],h.isEqual(l[d],b)||g.push(d),h.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,f?delete l[d]:l[d]=b;if(!i){g.length&&(this._pending=!0);for(var m=0,n=g.length;n>m;m++)this.trigger("change:"+g[m],this,l[g[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,h.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)h.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),void b.trigger("sync",b,d,a)):!1},L(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,f,g=this.attributes;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,!(!d||c&&c.wait||this.set(d,c)))return!1;if(c=h.extend({validate:!0},c),!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=h.extend({},g,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=g;var b=i.parse(a,c);return c.wait&&(b=h.extend(d||{},b)),h.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),void i.trigger("sync",i,a,c))},L(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),f=this.sync(e,this,c),d&&c.wait&&(this.attributes=g),f},destroy:function(a){a=a?h.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;L(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||K();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},h.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=h.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,h.extend(b||{},{validationError:c})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];h.each(p,function(a){n.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.attributes),h[a].apply(h,b)}});var q=a.Collection=function(a,b){b||(b={}),b.url&&(this.url=b.url),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,h.extend({silent:!0},b))},r={add:!0,remove:!0,merge:!0},s={add:!0,merge:!1,remove:!1};h.extend(q.prototype,i,{model:n,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return a.sync.apply(this,arguments)},add:function(a,b){return this.set(a,h.defaults(b||{},s))},remove:function(a,b){a=h.isArray(a)?a.slice():[a],b||(b={});var c,d,e,f;for(c=0,d=a.length;d>c;c++)f=this.get(a[c]),f&&(delete this._byId[f.id],delete this._byId[f.cid],e=this.indexOf(f),this.models.splice(e,1),this.length--,b.silent||(b.index=e,f.trigger("remove",f,this,b)),this._removeReference(f));return this},set:function(a,b){b=h.defaults(b||{},r),b.parse&&(a=this.parse(a,b)),h.isArray(a)||(a=a?[a]:[]);var c,d,f,i,j,k=b.at,l=this.comparator&&null==k&&b.sort!==!1,m=h.isString(this.comparator)?this.comparator:null,n=[],o=[],p={};for(c=0,d=a.length;d>c;c++)(f=this._prepareModel(a[c],b))&&((i=this.get(f))?(b.remove&&(p[i.cid]=!0),b.merge&&(i.set(f.attributes,b),l&&!j&&i.hasChanged(m)&&(j=!0))):b.add&&(n.push(f),f.on("all",this._onModelEvent,this),this._byId[f.cid]=f,null!=f.id&&(this._byId[f.id]=f)));if(b.remove){for(c=0,d=this.length;d>c;++c)p[(f=this.models[c]).cid]||o.push(f);o.length&&this.remove(o,b)}if(n.length&&(l&&(j=!0),this.length+=n.length,null!=k?g.apply(this.models,[k,0].concat(n)):e.apply(this.models,n)),j&&this.sort({silent:!0}),b.silent)return this;for(c=0,d=n.length;d>c;c++)(f=n[c]).trigger("add",f,this,b);return j&&this.trigger("sort",this,b),this},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),this.add(a,h.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:this.length},b)),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:0},b)),a},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a.cid||a]},at:function(a){return this.models[a]},where:function(a,b){return h.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),h.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=h.isFunction(b)?b:function(a){return a.get(b)};return h.sortedIndex(this.models,a,d,c)},pluck:function(a){return h.invoke(this.models,"get",a)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},L(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?h.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(e){b.wait&&c.add(a,b),d&&d(a,e,b)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof n)return a.collection||(a.collection=this),a;b||(b={}),b.collection=this;var c=new this.model(a,b);return c._validate(a,b)?c:(this.trigger("invalid",this,a,b),!1)},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var t=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];h.each(t,function(a){q.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.models),h[a].apply(h,b)}});var u=["groupBy","countBy","sortBy"];h.each(u,function(a){q.prototype[a]=function(b,c){var d=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,d,c)}});var v=a.View=function(a){this.cid=h.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];h.extend(v.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(b,c){return this.$el&&this.undelegateEvents(),this.$el=b instanceof a.$?b:a.$(b),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=h.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(h.isFunction(c)||(c=this[a[b]]),c){var d=b.match(w),e=d[1],f=d[2];c=h.bind(c,this),e+=".delegateEvents"+this.cid,""===f?this.$el.on(e,c):this.$el.on(e,f,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(a){this.options&&(a=h.extend({},h.result(this,"options"),a)),h.extend(this,h.pick(a,x)),this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var b=h.extend({},h.result(this,"attributes"));this.id&&(b.id=h.result(this,"id")),this.className&&(b["class"]=h.result(this,"className"));var c=a.$("<"+h.result(this,"tagName")+">").attr(b);this.setElement(c,!1)}}}),a.sync=function(b,c,d){var e=y[b];h.defaults(d||(d={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var f={type:e,dataType:"json"};if(d.url||(f.url=h.result(c,"url")||K()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(f.contentType="application/json",f.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){f.type="POST",d.emulateJSON&&(f.data._method=e);var g=d.beforeSend;d.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",e),g?g.apply(this,arguments):void 0}}"GET"===f.type||d.emulateJSON||(f.processData=!1),"PATCH"!==f.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(f.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=a.ajax(h.extend(f,d));return c.trigger("request",c,i,d),i};var y={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var z=a.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,B=/(\(\?)?:\w+/g,C=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(z.prototype,i,{initialize:function(){},route:function(b,c,d){h.isRegExp(b)||(b=this._routeToRegExp(b)),h.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return a.history.route(b,function(f){var g=e._extractParameters(b,f);d&&d.apply(e,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),a.history.trigger("route",e,c,g)}),this},navigate:function(b,c){return a.history.navigate(b,c),this},_bindRoutes:function(){if(this.routes){this.routes=h.result(this,"routes");for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(D,"\\$&").replace(A,"(?:$1)?").replace(B,function(a,b){return b?a:"([^/]+)"}).replace(C,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return h.map(c,function(a){return a?decodeURIComponent(a):null})}});var E=a.History=function(){this.handlers=[],h.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,G=/^\/+|\/+$/g,H=/msie [\w.]+/,I=/\/$/;E.started=!1,h.extend(E.prototype,i,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;
var c=this.root.replace(I,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(F,"")},start:function(b){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=h.extend({},{root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var c=this.getFragment(),d=document.documentMode,e=H.exec(navigator.userAgent.toLowerCase())&&(!d||7>=d);this.root=("/"+this.root+"/").replace(G,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c;var f=this.location,g=f.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!g?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&g&&f.hash&&(this.fragment=this.getHash().replace(F,""),this.history.replaceState({},document.title,this.root+this.fragment+f.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=h.any(this.handlers,function(a){return a.route.test(b)?(a.callback(b),!0):void 0});return c},navigate:function(a,b){if(!E.started)return!1;if(b&&b!==!0||(b={trigger:b}),a=this.getFragment(a||""),this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),a.history=new E;var J=function(a,b){var c,d=this;c=a&&h.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},h.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&h.extend(c.prototype,a),c.__super__=d.prototype,c};n.extend=q.extend=z.extend=v.extend=E.extend=J;var K=function(){throw new Error('A "url" property or function must be specified')},L=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this),function(a){var b={},c=/^(([a-z][\-a-z0-9+\.]*):)?(\/\/([^\/?#]+))?([^?#]*)?(\?([^#]*))?(#(.*))?$/i,d=function(a){var b=a.match(c);if(null===b)throw"Malformed URI: "+a;return{scheme:b[1]?b[2].toLowerCase():void 0,authority:b[3]?b[4]:void 0,path:b[5]||"",query:b[6]?b[7]:void 0,fragment:b[8]?b[9]:void 0}},e=function(a){var b="",c=[];if(/\./.test(a)){for(;void 0!==a&&""!==a;)"."===a||".."===a?a="":/^\.\.\//.test(a)?a=a.substring(3):/^\.\//.test(a)?a=a.substring(2):/^\/\.(\/|$)/.test(a)?a="/"+a.substring(3):/^\/\.\.(\/|$)/.test(a)?(a="/"+a.substring(4),b=b.replace(/\/?[^\/]+$/,"")):(c=a.match(/^(\/?[^\/]*)(\/.*)?$/),a=c[2],b+=c[1]);return b}return a},f=function(a,b){return""===a.authority||void 0!==a.path&&""!==a.path?a.path.replace(/[^\/]+$/,"")+b:"/"+b};a.uri=function(c,d){var e;return c=c||"",b[c]?b[c]:(d=d||a.uri.base(),"string"==typeof d&&(d=a.uri.absolute(d)),e=new a.uri.fn.init(c,d),b[e]?b[e]:(b[e]=e,e))},a.uri.fn=a.uri.prototype={scheme:void 0,authority:void 0,path:void 0,query:void 0,fragment:void 0,init:function(b,c){if(c=c||{},a.extend(this,d(b)),void 0===this.scheme&&(this.scheme=c.scheme,void 0!==this.authority?this.path=e(this.path):(this.authority=c.authority,""===this.path?(this.path=c.path,void 0===this.query&&(this.query=c.query)):(/^\//.test(this.path)||(this.path=f(c,this.path)),this.path=e(this.path)))),void 0===this.scheme)throw"Malformed URI: URI is not an absolute URI and no base supplied: "+b;return this},resolve:function(b){return a.uri(b,this)},relative:function(b){var c,d,e,f=0,g=[],h="";if("string"==typeof b&&(b=a.uri(b,{})),b.scheme!==this.scheme||b.authority!==this.authority)return b.toString();if(b.path!==this.path){if(c=b.path.split("/"),d=this.path.split("/"),c[1]!==d[1])h=b.path;else{for(;c[f]===d[f];)f+=1;for(e=f;f<d.length-1;f+=1)g.push("..");for(;e<c.length;e+=1)g.push(c[e]);h=g.join("/")}return h=void 0===b.query?h:h+"?"+b.query,h=void 0===b.fragment?h:h+"#"+b.fragment}return void 0!==b.query&&b.query!==this.query?"?"+b.query+(void 0===b.fragment?"":"#"+b.fragment):void 0!==b.fragment&&b.fragment!==this.fragment?"#"+b.fragment:""},toString:function(){var a="";return this._string?this._string:(a=void 0===this.scheme?a:a+this.scheme+":",a=void 0===this.authority?a:a+"//"+this.authority,a+=this.path,a=void 0===this.query?a:a+"?"+this.query,a=void 0===this.fragment?a:a+"#"+this.fragment,this._string=a,a)}},a.uri.fn.init.prototype=a.uri.fn,a.uri.absolute=function(b){return a.uri(b,{})},a.uri.resolve=function(b,c){return a.uri(b,c)},a.uri.relative=function(b,c){return a.uri(c,{}).relative(b)},a.uri.base=function(){return a(document).base()},a.fn.base=function(){var b=a(this).parents().andSelf().find("base").attr("href"),c=a(this)[0].ownerDocument||document,d=a.uri.absolute(null===c.location?document.location.href:c.location.href);return void 0===b?d:a.uri(b,d)}}(jQuery),function(a){var b=/\sxmlns(?::([^ =]+))?\s*=\s*(?:"([^"]*)"|'([^']*)')/g;a.fn.xmlns=function(c,d,e){var f,g,h,i,j,k=this.eq(0),l=k.data("xmlns"),m=k[0],n=c?"xmlns:"+c:"xmlns",o=!1;if(void 0===d){if(void 0===c){if(void 0===l){if(l={},m.attributes&&m.attributes.getNamedItemNS)for(h=0;h<m.attributes.length;h+=1)f=m.attributes[h],/^xmlns(:(.+))?$/.test(f.nodeName)&&(c=/^xmlns(:(.+))?$/.exec(f.nodeName)[2]||"",i=f.nodeValue,(""===c||""!==i)&&(l[c]=a.uri(f.nodeValue),o=!0));else{for(j=/<[^>]+>/.exec(m.outerHTML),f=b.exec(j);null!==f;)c=f[1]||"",i=f[2]||f[3],(""===c||""!==i)&&(l[c]=a.uri(f[2]||f[3]),o=!0),f=b.exec(j);b.lastIndex=0}e=e||(1===m.parentNode.nodeType?k.parent().xmlns():{}),l=o?a.extend({},e,l):e,k.data("xmlns",l)}return l}if("object"==typeof c){for(g in c)"string"==typeof c[g]&&this.xmlns(g,c[g]);return this.find("*").andSelf().removeData("xmlns"),this}return void 0===l&&(l=k.xmlns()),l[c]}return this.find("*").andSelf().removeData("xmlns"),this.attr(n,d)},a.fn.removeXmlns=function(a){var b,c,d;if("object"==typeof a)if(void 0===a.length)for(c in a)"string"==typeof a[c]&&this.removeXmlns(c);else for(d=0;d<a.length;d+=1)this.removeXmlns(a[d]);else b=a?"xmlns:"+a:"xmlns",this.removeAttr(b);return this.find("*").andSelf().removeData("xmlns"),this},a.fn.qname=function(a){var b,c,d;if(void 0===a&&(a=void 0===this[0].outerHTML?this[0].nodeName.toLowerCase():/<([^ >]+)/.exec(this[0].outerHTML)[1].toLowerCase()),"?xml:namespace"===a)throw"XMLinHTML: Unable to get the prefix to resolve the name of this element";if(b=/^(([^:]+):)?([^:]+)$/.exec(a),c=b[2]||"",d=this.xmlns(c),void 0===d&&""!==c)throw"MalformedQName: The prefix "+c+" is not declared";return{namespace:d,localPart:b[3],prefix:c,name:a}}}(jQuery),function(a){var b=function(a){return a.replace(/[ \t\n\r]+/," ").replace(/^ +/,"").replace(/ +$/,"")};a.typedValue=function(b,c){return a.typedValue.fn.init(b,c)},a.typedValue.fn=a.typedValue.prototype={representation:void 0,value:void 0,datatype:void 0,init:function(c,d){var e;if(a.typedValue.valid(c,d))return e=a.typedValue.types[d],this.representation=c,this.datatype=d,this.value=e.value(e.strip?b(c):c),this;throw{name:"InvalidValue",message:c+" is not a valid "+d+" value"}}},a.typedValue.fn.init.prototype=a.typedValue.fn,a.typedValue.types={},a.typedValue.types["http://www.w3.org/2001/XMLSchema#string"]={regex:/^.*$/,strip:!1,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#boolean"]={regex:/^(?:true|false|1|0)$/,strip:!0,value:function(a){return"true"===a||"1"===a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#decimal"]={regex:/^[\-\+]?(?:[0-9]+\.[0-9]*|\.[0-9]+|[0-9]+)$/,strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#integer"]={regex:/^[\-\+]?[0-9]+$/,strip:!0,value:function(a){return parseInt(a,10)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#int"]={regex:/^[\-\+]?[0-9]+$/,strip:!0,value:function(a){return parseInt(a,10)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"]={regex:/^(?:[\-\+]?(?:[0-9]+\.[0-9]*|\.[0-9]+|[0-9]+)(?:[eE][\-\+]?[0-9]+)?|[\-\+]?INF|NaN)$/,strip:!0,value:function(a){return"-INF"===a?-1/0:"INF"===a||"+INF"===a?1/0:parseFloat(a)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#double"]={regex:a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"].regex,strip:!0,value:a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"].value},a.typedValue.types["http://www.w3.org/2001/XMLSchema#duration"]={regex:/^([\-\+])?P(?:([0-9]+)Y)?(?:([0-9]+)M)?(?:([0-9]+)D)?(?:T(?:([0-9]+)H)?(?:([0-9]+)M)?(?:([0-9]+(?:\.[0-9]+))?S)?)$/,validate:function(a){var b=this.regex.exec(a);return b[2]||b[3]||b[4]||b[5]||b[6]||b[7]},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#dateTime"]={regex:/^(-?[0-9]{4,})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):(([0-9]{2})(\.([0-9]+))?)((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b,c=this.regex.exec(a),d=parseInt(c[1],10),e=void 0===c[10]||"Z"===c[10]?"+0000":c[10].replace(/:/,"");if(0===d||parseInt(e,10)<-1400||parseInt(e,10)>1400)return!1;try{if(d=100>d?Math.abs(d)+1e3:d,month=parseInt(c[2],10),day=parseInt(c[3],10),day>31)return!1;if(day>30&&1!==month&&3!==month&&5!==month&&7!==month&&8!==month&&10!==month&&12!==month)return!1;if(2===month){if(day>29)return!1;if(29===day&&(d%4!==0||d%100===0&&d%400!==0))return!1}return b=""+d+"/"+c[2]+"/"+c[3]+" "+c[4]+":"+c[5]+":"+c[7]+" "+e,b=new Date(b),!0}catch(f){return!1}},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#date"]={regex:/^(-?[0-9]{4,})-([0-9]{2})-([0-9]{2})((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b=this.regex.exec(a),c=parseInt(b[1],10),d=parseInt(b[2],10),e=parseInt(b[3],10),f=void 0===b[10]||"Z"===b[10]?"+0000":b[10].replace(/:/,"");return 0===c||d>12||e>31||parseInt(f,10)<-1400||parseInt(f,10)>1400?!1:!0},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#gMonthDay"]={regex:/^--([0-9]{2})-([0-9]{2})((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b=this.regex.exec(a),c=parseInt(b[1],10),d=parseInt(b[2],10),e=void 0===b[3]||"Z"===b[3]?"+0000":b[3].replace(/:/,"");return c>12||d>31||parseInt(e,10)<-1400||parseInt(e,10)>1400?!1:2===c&&d>29?!1:(4===c||6===c||9===c||11===c)&&d>30?!1:!0},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#anyURI"]={regex:/^.*$/,strip:!0,value:function(b,c){var d=a.extend({},a.typedValue.defaults,c);return a.uri.resolve(b,d.base)}},a.typedValue.defaults={base:a.uri.base(),namespaces:{}},a.typedValue.valid=function(c,d){var e=a.typedValue.types[d];if(void 0===e)throw"InvalidDatatype: The datatype "+d+" can't be recognised";return c=e.strip?b(c):c,e.regex.test(c)?void 0===e.validate?!0:e.validate(c):!1}}(jQuery),function(a){a.curie=function(b,c){var d=a.extend({},a.curie.defaults,c||{}),e=/^(([^:]*):)?(.+)$/.exec(b),f=e[2],g=e[3],h=d.namespaces[f];if(/^:.+/.test(b)){if(void 0===d.reservedNamespace||null===d.reservedNamespace)throw"Malformed CURIE: No prefix and no default namespace for unprefixed CURIE "+b;h=d.reservedNamespace}else if(f){if(void 0===h)throw"Malformed CURIE: No namespace binding for "+f+" in CURIE "+b}else if("lower"===d.charcase?b=b.toLowerCase():"upper"===d.charcase&&(b=b.toUpperCase()),d.reserved.length&&a.inArray(b,d.reserved)>=0)h=d.reservedNamespace,g=b;else{if(void 0===d.defaultNamespace||null===d.defaultNamespace)throw"Malformed CURIE: No prefix and no default namespace for unprefixed CURIE "+b;h=d.defaultNamespace}return a.uri(h+g)},a.curie.defaults={namespaces:{},reserved:[],reservedNamespace:void 0,defaultNamespace:void 0,charcase:"preserve"},a.safeCurie=function(b,c){var d=/^\[([^\]]+)\]$/.exec(b);return d?a.curie(d[1],c):a.uri(b)},a.createCurie=function(b,c){var d,e=a.extend({},a.curie.defaults,c||{}),f=e.namespaces;if(b=a.uri(b).toString(),void 0!==e.reservedNamespace&&b.substring(0,e.reservedNamespace.toString().length)===e.reservedNamespace.toString()?(d=b.substring(e.reservedNamespace.toString().length),-1===a.inArray(d,e.reserved)&&(d=":"+d)):a.each(f,function(a,c){return b.substring(0,c.toString().length)===c.toString()?(d=a+":"+b.substring(c.toString().length),null):void 0}),void 0===d)throw"No Namespace Binding: There's no appropriate namespace binding for generating a CURIE from "+b;return d},a.fn.curie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.curie(b,d)},a.fn.safeCurie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.safeCurie(b,d)},a.fn.createCurie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.createCurie(b,d)},a.fn.curie.defaults={reserved:["alternate","appendix","bookmark","cite","chapter","contents","copyright","first","glossary","help","icon","index","last","license","meta","next","p3pv1","prev","role","section","stylesheet","subsection","start","top","up"],reservedNamespace:"http://www.w3.org/1999/xhtml/vocab#",defaultNamespace:void 0,charcase:"lower"}}(jQuery),function(a){var b={},c={},d={},e={},f={},g="http://www.w3.org/2001/XMLSchema#",h="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2000/01/rdf-schema#",j=/^<(([^>]|\\>)*)>$/,k=/^("""((\\"|[^"])*)"""|"((\\"|[^"])*)")(@([a-z]+(-[a-z0-9]+)*)|\^\^(.+))?$/,l=/(("""((\\"|[^"])*)""")|("(\\"|[^"]|)*")|(<(\\>|[^>])*>)|\S)+/g,m=databankSeed=(new Date).getTime()%1e3,n=function(){return m+=1,"b"+m.toString(16)},o=function(){return databankSeed+=1,"data"+databankSeed.toString(16)},p=function(b,c){if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){try{return a.rdf.blank(b,c)}catch(e){throw"Bad Triple: Subject "+b+" is not a resource: "+e}}},q=function(b,c){if("a"===b)return a.rdf.type;if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){throw"Bad Triple: Property "+b+" is not a resource: "+d}},r=function(b,c){if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){try{return a.rdf.blank(b,c)}catch(e){try{return a.rdf.literal(b,c)}catch(f){throw"Bad Triple: Object "+b+" is not a resource or a literal "+f}}}},s=function(a,b,c){var d;return"string"==typeof b?(d=b.substring(1),c[d]&&c[d]!==a?null:(c[d]=a,c)):b===a?c:null},t=function(b,c){return a.map(b,function(a){var b=c.exec(a);return null===b?null:{bindings:b,triples:[a]}})},u=function(b,c,d){return a.map(b,function(b){var e=a.map(c,function(c){var d=!0;return a.each(c.bindings,function(a,c){return void 0!==b.bindings[a]&&b.bindings[a]!==c?(d=!1,!1):void 0}),d?c:null});return e.length>0?a.map(e,function(c){return{bindings:a.extend({},b.bindings,c.bindings),triples:a.unique(b.triples.concat(c.triples))}}):d?b:null})},v=function(b,c){var d,e,f;void 0===c.filterExp||a.isFunction(c.filterExp)||(void 0===b.union?(d="string"==typeof c.filterExp.subject?"":c.filterExp.subject,e="string"==typeof c.filterExp.property?"":c.filterExp.property,f="string"==typeof c.filterExp.object?"":c.filterExp.object,void 0===b.queries[d]&&(b.queries[d]={}),void 0===b.queries[d][e]&&(b.queries[d][e]={}),void 0===b.queries[d][e][f]&&(b.queries[d][e][f]=[]),b.queries[d][e][f].push(c)):a.each(b.union,function(a,b){v(b,c)}))},w=function(b){b.length=0,b.matches=[],a.each(b.children,function(a,b){w(b)}),a.each(b.partOf,function(a,b){w(b)})},x=function(b,c){c.length>0&&(a.each(b.children,function(a,b){y(b,c)}),a.each(b.partOf,function(a,b){x(b,c)}),a.each(c,function(a,c){b.matches.push(c),Array.prototype.push.call(b,c.bindings)}))},y=function(b,c){var d;void 0===b.union?b.top||b.parent.top?d=b.alphaMemory:(c=c||b.parent.matches,d=a.isFunction(b.filterExp)?a.map(c,function(a,c){return b.filterExp.call(a.bindings,c,a.bindings,a.triples)?a:null}):u(c,b.alphaMemory,b.filterExp.optional)):d=a.map(b.union,function(a){return a.matches}),x(b,d)},z=function(a,b){var c;a.filterExp.optional?(w(a),y(a)):(c=a.top||a.parent.top?[b]:u(a.parent.matches,[b],!1),x(a,c))},A=function(a,b){var c,d=a.filterExp.exec(b);null!==d&&(c={triples:[b],bindings:d},a.alphaMemory.push(c),z(a,c))},B=function(b,c){b.alphaMemory.splice(a.inArray(c,b.alphaMemory),1),w(b),y(b)},C=function(b,c){a.each(b,function(a,b){A(b,c)})},D=function(b,c){a.each(b,function(a,b){B(b,c)})},E=function(b,c){var d=c.subject,e=c.property,f=c.object;void 0===b.union?(void 0!==b.queries[d]&&(void 0!==b.queries[d][e]&&(void 0!==b.queries[d][e][f]&&C(b.queries[d][e][f],c),void 0!==b.queries[d][e][""]&&C(b.queries[d][e][""],c)),void 0!==b.queries[d][""]&&(void 0!==b.queries[d][""][f]&&C(b.queries[d][""][f],c),void 0!==b.queries[d][""][""]&&C(b.queries[d][""][""],c))),void 0!==b.queries[""]&&(void 0!==b.queries[""][e]&&(void 0!==b.queries[""][e][f]&&C(b.queries[""][e][f],c),void 0!==b.queries[""][e][""]&&C(b.queries[""][e][""],c)),void 0!==b.queries[""][""]&&(void 0!==b.queries[""][""][f]&&C(b.queries[""][""][f],c),void 0!==b.queries[""][""][""]&&C(b.queries[""][""][""],c)))):a.each(b.union,function(a,b){E(b,c)})},F=function(b,c){var d=c.subject,e=c.property,f=c.object;void 0===b.union?(void 0!==b.queries[d]&&(void 0!==b.queries[d][e]&&(void 0!==b.queries[d][e][f]&&D(b.queries[d][e][f],c),void 0!==b.queries[d][e][""]&&D(b.queries[d][e][""],c)),void 0!==b.queries[d][""]&&(void 0!==b.queries[d][""][f]&&D(b.queries[d][""][f],c),void 0!==b.queries[d][""][""]&&D(b.queries[d][""][""],c))),void 0!==b.queries[""]&&(void 0!==b.queries[""][e]&&(void 0!==b.queries[""][e][f]&&D(b.queries[""][e][f],c),void 0!==b.queries[""][e][""]&&D(b.queries[""][e][""],c)),void 0!==b.queries[""][""]&&(void 0!==b.queries[""][""][f]&&D(b.queries[""][""][f],c),void 0!==b.queries[""][""][""]&&D(b.queries[""][""][""],c)))):a.each(b.union,function(a,b){F(b,c)})},G=function(a){var b,c,d,e,f={};for(b=0;b<a.length;b+=1)c=a[b],d=c.subject.value.toString(),e=c.property.value.toString(),void 0===f[d]&&(f[d]={}),void 0===f[d][e]&&(f[d][e]=[]),f[d][e].push(c.object.dump());return f},H=function(b){var c,d,e,f,g,h,i,j,k=[];for(c in b){d="_:"===c.substring(0,2)?a.rdf.blank(c):a.rdf.resource("<"+c+">");for(e in b[c])for(f=a.rdf.resource("<"+e+">"),i=0;i<b[c][e].length;i+=1)g=b[c][e][i],"uri"===g.type?h=a.rdf.resource("<"+g.value+">"):"bnode"===g.type?h=a.rdf.blank(g.value):void 0!==g.datatype?h=a.rdf.literal(g.value,{datatype:g.datatype}):(j={},void 0!==g.lang&&(j.lang=g.lang),h=a.rdf.literal('"'+g.value+'"',j)),k.push(a.rdf.triple(d,f,h))}return k},I=function(a,b,c,d){var e,f=a.ownerDocument;return void 0!==b&&null!==b?f.createAttributeNS?(e=f.createAttributeNS(b,c),e.nodeValue=d,a.attributes.setNamedItemNS(e)):(e=f.createNode(2,c,b),e.nodeValue=d,a.attributes.setNamedItem(e)):(e=f.createAttribute(c),e.nodeValue=d,a.attributes.setNamedItem(e)),a},J=function(a,b,c){return c?I(a,"http://www.w3.org/2000/xmlns/","xmlns:"+c,b):I(a,void 0,"xmlns",b),a},K=function(a,b){var c,d,e="",f=!1;return void 0!==a&&null!==a&&(/:/.test(b)&&(d=/([^:]+):/.exec(b)[1]),f=!0),document.implementation&&document.implementation.createDocument?(c=document.implementation.createDocument(a,b,null),f&&J(c.documentElement,a,d),c):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",e=void 0===d?' xmlns="'+a+'"':" xmlns:"+d+'="'+a+'"',c.loadXML("<"+b+e+"/>"),c)},L=function(a,b,c){var d,e=a.ownerDocument;return d=void 0!==b&&null!==b?e.createElementNS?e.createElementNS(b,c):e.createNode(1,c,b):e.createElement(c),a.appendChild(d),d},M=function(a,b){var c,d=a.ownerDocument;return c=d.createTextNode(b),a.appendChild(c),a},N=function(a,b){var c,d,e;try{d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML("<temp>"+b+"</temp>")}catch(f){c=new DOMParser,d=c.parseFromString("<temp>"+b+"</temp>","text/xml")}for(e=0;e<d.documentElement.childNodes.length;e+=1)a.appendChild(d.documentElement.childNodes[e].cloneNode(!0));return a},O=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p=K(h,"rdf:RDF"),q=G(b),r=c.namespaces||{};for(d in r)J(p.documentElement,r[d],d);for(e in q){if(void 0!==q[e][a.rdf.type.value]){l=/(.+[#\/])([^#\/]+)/.exec(q[e][a.rdf.type.value][0].value),n=l[1],m=l[2];for(d in r)if(r[d]===n){o=d;break}f=L(p.documentElement,n,o+":"+m)}else f=L(p.documentElement,h,"rdf:Description");/^_:/.test(e)?I(f,h,"rdf:nodeID",e.substring(2)):I(f,h,"rdf:about",e);for(g in q[e])if(g!==a.rdf.type.value.toString()||q[e][g].length>1){l=/(.+[#\/])([^#\/]+)/.exec(g),n=l[1],m=l[2];for(d in r)if(r[d]===n){o=d;break}for(j=g===a.rdf.type.value.toString()?1:0;j<q[e][g].length;j+=1)k=q[e][g][j],i=L(f,n,o+":"+m),"uri"===k.type?I(i,h,"rdf:resource",k.value):"literal"===k.type?void 0!==k.datatype?"http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===k.datatype?(I(i,h,"rdf:parseType","Literal"),N(i,k.value)):(I(i,h,"rdf:datatype",k.datatype),M(i,k.value)):void 0!==k.lang?(I(i,"http://www.w3.org/XML/1998/namespace","xml:lang",k.lang),M(i,k.value)):M(i,k.value):I(i,h,"rdf:nodeID",k.value.substring(2))}}return p},P=function(a){switch(a){case"http://www.w3.org/1999/02/22-rdf-syntax-ns":return"rdf";case"http://www.w3.org/XML/1998/namespace":return"xml";case"http://www.w3.org/2000/xmlns/":return"xmlns";default:throw"No default prefix mapped for namespace "+a}},Q=function(a,b,c){var d;if(a.hasAttributeNS)return a.hasAttributeNS(b,c);try{return d=/:/.test(c)?/:(.+)$/.exec(c)[1]:c,null!==a.attributes.getQualifiedItem(d,b)}catch(e){return null!==a.getAttribute(P(b)+":"+c)}},R=function(a,b,c){var d;if(a.getAttributeNS)return a.getAttributeNS(b,c);try{return d=/:/.test(c)?/:(.+)$/.exec(c)[1]:c,a.attributes.getQualifiedItem(d,b).nodeValue}catch(e){return a.getAttribute(P(b)+":"+c)}},S=function(a){return a.localName||a.baseName},T=function(b,c){var d,e;return Q(b,h,"about")?(d=R(b,h,"about"),e=a.rdf.resource("<"+d+">",{base:c})):Q(b,h,"ID")?(d=R(b,h,"ID"),e=a.rdf.resource("<#"+d+">",{base:c})):Q(b,h,"nodeID")?(d=R(b,h,"nodeID"),e=a.rdf.blank("_:"+d)):e=a.rdf.blank("[]"),e},U=function(b,c,d,e){var f,g,i,j,k,l,e,m,n,o,p,q,r,s,t,u=1,v=[],w={},x=[];for(e=R(b,"http://www.w3.org/XML/1998/namespace","lang")||e,d=R(b,"http://www.w3.org/XML/1998/namespace","base")||d,null!==e&&void 0!==e&&""!==e&&(w={lang:e}),f=T(b,d),!c||b.namespaceURI===h&&"Description"===S(b)||(i=a.rdf.type,k=a.rdf.resource("<"+b.namespaceURI+S(b)+">"),x.push(a.rdf.triple(f,i,k))),m=0;m<b.attributes.length;m+=1)g=b.attributes.item(m),void 0!==g.namespaceURI&&"http://www.w3.org/2000/xmlns/"!==g.namespaceURI&&"http://www.w3.org/XML/1998/namespace"!==g.namespaceURI&&"xmlns"!==g.prefix&&"xml"!==g.prefix&&(g.namespaceURI!==h?(i=a.rdf.resource("<"+g.namespaceURI+S(g)+">"),k=a.rdf.literal('"'+g.nodeValue+'"',w),x.push(a.rdf.triple(f,i,k))):"type"===S(g)&&(i=a.rdf.type,k=a.rdf.resource("<"+g.nodeValue+">",{base:d}),x.push(a.rdf.triple(f,i,k))));for(m=0;m<b.childNodes.length;m+=1)if(g=b.childNodes[m],1===g.nodeType){if(g.namespaceURI===h&&"li"===S(g)?(i=a.rdf.resource("<"+h+"_"+u+">"),u+=1):i=a.rdf.resource("<"+g.namespaceURI+S(g)+">"),e=R(g,"http://www.w3.org/XML/1998/namespace","lang")||e,null!==e&&void 0!==e&&""!==e&&(w={lang:e}),Q(g,h,"resource"))j=R(g,h,"resource"),k=a.rdf.resource("<"+j+">",{base:d});else if(Q(g,h,"nodeID"))j=R(g,h,"nodeID"),k=a.rdf.blank("_:"+j);else if(Q(g,h,"parseType")){if(r=R(g,h,"parseType"),"Literal"===r){try{s=new XMLSerializer,j=s.serializeToString(g.getElementsByTagName("*")[0])}catch(y){for(j="",n=0;n<g.childNodes.length;n+=1)j+=g.childNodes[n].xml}k=a.rdf.literal(j,{datatype:h+"XMLLiteral"})}else if("Resource"===r)t=U(g,!1,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=a.rdf.blank("[]");else if("Collection"===r)if(g.getElementsByTagName("*").length>0){for(n=0;n<g.childNodes.length;n+=1)j=g.childNodes[n],1===j.nodeType&&v.push(j);for(o=a.rdf.blank("[]"),k=o,n=0;n<v.length;n+=1)j=v[n],t=U(j,!0,d,e),t.length>0?(q=t[t.length-1].subject,x=x.concat(t)):q=T(j),x.push(a.rdf.triple(o,a.rdf.first,q)),n===v.length-1?x.push(a.rdf.triple(o,a.rdf.rest,a.rdf.nil)):(p=a.rdf.blank("[]"),x.push(a.rdf.triple(o,a.rdf.rest,p)),o=p)}else k=a.rdf.nil}else if(Q(g,h,"datatype"))j=g.childNodes[0].nodeValue,k=a.rdf.literal(j,{datatype:R(g,h,"datatype")});else if(g.getElementsByTagName("*").length>0)for(n=0;n<g.childNodes.length;n+=1)j=g.childNodes[n],1===j.nodeType&&(t=U(j,!0,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=T(j));else g.childNodes.length>0?(j=g.childNodes[0].nodeValue,k=a.rdf.literal('"'+j+'"',w)):(t=U(g,!1,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=a.rdf.blank("[]"));x.push(a.rdf.triple(f,i,k)),Q(g,h,"ID")&&(l=a.rdf.resource("<#"+R(g,h,"ID")+">",{base:d}),x.push(a.rdf.triple(l,a.rdf.subject,f)),x.push(a.rdf.triple(l,a.rdf.property,i)),x.push(a.rdf.triple(l,a.rdf.object,k)))}return x},V=function(b){var c,d,e,f=[];if(b.documentElement.namespaceURI===h&&"RDF"===S(b.documentElement))for(d=R(b.documentElement,"http://www.w3.org/XML/1998/namespace","lang"),base=R(b.documentElement,"http://www.w3.org/XML/1998/namespace","base")||a.uri.base(),c=0;c<b.documentElement.childNodes.length;c+=1)e=b.documentElement.childNodes[c],1===e.nodeType&&(f=f.concat(U(e,!0,base,d)));else f=U(b.documentElement,!0);return f};a.typedValue.types["http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"]={regex:/^.*$/m,strip:!1,value:function(a){return a}},a.rdf=function(b){return new a.rdf.fn.init(b)},a.rdf.fn=a.rdf.prototype={rdfquery:"0.9",init:function(b){var c;return b=b||{},this.parent=b.parent,this.union=b.union,this.top=void 0===this.parent&&void 0===this.union,void 0===this.union?this.databank=void 0===b.databank?void 0===this.parent?a.rdf.databank(b.triples,b):this.parent.databank:b.databank:(c=a.map(this.union,function(a){return a.databank}),c=a.unique(c),this.databank=void 0!==c[1]?a.rdf.databank(void 0,{union:c}):c[0]),this.children=[],this.partOf=[],this.filterExp=b.filter,this.alphaMemory=[],this.matches=[],this.length=0,void 0!==this.filterExp&&(a.isFunction(this.filterExp)||(v(this.databank,this),this.alphaMemory=t(this.databank.triples(),this.filterExp))),y(this),this},base:function(a){return void 0===a?this.databank.base():(this.databank.base(a),this)},prefix:function(a,b){return void 0===b?this.databank.prefix(a):(this.databank.prefix(a,b),this)},add:function(b,c){var d,e;if(void 0!==b.rdfquery){if(b.top)return e=this.databank.add(b.databank),d=a.rdf({parent:this.parent,databank:e});if(this.top)return e=b.databank.add(this.databank),d=a.rdf({parent:b.parent,databank:e});if(void 0===this.union)return d=a.rdf({union:[this,b]}),this.partOf.push(d),b.partOf.push(d),d;this.union.push(b),b.partOf.push(this)}else"string"==typeof b&&(c=a.extend({},{base:this.base(),namespaces:this.prefix(),source:b},c),b=a.rdf.pattern(b,c)),b.isFixed()?this.databank.add(b.triple(),c):(d=this,this.each(function(a,e){var f=b.triple(e);null!==f&&d.databank.add(f,c)}));return this},remove:function(b,c){return"string"==typeof b&&(c=a.extend({},{base:this.base(),namespaces:this.prefix()},c),b=a.rdf.pattern(b,c)),b.isFixed()?this.databank.remove(b.triple(),c):(query=this,this.each(function(a,d){var e=b.triple(d);null!==e&&query.databank.remove(e,c)})),this},load:function(a,b){return this.databank.load(a,b),this},except:function(b){return a.rdf({databank:this.databank.except(b.databank)})},where:function(b,c){var d,e,f,g;return c=c||{},"string"==typeof b&&(e=c.base||this.base(),f=a.extend({},this.prefix(),c.namespaces||{}),g=c.optional||!1,b=a.rdf.pattern(b,{namespaces:f,base:e,optional:g})),d=a.rdf(a.extend({},c,{parent:this,filter:b})),this.children.push(d),d},optional:function(b,c){return this.where(b,a.extend({},c||{},{optional:!0}))},about:function(a,b){return this.where(a+" ?property ?value",b)},filter:function(b,c){var d,e;return d="string"==typeof b?c.constructor===RegExp?function(){return c.test(this[b].value)}:function(){return"literal"===this[b].type?this[b].value===c:this[b]===c}:b,e=a.rdf({parent:this,filter:d}),this.children.push(e),e},select:function(a){var b,c,d=[];for(b=0;b<this.length;b+=1)if(void 0===a)d[b]=this[b];else for(d[b]={},c=0;c<a.length;c+=1)d[b][a[c]]=this[b][a[c]];return d},describe:function(a){var b,c,d,e=[];for(b=0;b<a.length;b+=1)if(d=a[b],"?"===d.substring(0,1))for(d=d.substring(1),c=0;c<this.length;c+=1)e.push(this[c][d]);else e.push(d);return this.databank.describe(e)},eq:function(a){return this.filter(function(b){return b===a})},reset:function(){for(var a=this;void 0!==a.parent;)a=a.parent;return a},end:function(){return this.parent},size:function(){return this.length},sources:function(){return a(a.map(this.matches,function(a){return[a.triples]}))},dump:function(b){var c=a.map(this.matches,function(a){return a.triples});return b=a.extend({namespaces:this.databank.namespaces,base:this.databank.base},b||{}),a.rdf.dump(c,b)},get:function(b){return void 0===b?a.makeArray(this):this[b]},each:function(b){return a.each(this.matches,function(a,c){b.call(c.bindings,a,c.bindings,c.triples)}),this},map:function(b){return a(a.map(this.matches,function(a,c){return b.call(a.bindings,c,a.bindings,a.triples)}))},jquery:function(){return a(this)}},a.rdf.fn.init.prototype=a.rdf.fn,a.rdf.gleaners=[],a.rdf.dump=function(b,c){var d,e=a.extend({},a.rdf.dump.defaults,c||{}),f=e.format,g=e.serialize;if("application/json"===f)return d=G(b,e),g?a.toJSON(d):d;if("application/rdf+xml"===f)return d=O(b,e),g?d.xml?d.xml.replace(/\s+$/,""):(serializer=new XMLSerializer,serializer.serializeToString(d)):d;throw"Unrecognised dump format: "+f+". Expected application/json or application/rdf+xml."},a.rdf.dump.defaults={format:"application/json",serialize:!1,namespaces:{}},a.fn.rdf=function(){var b=[];return a(this)[0]&&9===a(this)[0].nodeType?a(this).children("*").rdf():a(this).length>0?(b=a(this).map(function(b,c){return a.map(a.rdf.gleaners,function(b){return b.call(a(c))})}),a.rdf({triples:b,namespaces:a(this).xmlns()})):a.rdf()},a.extend(a.expr[":"],{about:function(b,c,d){var e=a(b),f=d[3]?e.safeCurie(d[3]):null,g=!1;return a.each(a.rdf.gleaners,function(a,b){return g=b.call(e,{about:f}),g?null:void 0}),g},type:function(b,c,d){var e=a(b),f=d[3]?e.curie(d[3]):null,g=!1;return a.each(a.rdf.gleaners,function(a,b){return b.call(e,{type:f})?(g=!0,null):void 0}),g}}),a.rdf.databank=function(b,c){return new a.rdf.databank.fn.init(b,c)},a.rdf.databank.fn=a.rdf.databank.prototype={init:function(b,c){var d;if(b=b||[],c=c||{},this.id=o(),void 0===c.union)for(this.queries={},this.tripleStore={},this.objectStore={},this.baseURI=c.base||a.uri.base(),this.namespaces=a.extend({},c.namespaces||{}),d=0;d<b.length;d+=1)this.add(b[d]);else this.union=c.union;return this},base:function(b){return void 0===this.union?void 0===b?this.baseURI:(this.baseURI=b,this):void 0===b?this.union[0].base():(a.each(this.union,function(a,c){c.base(b)}),this)},prefix:function(b,c){var d={};return void 0===this.union?void 0===b?this.namespaces:void 0===c?this.namespaces[b]:(this.namespaces[b]=c,this):void 0===c?(a.each(this.union,function(b,c){a.extend(d,c.prefix())
}),void 0===b?d:d[b]):(a.each(this.union,function(a,d){d.prefix(b,c)}),this)},add:function(b,c){var d,e=c&&c.base||this.base(),f=a.extend({},this.prefix(),c&&c.namespaces||{});return b===this?this:void 0!==b.tripleStore?void 0===this.union?d=a.rdf.databank(void 0,{union:[this,b]}):(this.union.push(b),this):("string"==typeof b&&(b=a.rdf.triple(b,{namespaces:f,base:e,source:b})),void 0===this.union?(void 0===this.tripleStore[b.subject]&&(this.tripleStore[b.subject]=[]),-1===a.inArray(b,this.tripleStore[b.subject])&&(this.tripleStore[b.subject].push(b),("uri"===b.object.type||"bnode"===b.object.type)&&(void 0===this.objectStore[b.object]&&(this.objectStore[b.object]=[]),this.objectStore[b.object].push(b)),E(this,b))):a.each(this.union,function(a,c){c.add(b)}),this)},remove:function(b,c){var d,e,f=c&&c.base||this.base(),g=a.extend({},this.prefix(),c&&c.namespaces||{});return"string"==typeof b&&(b=a.rdf.triple(b,{namespaces:g,base:f,source:b})),d=this.tripleStore[b.subject],void 0!==d&&d.splice(a.inArray(b,d),1),("uri"===b.object.type||"bnode"===b.object.type)&&(e=this.objectStore[b.object],void 0!==e&&e.splice(a.inArray(b,e),1)),F(this,b),this},except:function(b){var c=b.tripleStore,d=[];return a.each(this.tripleStore,function(b,e){var f=c[b];void 0===f?d=d.concat(e):a.each(e,function(b,c){-1===a.inArray(c,f)&&d.push(c)})}),a.rdf.databank(d)},triples:function(){var b=[];return void 0===this.union?a.each(this.tripleStore,function(a,c){b=b.concat(c)}):(a.each(this.union,function(a,c){b=b.concat(c.triples().get())}),b=a.unique(b)),a(b)},size:function(){return this.triples().length},describe:function(b){for(var c,d,e,f={},g=[];b.length>0;)if(d=b.pop(),void 0===f[d]){if(void 0===d.value&&(d=a.rdf.resource(d)),void 0!==this.tripleStore[d])for(c=0;c<this.tripleStore[d].length;c+=1)e=this.tripleStore[d][c],g.push(e),"bnode"===e.object.type&&b.push(e.object);if(void 0!==this.objectStore[d])for(c=0;c<this.objectStore[d].length;c+=1)e=this.objectStore[d][c],g.push(e),"bnode"===e.subject.type&&b.push(e.subject);f[d]=!0}return a.unique(g)},dump:function(b){return b=a.extend({namespaces:this.namespaces,base:this.base},b||{}),a.rdf.dump(this.triples(),b)},load:function(a){var b,c;for(c=void 0!==a.ownerDocument?V(a):H(a),b=0;b<c.length;b+=1)this.add(c[b]);return this},toString:function(){return"[Databank with "+this.size()+" triples]"}},a.rdf.databank.fn.init.prototype=a.rdf.databank.fn,a.rdf.pattern=function(b,c,d,e){var g,h,i;if(void 0===d){if(e=c||{},h=a.trim(b).match(l),3!==h.length&&(4!==h.length||"."!==h[3]))throw"Bad Pattern: Couldn't parse string "+b;b=h[0],c=h[1],d=h[2],i=void 0===e.optional?a.rdf.pattern.defaults.optional:e.optional}return f[b]&&f[b][c]&&f[b][c][d]&&f[b][c][d][i]?f[b][c][d][i]:(g=new a.rdf.pattern.fn.init(b,c,d,e),f[g.subject]&&f[g.subject][g.property]&&f[g.subject][g.property][g.object]&&f[g.subject][g.property][g.object][g.optional]?f[g.subject][g.property][g.object][g.optional]:(void 0===f[g.subject]&&(f[g.subject]={}),void 0===f[g.subject][g.property]&&(f[g.subject][g.property]={}),void 0===f[g.subject][g.property][g.object]&&(f[g.subject][g.property][g.object]={}),f[g.subject][g.property][g.object][g.optional]=g,g))},a.rdf.pattern.fn=a.rdf.pattern.prototype={init:function(b,c,d,e){var f=a.extend({},a.rdf.pattern.defaults,e);return this.subject="?"===b.toString().substring(0,1)?b:p(b,f),this.property="?"===c.toString().substring(0,1)?c:q(c,f),this.object="?"===d.toString().substring(0,1)?d:r(d,f),this.optional=f.optional,this},fill:function(b){var c=this.subject,d=this.property,e=this.object;return"string"==typeof c&&b[c.substring(1)]&&(c=b[c.substring(1)]),"string"==typeof d&&b[d.substring(1)]&&(d=b[d.substring(1)]),"string"==typeof e&&b[e.substring(1)]&&(e=b[e.substring(1)]),a.rdf.pattern(c,d,e,{optional:this.optional})},exec:function(a){var b={};return b=s(a.subject,this.subject,b),null===b?null:(b=s(a.property,this.property,b),null===b?null:b=s(a.object,this.object,b))},isFixed:function(){return"string"!=typeof this.subject&&"string"!=typeof this.property&&"string"!=typeof this.object},triple:function(b){var c=this;return this.isFixed()||(c=this.fill(b)),c.isFixed()?a.rdf.triple(c.subject,c.property,c.object,{source:this.toString()}):null},toString:function(){return this.subject+" "+this.property+" "+this.object}},a.rdf.pattern.fn.init.prototype=a.rdf.pattern.fn,a.rdf.pattern.defaults={base:a.uri.base(),namespaces:{},optional:!1},a.rdf.triple=function(b,c,d,f){var g,h,i;if(void 0===d){if(f=c,i=a.trim(b).match(l),3!==i.length&&(4!==i.length||"."!==i[3]))throw"Bad Triple: Couldn't parse string "+b;b=i[0],c=i[1],d=i[2]}return h=f&&f.graph||"",e[h]&&e[h][b]&&e[h][b][c]&&e[h][b][c][d]?e[h][b][c][d]:(g=new a.rdf.triple.fn.init(b,c,d,f),h=g.graph||"",e[h]&&e[h][g.subject]&&e[h][g.subject][g.property]&&e[h][g.subject][g.property][g.object]?e[h][g.subject][g.property][g.object]:(void 0===e[h]&&(e[h]={}),void 0===e[h][g.subject]&&(e[h][g.subject]={}),void 0===e[h][g.subject][g.property]&&(e[h][g.subject][g.property]={}),e[h][g.subject][g.property][g.object]=g,g))},a.rdf.triple.fn=a.rdf.triple.prototype={init:function(b,c,d,e){var f;return f=a.extend({},a.rdf.triple.defaults,e),this.subject=p(b,f),this.property=q(c,f),this.object=r(d,f),this.graph=void 0===f.graph?void 0:p(f.graph,f),this.source=f.source,this},isFixed:function(){return!0},triple:function(){return this},dump:function(){var a={},b=this.subject.value.toString(),c=this.property.value.toString();return a[b]={},a[b][c]=this.object.dump(),a},toString:function(){return this.subject+" "+this.property+" "+this.object+" ."}},a.rdf.triple.fn.init.prototype=a.rdf.triple.fn,a.rdf.triple.defaults={base:a.uri.base(),source:[document],namespaces:{}},a.rdf.resource=function(c,d){var e;return b[c]?b[c]:(e=new a.rdf.resource.fn.init(c,d),b[e]?b[e]:(b[e]=e,e))},a.rdf.resource.fn=a.rdf.resource.prototype={type:"uri",value:void 0,init:function(b,c){var d,e,f,g;if("string"==typeof b)if(d=j.exec(b),g=a.extend({},a.rdf.resource.defaults,c),null!==d)this.value=a.uri.resolve(d[1].replace(/\\>/g,">"),g.base);else if(":"===b.substring(0,1)){if(f=g.namespaces[""],void 0===f)throw"Malformed Resource: No namespace binding for default namespace in "+b;this.value=a.uri.resolve(f+b.substring(1))}else if(":"===b.substring(b.length-1)){if(e=b.substring(0,b.length-1),f=g.namespaces[e],void 0===f)throw"Malformed Resource: No namespace binding for prefix "+e+" in "+b;this.value=a.uri.resolve(f)}else try{this.value=a.curie(b,{namespaces:g.namespaces})}catch(h){throw"Malformed Resource: Bad format for resource "+h}else this.value=b;return this},dump:function(){return{type:"uri",value:this.value.toString()}},toString:function(){return"<"+this.value+">"}},a.rdf.resource.fn.init.prototype=a.rdf.resource.fn,a.rdf.resource.defaults={base:a.uri.base(),namespaces:{}},a.rdf.type=a.rdf.resource("<"+h+"type>"),a.rdf.label=a.rdf.resource("<"+i+"label>"),a.rdf.first=a.rdf.resource("<"+h+"first>"),a.rdf.rest=a.rdf.resource("<"+h+"rest>"),a.rdf.nil=a.rdf.resource("<"+h+"nil>"),a.rdf.subject=a.rdf.resource("<"+h+"subject>"),a.rdf.property=a.rdf.resource("<"+h+"property>"),a.rdf.object=a.rdf.resource("<"+h+"object>"),a.rdf.blank=function(b){var d;return c[b]?c[b]:(d=new a.rdf.blank.fn.init(b),c[d]?c[d]:(c[d]=d,d))},a.rdf.blank.fn=a.rdf.blank.prototype={type:"bnode",value:void 0,id:void 0,init:function(a){if("[]"===a)this.id=n(),this.value="_:"+this.id;else{if("_:"!==a.substring(0,2))throw"Malformed Blank Node: "+a+" is not a legal format for a blank node";this.id=a.substring(2),this.value=a}return this},dump:function(){return{type:"bnode",value:this.value}},toString:function(){return this.value}},a.rdf.blank.fn.init.prototype=a.rdf.blank.fn,a.rdf.literal=function(b,c){var e;return d[b]?d[b]:(e=new a.rdf.literal.fn.init(b,c),d[e]?d[e]:(d[e]=e,e))},a.rdf.literal.fn=a.rdf.literal.prototype={type:"literal",value:void 0,lang:void 0,datatype:void 0,init:function(b,c){var d,e,f=a.extend({},a.rdf.literal.defaults,c);if(void 0!==f.lang&&void 0!==f.datatype)throw"Malformed Literal: Cannot define both a language and a datatype for a literal ("+b+")";if(void 0!==f.datatype)e=a.safeCurie(f.datatype,{namespaces:f.namespaces}),a.extend(this,a.typedValue(b.toString(),e));else if(void 0!==f.lang)this.value=b.toString(),this.lang=f.lang;else if("boolean"==typeof b)a.extend(this,a.typedValue(b.toString(),g+"boolean"));else if("number"==typeof b)a.extend(this,a.typedValue(b.toString(),g+"double"));else if("true"===b||"false"===b)a.extend(this,a.typedValue(b,g+"boolean"));else if(a.typedValue.valid(b,g+"integer"))a.extend(this,a.typedValue(b,g+"integer"));else if(a.typedValue.valid(b,g+"decimal"))a.extend(this,a.typedValue(b,g+"decimal"));else if(a.typedValue.valid(b,g+"double")&&!/^\s*([\-\+]?INF|NaN)\s*$/.test(b))a.extend(this,a.typedValue(b,g+"double"));else{if(d=k.exec(b),null===d)throw"Malformed Literal: Couldn't recognise the value "+b;this.value=(d[2]||d[4]).replace(/\\"/g,'"'),d[9]?(e=a.rdf.resource(d[9],f),a.extend(this,a.typedValue(this.value,e.value))):d[7]&&(this.lang=d[7])}return this},dump:function(){var a={type:"literal",value:this.value.toString()};return void 0!==this.lang?a.lang=this.lang:void 0!==this.datatype&&(a.datatype=this.datatype.toString()),a},toString:function(){var a='"'+this.value+'"';return void 0!==this.lang?a+="@"+this.lang:void 0!==this.datatype&&(a+="^^<"+this.datatype+">"),a}},a.rdf.literal.fn.init.prototype=a.rdf.literal.fn,a.rdf.literal.defaults={base:a.uri.base(),namespaces:{},datatype:void 0,lang:void 0}}(jQuery),function(a){var b={},c=/^(([a-z][\-a-z0-9+\.]*):)?(\/\/([^\/?#]+))?([^?#]*)?(\?([^#]*))?(#(.*))?$/i,d=function(a){var b=a.match(c);if(null===b)throw"Malformed URI: "+a;return{scheme:b[1]?b[2].toLowerCase():void 0,authority:b[3]?b[4]:void 0,path:b[5]||"",query:b[6]?b[7]:void 0,fragment:b[8]?b[9]:void 0}},e=function(a){var b="",c=[];if(/\./.test(a)){for(;void 0!==a&&""!==a;)"."===a||".."===a?a="":/^\.\.\//.test(a)?a=a.substring(3):/^\.\//.test(a)?a=a.substring(2):/^\/\.(\/|$)/.test(a)?a="/"+a.substring(3):/^\/\.\.(\/|$)/.test(a)?(a="/"+a.substring(4),b=b.replace(/\/?[^\/]+$/,"")):(c=a.match(/^(\/?[^\/]*)(\/.*)?$/),a=c[2],b+=c[1]);return b}return a},f=function(a,b){return""===a.authority||void 0!==a.path&&""!==a.path?a.path.replace(/[^\/]+$/,"")+b:"/"+b};a.uri=function(c,d){var e;return c=c||"",b[c]?b[c]:(d=d||a.uri.base(),"string"==typeof d&&(d=a.uri.absolute(d)),e=new a.uri.fn.init(c,d),b[e]?b[e]:(b[e]=e,e))},a.uri.fn=a.uri.prototype={scheme:void 0,authority:void 0,path:void 0,query:void 0,fragment:void 0,init:function(b,c){if(c=c||{},a.extend(this,d(b)),void 0===this.scheme&&(this.scheme=c.scheme,void 0!==this.authority?this.path=e(this.path):(this.authority=c.authority,""===this.path?(this.path=c.path,void 0===this.query&&(this.query=c.query)):(/^\//.test(this.path)||(this.path=f(c,this.path)),this.path=e(this.path)))),void 0===this.scheme)throw"Malformed URI: URI is not an absolute URI and no base supplied: "+b;return this},resolve:function(b){return a.uri(b,this)},relative:function(b){var c,d,e,f=0,g=[],h="";if("string"==typeof b&&(b=a.uri(b,{})),b.scheme!==this.scheme||b.authority!==this.authority)return b.toString();if(b.path!==this.path){if(c=b.path.split("/"),d=this.path.split("/"),c[1]!==d[1])h=b.path;else{for(;c[f]===d[f];)f+=1;for(e=f;f<d.length-1;f+=1)g.push("..");for(;e<c.length;e+=1)g.push(c[e]);h=g.join("/")}return h=void 0===b.query?h:h+"?"+b.query,h=void 0===b.fragment?h:h+"#"+b.fragment}return void 0!==b.query&&b.query!==this.query?"?"+b.query+(void 0===b.fragment?"":"#"+b.fragment):void 0!==b.fragment&&b.fragment!==this.fragment?"#"+b.fragment:""},toString:function(){var a="";return this._string?this._string:(a=void 0===this.scheme?a:a+this.scheme+":",a=void 0===this.authority?a:a+"//"+this.authority,a+=this.path,a=void 0===this.query?a:a+"?"+this.query,a=void 0===this.fragment?a:a+"#"+this.fragment,this._string=a,a)}},a.uri.fn.init.prototype=a.uri.fn,a.uri.absolute=function(b){return a.uri(b,{})},a.uri.resolve=function(b,c){return a.uri(b,c)},a.uri.relative=function(b,c){return a.uri(c,{}).relative(b)},a.uri.base=function(){return a(document).base()},a.fn.base=function(){var b=a(this).parents().andSelf().find("base").attr("href"),c=a(this)[0].ownerDocument||document,d=a.uri.absolute(null===c.location?document.location.href:c.location.href);return void 0===b?d:a.uri(b,d)}}(jQuery),function(a){var b=/\sxmlns(?::([^ =]+))?\s*=\s*(?:"([^"]*)"|'([^']*)')/g;a.fn.xmlns=function(c,d,e){var f,g,h,i,j,k=this.eq(0),l=k.data("xmlns"),m=k[0],n=c?"xmlns:"+c:"xmlns",o=!1;if(void 0===d){if(void 0===c){if(void 0===l){if(l={},m.attributes&&m.attributes.getNamedItemNS)for(h=0;h<m.attributes.length;h+=1)f=m.attributes[h],/^xmlns(:(.+))?$/.test(f.nodeName)&&(c=/^xmlns(:(.+))?$/.exec(f.nodeName)[2]||"",i=f.nodeValue,(""===c||""!==i)&&(l[c]=a.uri(f.nodeValue),o=!0));else{for(j=/<[^>]+>/.exec(m.outerHTML),f=b.exec(j);null!==f;)c=f[1]||"",i=f[2]||f[3],(""===c||""!==i)&&(l[c]=a.uri(f[2]||f[3]),o=!0),f=b.exec(j);b.lastIndex=0}e=e||(1===m.parentNode.nodeType?k.parent().xmlns():{}),l=o?a.extend({},e,l):e,k.data("xmlns",l)}return l}if("object"==typeof c){for(g in c)"string"==typeof c[g]&&this.xmlns(g,c[g]);return this.find("*").andSelf().removeData("xmlns"),this}return void 0===l&&(l=k.xmlns()),l[c]}return this.find("*").andSelf().removeData("xmlns"),this.attr(n,d)},a.fn.removeXmlns=function(a){var b,c,d;if("object"==typeof a)if(void 0===a.length)for(c in a)"string"==typeof a[c]&&this.removeXmlns(c);else for(d=0;d<a.length;d+=1)this.removeXmlns(a[d]);else b=a?"xmlns:"+a:"xmlns",this.removeAttr(b);return this.find("*").andSelf().removeData("xmlns"),this},a.fn.qname=function(a){var b,c,d;if(void 0===a&&(a=void 0===this[0].outerHTML?this[0].nodeName.toLowerCase():/<([^ >]+)/.exec(this[0].outerHTML)[1].toLowerCase()),"?xml:namespace"===a)throw"XMLinHTML: Unable to get the prefix to resolve the name of this element";if(b=/^(([^:]+):)?([^:]+)$/.exec(a),c=b[2]||"",d=this.xmlns(c),void 0===d&&""!==c)throw"MalformedQName: The prefix "+c+" is not declared";return{namespace:d,localPart:b[3],prefix:c,name:a}}}(jQuery),function(a){var b=function(a){return a.replace(/[ \t\n\r]+/," ").replace(/^ +/,"").replace(/ +$/,"")};a.typedValue=function(b,c){return a.typedValue.fn.init(b,c)},a.typedValue.fn=a.typedValue.prototype={representation:void 0,value:void 0,datatype:void 0,init:function(c,d){var e;if(a.typedValue.valid(c,d))return e=a.typedValue.types[d],this.representation=c,this.datatype=d,this.value=e.value(e.strip?b(c):c),this;throw{name:"InvalidValue",message:c+" is not a valid "+d+" value"}}},a.typedValue.fn.init.prototype=a.typedValue.fn,a.typedValue.types={},a.typedValue.types["http://www.w3.org/2001/XMLSchema#string"]={regex:/^.*$/,strip:!1,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#boolean"]={regex:/^(?:true|false|1|0)$/,strip:!0,value:function(a){return"true"===a||"1"===a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#decimal"]={regex:/^[\-\+]?(?:[0-9]+\.[0-9]*|\.[0-9]+|[0-9]+)$/,strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#integer"]={regex:/^[\-\+]?[0-9]+$/,strip:!0,value:function(a){return parseInt(a,10)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#int"]={regex:/^[\-\+]?[0-9]+$/,strip:!0,value:function(a){return parseInt(a,10)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"]={regex:/^(?:[\-\+]?(?:[0-9]+\.[0-9]*|\.[0-9]+|[0-9]+)(?:[eE][\-\+]?[0-9]+)?|[\-\+]?INF|NaN)$/,strip:!0,value:function(a){return"-INF"===a?-1/0:"INF"===a||"+INF"===a?1/0:parseFloat(a)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#double"]={regex:a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"].regex,strip:!0,value:a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"].value},a.typedValue.types["http://www.w3.org/2001/XMLSchema#duration"]={regex:/^([\-\+])?P(?:([0-9]+)Y)?(?:([0-9]+)M)?(?:([0-9]+)D)?(?:T(?:([0-9]+)H)?(?:([0-9]+)M)?(?:([0-9]+(?:\.[0-9]+))?S)?)$/,validate:function(a){var b=this.regex.exec(a);return b[2]||b[3]||b[4]||b[5]||b[6]||b[7]},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#dateTime"]={regex:/^(-?[0-9]{4,})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):(([0-9]{2})(\.([0-9]+))?)((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b,c=this.regex.exec(a),d=parseInt(c[1],10),e=void 0===c[10]||"Z"===c[10]?"+0000":c[10].replace(/:/,"");if(0===d||parseInt(e,10)<-1400||parseInt(e,10)>1400)return!1;try{if(d=100>d?Math.abs(d)+1e3:d,month=parseInt(c[2],10),day=parseInt(c[3],10),day>31)return!1;if(day>30&&1!==month&&3!==month&&5!==month&&7!==month&&8!==month&&10!==month&&12!==month)return!1;if(2===month){if(day>29)return!1;if(29===day&&(d%4!==0||d%100===0&&d%400!==0))return!1}return b=""+d+"/"+c[2]+"/"+c[3]+" "+c[4]+":"+c[5]+":"+c[7]+" "+e,b=new Date(b),!0}catch(f){return!1}},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#date"]={regex:/^(-?[0-9]{4,})-([0-9]{2})-([0-9]{2})((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b=this.regex.exec(a),c=parseInt(b[1],10),d=parseInt(b[2],10),e=parseInt(b[3],10),f=void 0===b[10]||"Z"===b[10]?"+0000":b[10].replace(/:/,"");return 0===c||d>12||e>31||parseInt(f,10)<-1400||parseInt(f,10)>1400?!1:!0},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#gMonthDay"]={regex:/^--([0-9]{2})-([0-9]{2})((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b=this.regex.exec(a),c=parseInt(b[1],10),d=parseInt(b[2],10),e=void 0===b[3]||"Z"===b[3]?"+0000":b[3].replace(/:/,"");return c>12||d>31||parseInt(e,10)<-1400||parseInt(e,10)>1400?!1:2===c&&d>29?!1:(4===c||6===c||9===c||11===c)&&d>30?!1:!0},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#anyURI"]={regex:/^.*$/,strip:!0,value:function(b,c){var d=a.extend({},a.typedValue.defaults,c);return a.uri.resolve(b,d.base)}},a.typedValue.defaults={base:a.uri.base(),namespaces:{}},a.typedValue.valid=function(c,d){var e=a.typedValue.types[d];if(void 0===e)throw"InvalidDatatype: The datatype "+d+" can't be recognised";return c=e.strip?b(c):c,e.regex.test(c)?void 0===e.validate?!0:e.validate(c):!1}}(jQuery),function(a){a.curie=function(b,c){var d=a.extend({},a.curie.defaults,c||{}),e=/^(([^:]*):)?(.+)$/.exec(b),f=e[2],g=e[3],h=d.namespaces[f];if(/^:.+/.test(b)){if(void 0===d.reservedNamespace||null===d.reservedNamespace)throw"Malformed CURIE: No prefix and no default namespace for unprefixed CURIE "+b;h=d.reservedNamespace}else if(f){if(void 0===h)throw"Malformed CURIE: No namespace binding for "+f+" in CURIE "+b}else if("lower"===d.charcase?b=b.toLowerCase():"upper"===d.charcase&&(b=b.toUpperCase()),d.reserved.length&&a.inArray(b,d.reserved)>=0)h=d.reservedNamespace,g=b;else{if(void 0===d.defaultNamespace||null===d.defaultNamespace)throw"Malformed CURIE: No prefix and no default namespace for unprefixed CURIE "+b;h=d.defaultNamespace}return a.uri(h+g)},a.curie.defaults={namespaces:{},reserved:[],reservedNamespace:void 0,defaultNamespace:void 0,charcase:"preserve"},a.safeCurie=function(b,c){var d=/^\[([^\]]+)\]$/.exec(b);return d?a.curie(d[1],c):a.uri(b)},a.createCurie=function(b,c){var d,e=a.extend({},a.curie.defaults,c||{}),f=e.namespaces;if(b=a.uri(b).toString(),void 0!==e.reservedNamespace&&b.substring(0,e.reservedNamespace.toString().length)===e.reservedNamespace.toString()?(d=b.substring(e.reservedNamespace.toString().length),-1===a.inArray(d,e.reserved)&&(d=":"+d)):a.each(f,function(a,c){return b.substring(0,c.toString().length)===c.toString()?(d=a+":"+b.substring(c.toString().length),null):void 0}),void 0===d)throw"No Namespace Binding: There's no appropriate namespace binding for generating a CURIE from "+b;return d},a.fn.curie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.curie(b,d)},a.fn.safeCurie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.safeCurie(b,d)},a.fn.createCurie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.createCurie(b,d)},a.fn.curie.defaults={reserved:["alternate","appendix","bookmark","cite","chapter","contents","copyright","first","glossary","help","icon","index","last","license","meta","next","p3pv1","prev","role","section","stylesheet","subsection","start","top","up"],reservedNamespace:"http://www.w3.org/1999/xhtml/vocab#",defaultNamespace:void 0,charcase:"lower"}}(jQuery),function(a){var b={},c={},d={},e={},f={},g="http://www.w3.org/2001/XMLSchema#",h="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2000/01/rdf-schema#",j=/^<(([^>]|\\>)*)>$/,k=/^("""((\\"|[^"])*)"""|"((\\"|[^"])*)")(@([a-z]+(-[a-z0-9]+)*)|\^\^(.+))?$/,l=/(("""((\\"|[^"])*)""")|("(\\"|[^"]|)*")|(<(\\>|[^>])*>)|\S)+/g,m=databankSeed=(new Date).getTime()%1e3,n=function(){return m+=1,"b"+m.toString(16)},o=function(){return databankSeed+=1,"data"+databankSeed.toString(16)},p=function(b,c){if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){try{return a.rdf.blank(b,c)}catch(e){throw"Bad Triple: Subject "+b+" is not a resource: "+e}}},q=function(b,c){if("a"===b)return a.rdf.type;if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){throw"Bad Triple: Property "+b+" is not a resource: "+d}},r=function(b,c){if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){try{return a.rdf.blank(b,c)}catch(e){try{return a.rdf.literal(b,c)}catch(f){throw"Bad Triple: Object "+b+" is not a resource or a literal "+f}}}},s=function(a,b,c){var d;return"string"==typeof b?(d=b.substring(1),c[d]&&c[d]!==a?null:(c[d]=a,c)):b===a?c:null},t=function(b,c){return a.map(b,function(a){var b=c.exec(a);return null===b?null:{bindings:b,triples:[a]}})},u=function(b,c,d){return a.map(b,function(b){var e=a.map(c,function(c){var d=!0;return a.each(c.bindings,function(a,c){return void 0!==b.bindings[a]&&b.bindings[a]!==c?(d=!1,!1):void 0}),d?c:null});return e.length>0?a.map(e,function(c){return{bindings:a.extend({},b.bindings,c.bindings),triples:a.unique(b.triples.concat(c.triples))}}):d?b:null})},v=function(b,c){var d,e,f;void 0===c.filterExp||a.isFunction(c.filterExp)||(void 0===b.union?(d="string"==typeof c.filterExp.subject?"":c.filterExp.subject,e="string"==typeof c.filterExp.property?"":c.filterExp.property,f="string"==typeof c.filterExp.object?"":c.filterExp.object,void 0===b.queries[d]&&(b.queries[d]={}),void 0===b.queries[d][e]&&(b.queries[d][e]={}),void 0===b.queries[d][e][f]&&(b.queries[d][e][f]=[]),b.queries[d][e][f].push(c)):a.each(b.union,function(a,b){v(b,c)}))},w=function(b){b.length=0,b.matches=[],a.each(b.children,function(a,b){w(b)}),a.each(b.partOf,function(a,b){w(b)})},x=function(b,c){c.length>0&&(a.each(b.children,function(a,b){y(b,c)}),a.each(b.partOf,function(a,b){x(b,c)}),a.each(c,function(a,c){b.matches.push(c),Array.prototype.push.call(b,c.bindings)}))},y=function(b,c){var d;void 0===b.union?b.top||b.parent.top?d=b.alphaMemory:(c=c||b.parent.matches,d=a.isFunction(b.filterExp)?a.map(c,function(a,c){return b.filterExp.call(a.bindings,c,a.bindings,a.triples)?a:null}):u(c,b.alphaMemory,b.filterExp.optional)):d=a.map(b.union,function(a){return a.matches}),x(b,d)},z=function(a,b){var c;a.filterExp.optional?(w(a),y(a)):(c=a.top||a.parent.top?[b]:u(a.parent.matches,[b],!1),x(a,c))},A=function(a,b){var c,d=a.filterExp.exec(b);null!==d&&(c={triples:[b],bindings:d},a.alphaMemory.push(c),z(a,c))},B=function(b,c){b.alphaMemory.splice(a.inArray(c,b.alphaMemory),1),w(b),y(b)},C=function(b,c){a.each(b,function(a,b){A(b,c)})},D=function(b,c){a.each(b,function(a,b){B(b,c)})},E=function(b,c){var d=c.subject,e=c.property,f=c.object;void 0===b.union?(void 0!==b.queries[d]&&(void 0!==b.queries[d][e]&&(void 0!==b.queries[d][e][f]&&C(b.queries[d][e][f],c),void 0!==b.queries[d][e][""]&&C(b.queries[d][e][""],c)),void 0!==b.queries[d][""]&&(void 0!==b.queries[d][""][f]&&C(b.queries[d][""][f],c),void 0!==b.queries[d][""][""]&&C(b.queries[d][""][""],c))),void 0!==b.queries[""]&&(void 0!==b.queries[""][e]&&(void 0!==b.queries[""][e][f]&&C(b.queries[""][e][f],c),void 0!==b.queries[""][e][""]&&C(b.queries[""][e][""],c)),void 0!==b.queries[""][""]&&(void 0!==b.queries[""][""][f]&&C(b.queries[""][""][f],c),void 0!==b.queries[""][""][""]&&C(b.queries[""][""][""],c)))):a.each(b.union,function(a,b){E(b,c)})},F=function(b,c){var d=c.subject,e=c.property,f=c.object;void 0===b.union?(void 0!==b.queries[d]&&(void 0!==b.queries[d][e]&&(void 0!==b.queries[d][e][f]&&D(b.queries[d][e][f],c),void 0!==b.queries[d][e][""]&&D(b.queries[d][e][""],c)),void 0!==b.queries[d][""]&&(void 0!==b.queries[d][""][f]&&D(b.queries[d][""][f],c),void 0!==b.queries[d][""][""]&&D(b.queries[d][""][""],c))),void 0!==b.queries[""]&&(void 0!==b.queries[""][e]&&(void 0!==b.queries[""][e][f]&&D(b.queries[""][e][f],c),void 0!==b.queries[""][e][""]&&D(b.queries[""][e][""],c)),void 0!==b.queries[""][""]&&(void 0!==b.queries[""][""][f]&&D(b.queries[""][""][f],c),void 0!==b.queries[""][""][""]&&D(b.queries[""][""][""],c)))):a.each(b.union,function(a,b){F(b,c)})},G=function(a){var b,c,d,e,f={};for(b=0;b<a.length;b+=1)c=a[b],d=c.subject.value.toString(),e=c.property.value.toString(),void 0===f[d]&&(f[d]={}),void 0===f[d][e]&&(f[d][e]=[]),f[d][e].push(c.object.dump());return f},H=function(b){var c,d,e,f,g,h,i,j,k=[];for(c in b){d="_:"===c.substring(0,2)?a.rdf.blank(c):a.rdf.resource("<"+c+">");for(e in b[c])for(f=a.rdf.resource("<"+e+">"),i=0;i<b[c][e].length;i+=1)g=b[c][e][i],"uri"===g.type?h=a.rdf.resource("<"+g.value+">"):"bnode"===g.type?h=a.rdf.blank(g.value):void 0!==g.datatype?h=a.rdf.literal(g.value,{datatype:g.datatype}):(j={},void 0!==g.lang&&(j.lang=g.lang),h=a.rdf.literal('"'+g.value+'"',j)),k.push(a.rdf.triple(d,f,h))}return k},I=function(a,b,c,d){var e,f=a.ownerDocument;return void 0!==b&&null!==b?f.createAttributeNS?(e=f.createAttributeNS(b,c),e.nodeValue=d,a.attributes.setNamedItemNS(e)):(e=f.createNode(2,c,b),e.nodeValue=d,a.attributes.setNamedItem(e)):(e=f.createAttribute(c),e.nodeValue=d,a.attributes.setNamedItem(e)),a},J=function(a,b,c){return c?I(a,"http://www.w3.org/2000/xmlns/","xmlns:"+c,b):I(a,void 0,"xmlns",b),a},K=function(a,b){var c,d,e="",f=!1;return void 0!==a&&null!==a&&(/:/.test(b)&&(d=/([^:]+):/.exec(b)[1]),f=!0),document.implementation&&document.implementation.createDocument?(c=document.implementation.createDocument(a,b,null),f&&J(c.documentElement,a,d),c):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",e=void 0===d?' xmlns="'+a+'"':" xmlns:"+d+'="'+a+'"',c.loadXML("<"+b+e+"/>"),c)},L=function(a,b,c){var d,e=a.ownerDocument;return d=void 0!==b&&null!==b?e.createElementNS?e.createElementNS(b,c):e.createNode(1,c,b):e.createElement(c),a.appendChild(d),d},M=function(a,b){var c,d=a.ownerDocument;return c=d.createTextNode(b),a.appendChild(c),a},N=function(a,b){var c,d,e;try{d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML("<temp>"+b+"</temp>")}catch(f){c=new DOMParser,d=c.parseFromString("<temp>"+b+"</temp>","text/xml")}for(e=0;e<d.documentElement.childNodes.length;e+=1)a.appendChild(d.documentElement.childNodes[e].cloneNode(!0));return a},O=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p=K(h,"rdf:RDF"),q=G(b),r=c.namespaces||{};for(d in r)J(p.documentElement,r[d],d);for(e in q){if(void 0!==q[e][a.rdf.type.value]){l=/(.+[#\/])([^#\/]+)/.exec(q[e][a.rdf.type.value][0].value),n=l[1],m=l[2];for(d in r)if(r[d]===n){o=d;break}f=L(p.documentElement,n,o+":"+m)}else f=L(p.documentElement,h,"rdf:Description");/^_:/.test(e)?I(f,h,"rdf:nodeID",e.substring(2)):I(f,h,"rdf:about",e);for(g in q[e])if(g!==a.rdf.type.value.toString()||q[e][g].length>1){l=/(.+[#\/])([^#\/]+)/.exec(g),n=l[1],m=l[2];for(d in r)if(r[d]===n){o=d;break}for(j=g===a.rdf.type.value.toString()?1:0;j<q[e][g].length;j+=1)k=q[e][g][j],i=L(f,n,o+":"+m),"uri"===k.type?I(i,h,"rdf:resource",k.value):"literal"===k.type?void 0!==k.datatype?"http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===k.datatype?(I(i,h,"rdf:parseType","Literal"),N(i,k.value)):(I(i,h,"rdf:datatype",k.datatype),M(i,k.value)):void 0!==k.lang?(I(i,"http://www.w3.org/XML/1998/namespace","xml:lang",k.lang),M(i,k.value)):M(i,k.value):I(i,h,"rdf:nodeID",k.value.substring(2))}}return p},P=function(a){switch(a){case"http://www.w3.org/1999/02/22-rdf-syntax-ns":return"rdf";case"http://www.w3.org/XML/1998/namespace":return"xml";case"http://www.w3.org/2000/xmlns/":return"xmlns";default:throw"No default prefix mapped for namespace "+a}},Q=function(a,b,c){var d;if(a.hasAttributeNS)return a.hasAttributeNS(b,c);try{return d=/:/.test(c)?/:(.+)$/.exec(c)[1]:c,null!==a.attributes.getQualifiedItem(d,b)}catch(e){return null!==a.getAttribute(P(b)+":"+c)}},R=function(a,b,c){var d;if(a.getAttributeNS)return a.getAttributeNS(b,c);try{return d=/:/.test(c)?/:(.+)$/.exec(c)[1]:c,a.attributes.getQualifiedItem(d,b).nodeValue}catch(e){return a.getAttribute(P(b)+":"+c)}},S=function(a){return a.localName||a.baseName},T=function(b,c){var d,e;return Q(b,h,"about")?(d=R(b,h,"about"),e=a.rdf.resource("<"+d+">",{base:c})):Q(b,h,"ID")?(d=R(b,h,"ID"),e=a.rdf.resource("<#"+d+">",{base:c})):Q(b,h,"nodeID")?(d=R(b,h,"nodeID"),e=a.rdf.blank("_:"+d)):e=a.rdf.blank("[]"),e},U=function(b,c,d,e){var f,g,i,j,k,l,e,m,n,o,p,q,r,s,t,u=1,v=[],w={},x=[];for(e=R(b,"http://www.w3.org/XML/1998/namespace","lang")||e,d=R(b,"http://www.w3.org/XML/1998/namespace","base")||d,null!==e&&void 0!==e&&""!==e&&(w={lang:e}),f=T(b,d),!c||b.namespaceURI===h&&"Description"===S(b)||(i=a.rdf.type,k=a.rdf.resource("<"+b.namespaceURI+S(b)+">"),x.push(a.rdf.triple(f,i,k))),m=0;m<b.attributes.length;m+=1)g=b.attributes.item(m),void 0!==g.namespaceURI&&"http://www.w3.org/2000/xmlns/"!==g.namespaceURI&&"http://www.w3.org/XML/1998/namespace"!==g.namespaceURI&&"xmlns"!==g.prefix&&"xml"!==g.prefix&&(g.namespaceURI!==h?(i=a.rdf.resource("<"+g.namespaceURI+S(g)+">"),k=a.rdf.literal('"'+g.nodeValue+'"',w),x.push(a.rdf.triple(f,i,k))):"type"===S(g)&&(i=a.rdf.type,k=a.rdf.resource("<"+g.nodeValue+">",{base:d}),x.push(a.rdf.triple(f,i,k))));for(m=0;m<b.childNodes.length;m+=1)if(g=b.childNodes[m],1===g.nodeType){if(g.namespaceURI===h&&"li"===S(g)?(i=a.rdf.resource("<"+h+"_"+u+">"),u+=1):i=a.rdf.resource("<"+g.namespaceURI+S(g)+">"),e=R(g,"http://www.w3.org/XML/1998/namespace","lang")||e,null!==e&&void 0!==e&&""!==e&&(w={lang:e}),Q(g,h,"resource"))j=R(g,h,"resource"),k=a.rdf.resource("<"+j+">",{base:d});else if(Q(g,h,"nodeID"))j=R(g,h,"nodeID"),k=a.rdf.blank("_:"+j);else if(Q(g,h,"parseType")){if(r=R(g,h,"parseType"),"Literal"===r){try{s=new XMLSerializer,j=s.serializeToString(g.getElementsByTagName("*")[0])}catch(y){for(j="",n=0;n<g.childNodes.length;n+=1)j+=g.childNodes[n].xml}k=a.rdf.literal(j,{datatype:h+"XMLLiteral"})}else if("Resource"===r)t=U(g,!1,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=a.rdf.blank("[]");else if("Collection"===r)if(g.getElementsByTagName("*").length>0){for(n=0;n<g.childNodes.length;n+=1)j=g.childNodes[n],1===j.nodeType&&v.push(j);for(o=a.rdf.blank("[]"),k=o,n=0;n<v.length;n+=1)j=v[n],t=U(j,!0,d,e),t.length>0?(q=t[t.length-1].subject,x=x.concat(t)):q=T(j),x.push(a.rdf.triple(o,a.rdf.first,q)),n===v.length-1?x.push(a.rdf.triple(o,a.rdf.rest,a.rdf.nil)):(p=a.rdf.blank("[]"),x.push(a.rdf.triple(o,a.rdf.rest,p)),o=p)}else k=a.rdf.nil}else if(Q(g,h,"datatype"))j=g.childNodes[0].nodeValue,k=a.rdf.literal(j,{datatype:R(g,h,"datatype")});else if(g.getElementsByTagName("*").length>0)for(n=0;n<g.childNodes.length;n+=1)j=g.childNodes[n],1===j.nodeType&&(t=U(j,!0,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=T(j));else g.childNodes.length>0?(j=g.childNodes[0].nodeValue,k=a.rdf.literal('"'+j+'"',w)):(t=U(g,!1,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=a.rdf.blank("[]"));x.push(a.rdf.triple(f,i,k)),Q(g,h,"ID")&&(l=a.rdf.resource("<#"+R(g,h,"ID")+">",{base:d}),x.push(a.rdf.triple(l,a.rdf.subject,f)),x.push(a.rdf.triple(l,a.rdf.property,i)),x.push(a.rdf.triple(l,a.rdf.object,k)))
}return x},V=function(b){var c,d,e,f=[];if(b.documentElement.namespaceURI===h&&"RDF"===S(b.documentElement))for(d=R(b.documentElement,"http://www.w3.org/XML/1998/namespace","lang"),base=R(b.documentElement,"http://www.w3.org/XML/1998/namespace","base")||a.uri.base(),c=0;c<b.documentElement.childNodes.length;c+=1)e=b.documentElement.childNodes[c],1===e.nodeType&&(f=f.concat(U(e,!0,base,d)));else f=U(b.documentElement,!0);return f};a.typedValue.types["http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"]={regex:/^.*$/m,strip:!1,value:function(a){return a}},a.rdf=function(b){return new a.rdf.fn.init(b)},a.rdf.fn=a.rdf.prototype={rdfquery:"0.9",init:function(b){var c;return b=b||{},this.parent=b.parent,this.union=b.union,this.top=void 0===this.parent&&void 0===this.union,void 0===this.union?this.databank=void 0===b.databank?void 0===this.parent?a.rdf.databank(b.triples,b):this.parent.databank:b.databank:(c=a.map(this.union,function(a){return a.databank}),c=a.unique(c),this.databank=void 0!==c[1]?a.rdf.databank(void 0,{union:c}):c[0]),this.children=[],this.partOf=[],this.filterExp=b.filter,this.alphaMemory=[],this.matches=[],this.length=0,void 0!==this.filterExp&&(a.isFunction(this.filterExp)||(v(this.databank,this),this.alphaMemory=t(this.databank.triples(),this.filterExp))),y(this),this},base:function(a){return void 0===a?this.databank.base():(this.databank.base(a),this)},prefix:function(a,b){return void 0===b?this.databank.prefix(a):(this.databank.prefix(a,b),this)},add:function(b,c){var d,e;if(void 0!==b.rdfquery){if(b.top)return e=this.databank.add(b.databank),d=a.rdf({parent:this.parent,databank:e});if(this.top)return e=b.databank.add(this.databank),d=a.rdf({parent:b.parent,databank:e});if(void 0===this.union)return d=a.rdf({union:[this,b]}),this.partOf.push(d),b.partOf.push(d),d;this.union.push(b),b.partOf.push(this)}else"string"==typeof b&&(c=a.extend({},{base:this.base(),namespaces:this.prefix(),source:b},c),b=a.rdf.pattern(b,c)),b.isFixed()?this.databank.add(b.triple(),c):(d=this,this.each(function(a,e){var f=b.triple(e);null!==f&&d.databank.add(f,c)}));return this},remove:function(b,c){return"string"==typeof b&&(c=a.extend({},{base:this.base(),namespaces:this.prefix()},c),b=a.rdf.pattern(b,c)),b.isFixed()?this.databank.remove(b.triple(),c):(query=this,this.each(function(a,d){var e=b.triple(d);null!==e&&query.databank.remove(e,c)})),this},load:function(a,b){return this.databank.load(a,b),this},except:function(b){return a.rdf({databank:this.databank.except(b.databank)})},where:function(b,c){var d,e,f,g;return c=c||{},"string"==typeof b&&(e=c.base||this.base(),f=a.extend({},this.prefix(),c.namespaces||{}),g=c.optional||!1,b=a.rdf.pattern(b,{namespaces:f,base:e,optional:g})),d=a.rdf(a.extend({},c,{parent:this,filter:b})),this.children.push(d),d},optional:function(b,c){return this.where(b,a.extend({},c||{},{optional:!0}))},about:function(a,b){return this.where(a+" ?property ?value",b)},filter:function(b,c){var d,e;return d="string"==typeof b?c.constructor===RegExp?function(){return c.test(this[b].value)}:function(){return"literal"===this[b].type?this[b].value===c:this[b]===c}:b,e=a.rdf({parent:this,filter:d}),this.children.push(e),e},select:function(a){var b,c,d=[];for(b=0;b<this.length;b+=1)if(void 0===a)d[b]=this[b];else for(d[b]={},c=0;c<a.length;c+=1)d[b][a[c]]=this[b][a[c]];return d},describe:function(a){var b,c,d,e=[];for(b=0;b<a.length;b+=1)if(d=a[b],"?"===d.substring(0,1))for(d=d.substring(1),c=0;c<this.length;c+=1)e.push(this[c][d]);else e.push(d);return this.databank.describe(e)},eq:function(a){return this.filter(function(b){return b===a})},reset:function(){for(var a=this;void 0!==a.parent;)a=a.parent;return a},end:function(){return this.parent},size:function(){return this.length},sources:function(){return a(a.map(this.matches,function(a){return[a.triples]}))},dump:function(b){var c=a.map(this.matches,function(a){return a.triples});return b=a.extend({namespaces:this.databank.namespaces,base:this.databank.base},b||{}),a.rdf.dump(c,b)},get:function(b){return void 0===b?a.makeArray(this):this[b]},each:function(b){return a.each(this.matches,function(a,c){b.call(c.bindings,a,c.bindings,c.triples)}),this},map:function(b){return a(a.map(this.matches,function(a,c){return b.call(a.bindings,c,a.bindings,a.triples)}))},jquery:function(){return a(this)}},a.rdf.fn.init.prototype=a.rdf.fn,a.rdf.gleaners=[],a.rdf.dump=function(b,c){var d,e=a.extend({},a.rdf.dump.defaults,c||{}),f=e.format,g=e.serialize;if("application/json"===f)return d=G(b,e),g?a.toJSON(d):d;if("application/rdf+xml"===f)return d=O(b,e),g?d.xml?d.xml.replace(/\s+$/,""):(serializer=new XMLSerializer,serializer.serializeToString(d)):d;throw"Unrecognised dump format: "+f+". Expected application/json or application/rdf+xml."},a.rdf.dump.defaults={format:"application/json",serialize:!1,namespaces:{}},a.fn.rdf=function(){var b=[];return a(this)[0]&&9===a(this)[0].nodeType?a(this).children("*").rdf():a(this).length>0?(b=a(this).map(function(b,c){return a.map(a.rdf.gleaners,function(b){return b.call(a(c))})}),a.rdf({triples:b,namespaces:a(this).xmlns()})):a.rdf()},a.extend(a.expr[":"],{about:function(b,c,d){var e=a(b),f=d[3]?e.safeCurie(d[3]):null,g=!1;return a.each(a.rdf.gleaners,function(a,b){return g=b.call(e,{about:f}),g?null:void 0}),g},type:function(b,c,d){var e=a(b),f=d[3]?e.curie(d[3]):null,g=!1;return a.each(a.rdf.gleaners,function(a,b){return b.call(e,{type:f})?(g=!0,null):void 0}),g}}),a.rdf.databank=function(b,c){return new a.rdf.databank.fn.init(b,c)},a.rdf.databank.fn=a.rdf.databank.prototype={init:function(b,c){var d;if(b=b||[],c=c||{},this.id=o(),void 0===c.union)for(this.queries={},this.tripleStore={},this.objectStore={},this.baseURI=c.base||a.uri.base(),this.namespaces=a.extend({},c.namespaces||{}),d=0;d<b.length;d+=1)this.add(b[d]);else this.union=c.union;return this},base:function(b){return void 0===this.union?void 0===b?this.baseURI:(this.baseURI=b,this):void 0===b?this.union[0].base():(a.each(this.union,function(a,c){c.base(b)}),this)},prefix:function(b,c){var d={};return void 0===this.union?void 0===b?this.namespaces:void 0===c?this.namespaces[b]:(this.namespaces[b]=c,this):void 0===c?(a.each(this.union,function(b,c){a.extend(d,c.prefix())}),void 0===b?d:d[b]):(a.each(this.union,function(a,d){d.prefix(b,c)}),this)},add:function(b,c){var d,e=c&&c.base||this.base(),f=a.extend({},this.prefix(),c&&c.namespaces||{});return b===this?this:void 0!==b.tripleStore?void 0===this.union?d=a.rdf.databank(void 0,{union:[this,b]}):(this.union.push(b),this):("string"==typeof b&&(b=a.rdf.triple(b,{namespaces:f,base:e,source:b})),void 0===this.union?(void 0===this.tripleStore[b.subject]&&(this.tripleStore[b.subject]=[]),-1===a.inArray(b,this.tripleStore[b.subject])&&(this.tripleStore[b.subject].push(b),("uri"===b.object.type||"bnode"===b.object.type)&&(void 0===this.objectStore[b.object]&&(this.objectStore[b.object]=[]),this.objectStore[b.object].push(b)),E(this,b))):a.each(this.union,function(a,c){c.add(b)}),this)},remove:function(b,c){var d,e,f=c&&c.base||this.base(),g=a.extend({},this.prefix(),c&&c.namespaces||{});return"string"==typeof b&&(b=a.rdf.triple(b,{namespaces:g,base:f,source:b})),d=this.tripleStore[b.subject],void 0!==d&&d.splice(a.inArray(b,d),1),("uri"===b.object.type||"bnode"===b.object.type)&&(e=this.objectStore[b.object],void 0!==e&&e.splice(a.inArray(b,e),1)),F(this,b),this},except:function(b){var c=b.tripleStore,d=[];return a.each(this.tripleStore,function(b,e){var f=c[b];void 0===f?d=d.concat(e):a.each(e,function(b,c){-1===a.inArray(c,f)&&d.push(c)})}),a.rdf.databank(d)},triples:function(){var b=[];return void 0===this.union?a.each(this.tripleStore,function(a,c){b=b.concat(c)}):(a.each(this.union,function(a,c){b=b.concat(c.triples().get())}),b=a.unique(b)),a(b)},size:function(){return this.triples().length},describe:function(b){for(var c,d,e,f={},g=[];b.length>0;)if(d=b.pop(),void 0===f[d]){if(void 0===d.value&&(d=a.rdf.resource(d)),void 0!==this.tripleStore[d])for(c=0;c<this.tripleStore[d].length;c+=1)e=this.tripleStore[d][c],g.push(e),"bnode"===e.object.type&&b.push(e.object);if(void 0!==this.objectStore[d])for(c=0;c<this.objectStore[d].length;c+=1)e=this.objectStore[d][c],g.push(e),"bnode"===e.subject.type&&b.push(e.subject);f[d]=!0}return a.unique(g)},dump:function(b){return b=a.extend({namespaces:this.namespaces,base:this.base},b||{}),a.rdf.dump(this.triples(),b)},load:function(a){var b,c;for(c=void 0!==a.ownerDocument?V(a):H(a),b=0;b<c.length;b+=1)this.add(c[b]);return this},toString:function(){return"[Databank with "+this.size()+" triples]"}},a.rdf.databank.fn.init.prototype=a.rdf.databank.fn,a.rdf.pattern=function(b,c,d,e){var g,h,i;if(void 0===d){if(e=c||{},h=a.trim(b).match(l),3!==h.length&&(4!==h.length||"."!==h[3]))throw"Bad Pattern: Couldn't parse string "+b;b=h[0],c=h[1],d=h[2],i=void 0===e.optional?a.rdf.pattern.defaults.optional:e.optional}return f[b]&&f[b][c]&&f[b][c][d]&&f[b][c][d][i]?f[b][c][d][i]:(g=new a.rdf.pattern.fn.init(b,c,d,e),f[g.subject]&&f[g.subject][g.property]&&f[g.subject][g.property][g.object]&&f[g.subject][g.property][g.object][g.optional]?f[g.subject][g.property][g.object][g.optional]:(void 0===f[g.subject]&&(f[g.subject]={}),void 0===f[g.subject][g.property]&&(f[g.subject][g.property]={}),void 0===f[g.subject][g.property][g.object]&&(f[g.subject][g.property][g.object]={}),f[g.subject][g.property][g.object][g.optional]=g,g))},a.rdf.pattern.fn=a.rdf.pattern.prototype={init:function(b,c,d,e){var f=a.extend({},a.rdf.pattern.defaults,e);return this.subject="?"===b.toString().substring(0,1)?b:p(b,f),this.property="?"===c.toString().substring(0,1)?c:q(c,f),this.object="?"===d.toString().substring(0,1)?d:r(d,f),this.optional=f.optional,this},fill:function(b){var c=this.subject,d=this.property,e=this.object;return"string"==typeof c&&b[c.substring(1)]&&(c=b[c.substring(1)]),"string"==typeof d&&b[d.substring(1)]&&(d=b[d.substring(1)]),"string"==typeof e&&b[e.substring(1)]&&(e=b[e.substring(1)]),a.rdf.pattern(c,d,e,{optional:this.optional})},exec:function(a){var b={};return b=s(a.subject,this.subject,b),null===b?null:(b=s(a.property,this.property,b),null===b?null:b=s(a.object,this.object,b))},isFixed:function(){return"string"!=typeof this.subject&&"string"!=typeof this.property&&"string"!=typeof this.object},triple:function(b){var c=this;return this.isFixed()||(c=this.fill(b)),c.isFixed()?a.rdf.triple(c.subject,c.property,c.object,{source:this.toString()}):null},toString:function(){return this.subject+" "+this.property+" "+this.object}},a.rdf.pattern.fn.init.prototype=a.rdf.pattern.fn,a.rdf.pattern.defaults={base:a.uri.base(),namespaces:{},optional:!1},a.rdf.triple=function(b,c,d,f){var g,h,i;if(void 0===d){if(f=c,i=a.trim(b).match(l),3!==i.length&&(4!==i.length||"."!==i[3]))throw"Bad Triple: Couldn't parse string "+b;b=i[0],c=i[1],d=i[2]}return h=f&&f.graph||"",e[h]&&e[h][b]&&e[h][b][c]&&e[h][b][c][d]?e[h][b][c][d]:(g=new a.rdf.triple.fn.init(b,c,d,f),h=g.graph||"",e[h]&&e[h][g.subject]&&e[h][g.subject][g.property]&&e[h][g.subject][g.property][g.object]?e[h][g.subject][g.property][g.object]:(void 0===e[h]&&(e[h]={}),void 0===e[h][g.subject]&&(e[h][g.subject]={}),void 0===e[h][g.subject][g.property]&&(e[h][g.subject][g.property]={}),e[h][g.subject][g.property][g.object]=g,g))},a.rdf.triple.fn=a.rdf.triple.prototype={init:function(b,c,d,e){var f;return f=a.extend({},a.rdf.triple.defaults,e),this.subject=p(b,f),this.property=q(c,f),this.object=r(d,f),this.graph=void 0===f.graph?void 0:p(f.graph,f),this.source=f.source,this},isFixed:function(){return!0},triple:function(){return this},dump:function(){var a={},b=this.subject.value.toString(),c=this.property.value.toString();return a[b]={},a[b][c]=this.object.dump(),a},toString:function(){return this.subject+" "+this.property+" "+this.object+" ."}},a.rdf.triple.fn.init.prototype=a.rdf.triple.fn,a.rdf.triple.defaults={base:a.uri.base(),source:[document],namespaces:{}},a.rdf.resource=function(c,d){var e;return b[c]?b[c]:(e=new a.rdf.resource.fn.init(c,d),b[e]?b[e]:(b[e]=e,e))},a.rdf.resource.fn=a.rdf.resource.prototype={type:"uri",value:void 0,init:function(b,c){var d,e,f,g;if("string"==typeof b)if(d=j.exec(b),g=a.extend({},a.rdf.resource.defaults,c),null!==d)this.value=a.uri.resolve(d[1].replace(/\\>/g,">"),g.base);else if(":"===b.substring(0,1)){if(f=g.namespaces[""],void 0===f)throw"Malformed Resource: No namespace binding for default namespace in "+b;this.value=a.uri.resolve(f+b.substring(1))}else if(":"===b.substring(b.length-1)){if(e=b.substring(0,b.length-1),f=g.namespaces[e],void 0===f)throw"Malformed Resource: No namespace binding for prefix "+e+" in "+b;this.value=a.uri.resolve(f)}else try{this.value=a.curie(b,{namespaces:g.namespaces})}catch(h){throw"Malformed Resource: Bad format for resource "+h}else this.value=b;return this},dump:function(){return{type:"uri",value:this.value.toString()}},toString:function(){return"<"+this.value+">"}},a.rdf.resource.fn.init.prototype=a.rdf.resource.fn,a.rdf.resource.defaults={base:a.uri.base(),namespaces:{}},a.rdf.type=a.rdf.resource("<"+h+"type>"),a.rdf.label=a.rdf.resource("<"+i+"label>"),a.rdf.first=a.rdf.resource("<"+h+"first>"),a.rdf.rest=a.rdf.resource("<"+h+"rest>"),a.rdf.nil=a.rdf.resource("<"+h+"nil>"),a.rdf.subject=a.rdf.resource("<"+h+"subject>"),a.rdf.property=a.rdf.resource("<"+h+"property>"),a.rdf.object=a.rdf.resource("<"+h+"object>"),a.rdf.blank=function(b){var d;return c[b]?c[b]:(d=new a.rdf.blank.fn.init(b),c[d]?c[d]:(c[d]=d,d))},a.rdf.blank.fn=a.rdf.blank.prototype={type:"bnode",value:void 0,id:void 0,init:function(a){if("[]"===a)this.id=n(),this.value="_:"+this.id;else{if("_:"!==a.substring(0,2))throw"Malformed Blank Node: "+a+" is not a legal format for a blank node";this.id=a.substring(2),this.value=a}return this},dump:function(){return{type:"bnode",value:this.value}},toString:function(){return this.value}},a.rdf.blank.fn.init.prototype=a.rdf.blank.fn,a.rdf.literal=function(b,c){var e;return d[b]?d[b]:(e=new a.rdf.literal.fn.init(b,c),d[e]?d[e]:(d[e]=e,e))},a.rdf.literal.fn=a.rdf.literal.prototype={type:"literal",value:void 0,lang:void 0,datatype:void 0,init:function(b,c){var d,e,f=a.extend({},a.rdf.literal.defaults,c);if(void 0!==f.lang&&void 0!==f.datatype)throw"Malformed Literal: Cannot define both a language and a datatype for a literal ("+b+")";if(void 0!==f.datatype)e=a.safeCurie(f.datatype,{namespaces:f.namespaces}),a.extend(this,a.typedValue(b.toString(),e));else if(void 0!==f.lang)this.value=b.toString(),this.lang=f.lang;else if("boolean"==typeof b)a.extend(this,a.typedValue(b.toString(),g+"boolean"));else if("number"==typeof b)a.extend(this,a.typedValue(b.toString(),g+"double"));else if("true"===b||"false"===b)a.extend(this,a.typedValue(b,g+"boolean"));else if(a.typedValue.valid(b,g+"integer"))a.extend(this,a.typedValue(b,g+"integer"));else if(a.typedValue.valid(b,g+"decimal"))a.extend(this,a.typedValue(b,g+"decimal"));else if(a.typedValue.valid(b,g+"double")&&!/^\s*([\-\+]?INF|NaN)\s*$/.test(b))a.extend(this,a.typedValue(b,g+"double"));else{if(d=k.exec(b),null===d)throw"Malformed Literal: Couldn't recognise the value "+b;this.value=(d[2]||d[4]).replace(/\\"/g,'"'),d[9]?(e=a.rdf.resource(d[9],f),a.extend(this,a.typedValue(this.value,e.value))):d[7]&&(this.lang=d[7])}return this},dump:function(){var a={type:"literal",value:this.value.toString()};return void 0!==this.lang?a.lang=this.lang:void 0!==this.datatype&&(a.datatype=this.datatype.toString()),a},toString:function(){var a='"'+this.value+'"';return void 0!==this.lang?a+="@"+this.lang:void 0!==this.datatype&&(a+="^^<"+this.datatype+">"),a}},a.rdf.literal.fn.init.prototype=a.rdf.literal.fn,a.rdf.literal.defaults={base:a.uri.base(),namespaces:{},datatype:void 0,lang:void 0}}(jQuery),function(a){var b={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",xsd:"http://www.w3.org/2001/XMLSchema#"},c=b.rdf+"XMLLiteral",d=a.fn.curie.defaults,e=/\s([^ =]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|([^ >]+))/g,f=a.rdf.resource("<>"),g=function(a){var b,c,d="";if(!/&/.test(a))return a;for(;a.length>0;){if(b=/([^&]*)(&([^;]+);)(.*)/g.exec(a),null===b){d+=a;break}if(d+=b[1],c=b[3],a=b[4],"#"===c.charAt(0))d+=String.fromCharCode("x"===c.charAt(1)?parseInt(c.substring(2),16):parseInt(c.substring(1),10));else switch(c){case"amp":d+="&";break;case"nbsp":d+=String.fromCharCode(160);break;case"quot":d+='"';break;case"apos":d+="'";break;default:d+="&"+c+";"}}return d},h=function(b){var c,d,f,h,i,j,k,l,m={},n={};if(d=b[0],m[":length"]=0,d.attributes&&d.attributes.getNamedItemNS)for(k=d.attributes,c=0;c<k.length;c+=1)f=k[c],/^xmlns(:(.+))?$/.test(f.nodeName)&&""!==f.nodeValue?(l=/^xmlns(:(.+))?$/.exec(f.nodeName)[2]||"",m[l]=a.uri(f.nodeValue),m[":length"]+=1):/rel|rev|lang|xml:lang/.test(f.nodeName)?n[f.nodeName]=""===f.nodeValue?void 0:f.nodeValue:/about|href|src|resource|property|typeof|content|datatype/.test(f.nodeName)&&(n[f.nodeName]=null===f.nodeValue?void 0:f.nodeValue);else{for(h=/<[^>]+>/.exec(d.outerHTML),f=e.exec(h);null!==f;)i=f[1],j=f[2]||f[3]||f[4],/^xmlns/.test(i)&&"xmlns:"!==i&&""!==j?(l=/^xmlns(:(.+))?$/.exec(i)[2]||"",m[l]=a.uri(j),m[":length"]+=1):/about|href|src|resource|property|typeof|content|datatype|rel|rev|lang|xml:lang/.test(i)&&(n[i]=g(j)),f=e.exec(h);e.lastIndex=0}return{atts:n,namespaces:m}},j=function(a,b){var c=a[0].getAttribute(b);return("rev"===b||"rel"===b||"lang"===b||"xml:lang"===b)&&(c=""===c?void 0:c),null===c?void 0:c},k=function(b){return a.rdf.resource(b)},l=function(b,c,d){if("_:"===b.substring(0,2))return a.rdf.blank(b);try{return k(a.curie(b,d))}catch(e){return void 0}},m=function(b,c,d){var e=/^\[([^\]]+)\]$/.exec(b),f=d.base||c.base();return e?l(e[1],c,d):k(a.uri(b,f))},n=function(a,b,c){var d,e,f=[];for(a=a&&a.split?a.split(/[ \t\n\r\x0C]+/g):[],d=0;d<a.length;d+=1)""!==a[d]&&(e=l(a[d],b,c),void 0!==e&&f.push(e));return f},o=function(b,c,d){var e,f,g=[];for(c="uri"===c.type?c:a.rdf.resource(c,d),b=b&&b.split?b.split(/\s+/):[],e=0;e<b.length;e+=1)""!==b[e]&&(f=l(b[e],null,d),f!==c&&g.push(b[e]));return g.reverse().join(" ")},p=function(b,c,e){var f,g,i,j;return c=c||{},i=c.atts||h(b).atts,f=void 0===e?void 0!==i.rel||void 0!==i.rev:e,g=i.resource,g=void 0===g?i.href:g,void 0===g?g=f?a.rdf.blank("[]"):g:(j=c.curieOptions||a.extend({},d,{namespaces:b.xmlns()}),g=m(g,b,j)),g},q=function(b,c,e){var g,i,j,k,l=!1;return c=c||{},i=c.atts||h(b).atts,j=c.curieOptions||a.extend({},d,{namespaces:b.xmlns(),base:b.base()}),g=void 0===e?void 0!==i.rel||void 0!==i.rev:e,void 0!==i.about&&(k=m(i.about,b,j)),void 0===k&&void 0!==i.src&&(k=m(i.src,b,j)),g||void 0!==k||void 0===i.resource||(k=m(i.resource,b,j)),g||void 0!==k||void 0===i.href||(k=m(i.href,b,j)),void 0===k&&(/head|body/i.test(b[0].nodeName)?k=f:void 0!==i["typeof"]?k=a.rdf.blank("[]"):1===b[0].parentNode.nodeType?(k=c.object||p(b.parent())||q(b.parent()).subject,l=!g&&void 0===i.property):k=f),{subject:k,skip:l}},r=function(a,b){var c;return b=b||{},b.atts?(c=b.atts.lang,c=c||b.atts["xml:lang"]):(c=a[0].getAttribute("lang"),c=null===c||""===c?a[0].getAttribute("xml:lang"):c,c=null===c||""===c?void 0:c),void 0===c&&(b.lang?c=b.lang:1===a[0].parentNode.nodeType&&(c=r(a.parent()))),c},s=function(a){switch(a){case"<":return"&lt;";case'"':return"&quot;";case"&":return"&amp;"}},t=function(b,c){var d,f,g,h,i,j,k="";return b.contents().each(function(){var b=a(this),l=b[0];if(1===l.nodeType){if(h=l.nodeName.toLowerCase(),k+="<"+h,l.outerHTML){for(j=/<[^>]+>/.exec(l.outerHTML),g=e.exec(j);null!==g;)/^jQuery/.test(g[1])||(k+=" "+g[1]+"=",k+=g[2]?g[3]:'"'+g[1]+'"'),g=e.exec(j);e.lastIndex=0}else for(f=l.attributes,d=0;d<f.length;d+=1)g=f.item(d),k+=" "+g.nodeName+'="',k+=g.nodeValue.replace(/[<"&]/g,s),k+='"';c||(i=b.xmlns(""),void 0!==i&&void 0===b.attr("xmlns")&&(k+=' xmlns="'+i+'"')),k+=">",k+=t(b,!0),k+="</"+h+">"}else 8===l.nodeType?(k+="<!--",k+=l.nodeValue,k+="-->"):k+=l.nodeValue}),k},u=function(b){var e,f,g,i,j,k,l,m,o,s,v,w,x,y,z,A,B,C,D,E=[],F=this.children();if(b=b||{},y=b.forward||[],z=b.backward||[],A=h(this),B=A.atts,b.atts=B,C=b.namespaces||this.xmlns(),A.namespaces[":length"]>0){C=a.extend({},C);for(D in A.namespaces)":length"!==D&&(C[D]=A.namespaces[D])}if(b.curieOptions=a.extend({},d,{namespaces:C,base:this.base()}),f=q(this,b),i=r(this,b),f.skip)w=b.forward,x=b.backward,f=b.subject,g=b.object;else{if(f=f.subject,y.length>0||z.length>0){for(s=b.subject||q(this.parent()).subject,e=0;e<y.length;e+=1)o=a.rdf.triple(s,y[e],f,{source:this[0]}),E.push(o);for(e=0;e<z.length;e+=1)o=a.rdf.triple(f,z[e],s,{source:this[0]}),E.push(o)}for(g=p(this,b),l=n(B["typeof"],this,b.curieOptions),e=0;e<l.length;e+=1)o=a.rdf.triple(f,a.rdf.type,l[e],{source:this[0]}),E.push(o);if(v=n(B.property,this,b.curieOptions),v.length>0)for(j=B.datatype,k=B.content,void 0!==j&&""!==j?(j=a.curie(j,b.curieOptions),m=j===c?a.rdf.literal(t(this),{datatype:c}):void 0!==k?a.rdf.literal(k,{datatype:j}):a.rdf.literal(this.text(),{datatype:j})):void 0!==k?m=void 0===i?a.rdf.literal('"'+k+'"'):a.rdf.literal(k,{lang:i}):0===F.length||""===j?(i=r(this,b),m=void 0===i?a.rdf.literal('"'+this.text()+'"'):a.rdf.literal(this.text(),{lang:i})):m=a.rdf.literal(t(this),{datatype:c}),e=0;e<v.length;e+=1)o=a.rdf.triple(f,v[e],m,{source:this[0]}),E.push(o);if(w=n(B.rel,this,b.curieOptions),x=n(B.rev,this,b.curieOptions),void 0!==B.resource||void 0!==B.href){if(void 0!==w)for(e=0;e<w.length;e+=1)o=a.rdf.triple(f,w[e],g,{source:this[0]}),E.push(o);if(w=[],void 0!==x)for(e=0;e<x.length;e+=1)o=a.rdf.triple(g,x[e],f,{source:this[0]}),E.push(o);x=[]}}return F.each(function(){E=E.concat(u.call(a(this),{forward:w,backward:x,subject:f,object:g||f,lang:i,namespaces:C}))}),E},v=function(a){var b,c;return a&&void 0!==a.about?(c=h(this).atts,null===a.about?void 0!==c.property||void 0!==c.rel||void 0!==c.rev||void 0!==c["typeof"]:q(this,{atts:c}).subject.value===a.about):a&&void 0!==a.type?(b=j(this,"typeof"),void 0!==b?null===a.type?!0:this.curie(b)===a.type:!1):u.call(this)},w=1,x=function(d,e,f){var g,h,i;try{h=d.createCurie(f)}catch(k){f.toString()===c?(d.attr("xmlns:rdf",b.rdf),h="rdf:XMLLiteral"):(g=/^(.+[\/#])([^#]+)$/.exec(f),d.attr("xmlns:ns"+w,g[1]),h="ns"+w+":"+g[2],w+=1)}i=j(d,e),void 0!==i?-1===a.inArray(h,i.split(/\s+/))&&d.attr(e,i+" "+h):d.attr(e,h)},y=function(b,c,d){var e;e="bnode"===d.type?"[_:"+d.id+"]":a(b).base().relative(d.value),b.attr(c,e)},z=function(a,b){var c=q(a).subject;b!==c&&y(a,"about",b),a.removeData("rdfa.subject")},A=function(a,b){var c=p(a);b!==c&&y(a,"resource",b),a.removeData("rdfa.objectResource")},B=function(a,b){return a.wrapInner("<span></span>").children("span").attr("lang",b),a},C=function(b){var d,e,f,g,i,j,k,l,m,n,o,s,t,u=this.xmlns();if(i=this,t=h(this).atts,"string"==typeof b)b=a.rdf.triple(b,{namespaces:u,base:this.base()});else{if(b.rdfquery)return C.call(this,b.sources().get(0)),this;if(b.length){for(s=0;s<b.length;s+=1)C.call(this,b[s]);return this}}if(e=void 0!==t.rel||void 0!==t.rev,f=e||void 0!==t.property||void 0!==t["typeof"],"literal"!==b.object.type)j=q(this,{atts:t},!0).subject,l=p(this,{atts:t},!0),g=!f&&void 0===t.resource,k=j===b.subject,m=l===b.object,b.property===a.rdf.type?k?x(this,"typeof",b.object.value):f?(i=this.wrapInner("<span />").children("span"),x(i,"typeof",b.object.value),l!==b.subject&&z(i,b.subject)):(x(this,"typeof",b.object.value),z(this,b.subject)):k?m?x(this,"rel",b.property.value):g||!f?(x(this,"rel",b.property.value),A(this,b.object)):(i=this.wrap("<span />").parent(),x(i,"rev",b.property.value),z(i,b.object)):j===b.object?l===b.subject?x(this,"rev",b.property.value):g||!f?(x(this,"rev",b.property.value),A(this,b.subject)):(i=this.wrap("<span />").parent(),x(i,"rel",b.property.value),z(i,b.subject)):m?f?(i=this.wrapInner("<span />").children("span"),x(i,"rev",b.property.value),A(i,b.subject),i=i.wrapInner("<span />").children("span"),z(i,b.object),i=this):(z(this,b.subject),x(this,"rel",b.property.value)):l===b.subject?f?(i=this.wrapInner("<span />").children("span"),x(i,"rel",this.property.value),A(i,b.object),i=i.wrapInner("<span />").children("span"),z(i,l),i=this):(z(this,b.object),x(this,"rev",b.property.value)):f?(i=this.wrapInner("<span />").children("span"),x(i,"rel",b.property.value),z(i,b.subject),A(i,b.object),i.children("*").length>0&&(i=this.wrapInner("<span />").children("span"),z(i,j)),i=this):(x(i,"rel",b.property.value),z(this,b.subject),A(this,b.object),this.children("*").length>0&&(i=this.wrapInner("<span />").children("span"),z(i,j),i=this));else if(j=q(this,{atts:t}).subject,l=p(this,{atts:t}),k=j===b.subject,d=this.text()!==b.object.value,void 0!==t.property){if(o=t.content,m=void 0!==o?o===b.object.value:!d,!k||!m)return i=this.wrapInner("<span />").children("span"),C.call(i,b);x(this,"property",b.property.value)}else{if(l===b.subject)return i=this.wrapInner("<span />").children("span"),C.call(i,b);x(this,"property",b.property.value),z(this,b.subject),d&&(b.object.datatype&&b.object.datatype.toString()===c?this.html(b.object.value):this.attr("content",b.object.value)),n=r(this),b.object.lang?n!==b.object.lang&&(this.attr("lang",b.object.lang),d&&B(this,n)):b.object.datatype?x(this,"datatype",b.object.datatype):(d||this.attr("datatype",""),void 0!==n&&(this.attr("lang",""),d&&B(this,n)))}return this.parents().andSelf().trigger("rdfChange"),i},D=function(a){var b,c,d,e,f,g=this.xmlns();if(b=h(this).atts,a.length){for(i=0;i<a.length;i+=1)D.call(this,a[i]);return this}return hasRelation=void 0!==b.rel||void 0!==b.rev,hasRDFa=hasRelation||void 0!==b.property||void 0!==b["typeof"],hasRDFa&&(void 0!==a.property&&(void 0!==b.property&&(c=o(b.property,a.property,{namespaces:g}),""===c?this.removeAttr("property"):this.attr("property",c)),void 0!==b.rel&&(d=o(b.rel,a.property,{namespaces:g}),""===d?this.removeAttr("rel"):this.attr("rel",d)),void 0!==b.rev&&(e=o(b.rev,a.property,{namespaces:g}),""===e?this.removeAttr("rev"):this.attr("rev",e))),void 0!==a.type&&void 0!==b["typeof"]&&(f=o(b["typeof"],a.type,{namespaces:g}),""===f?this.removeAttr("typeof"):this.attr("typeof",f)),b.property===this.attr("property")&&b.rel===this.attr("rel")&&b.rev===this.attr("rev")&&b["typeof"]===this.attr("typeof"))?D.call(this.parent(),a):(this.parents().andSelf().trigger("rdfChange"),this)};a.fn.rdfa=function(b){if(void 0===b){var c=a.map(a(this),function(b){return u.call(a(b))});return a.rdf({triples:c})}return a(this).each(function(){C.call(a(this),b)}),this},a.fn.removeRdfa=function(b){return a(this).each(function(){D.call(a(this),b)}),this},a.rdf.gleaners.push(v)}(jQuery),function(a){var b={},c=/^(([a-z][\-a-z0-9+\.]*):)?(\/\/([^\/?#]+))?([^?#]*)?(\?([^#]*))?(#(.*))?$/i,d=function(a){var b=a.match(c);if(null===b)throw"Malformed URI: "+a;return{scheme:b[1]?b[2].toLowerCase():void 0,authority:b[3]?b[4]:void 0,path:b[5]||"",query:b[6]?b[7]:void 0,fragment:b[8]?b[9]:void 0}},e=function(a){var b="",c=[];if(/\./.test(a)){for(;void 0!==a&&""!==a;)"."===a||".."===a?a="":/^\.\.\//.test(a)?a=a.substring(3):/^\.\//.test(a)?a=a.substring(2):/^\/\.(\/|$)/.test(a)?a="/"+a.substring(3):/^\/\.\.(\/|$)/.test(a)?(a="/"+a.substring(4),b=b.replace(/\/?[^\/]+$/,"")):(c=a.match(/^(\/?[^\/]*)(\/.*)?$/),a=c[2],b+=c[1]);return b}return a},f=function(a,b){return""===a.authority||void 0!==a.path&&""!==a.path?a.path.replace(/[^\/]+$/,"")+b:"/"+b};a.uri=function(c,d){var e;return c=c||"",b[c]?b[c]:(d=d||a.uri.base(),"string"==typeof d&&(d=a.uri.absolute(d)),e=new a.uri.fn.init(c,d),b[e]?b[e]:(b[e]=e,e))},a.uri.fn=a.uri.prototype={scheme:void 0,authority:void 0,path:void 0,query:void 0,fragment:void 0,init:function(b,c){if(c=c||{},a.extend(this,d(b)),void 0===this.scheme&&(this.scheme=c.scheme,void 0!==this.authority?this.path=e(this.path):(this.authority=c.authority,""===this.path?(this.path=c.path,void 0===this.query&&(this.query=c.query)):(/^\//.test(this.path)||(this.path=f(c,this.path)),this.path=e(this.path)))),void 0===this.scheme)throw"Malformed URI: URI is not an absolute URI and no base supplied: "+b;return this},resolve:function(b){return a.uri(b,this)},relative:function(b){var c,d,e,f=0,g=[],h="";if("string"==typeof b&&(b=a.uri(b,{})),b.scheme!==this.scheme||b.authority!==this.authority)return b.toString();if(b.path!==this.path){if(c=b.path.split("/"),d=this.path.split("/"),c[1]!==d[1])h=b.path;else{for(;c[f]===d[f];)f+=1;for(e=f;f<d.length-1;f+=1)g.push("..");for(;e<c.length;e+=1)g.push(c[e]);h=g.join("/")}return h=void 0===b.query?h:h+"?"+b.query,h=void 0===b.fragment?h:h+"#"+b.fragment}return void 0!==b.query&&b.query!==this.query?"?"+b.query+(void 0===b.fragment?"":"#"+b.fragment):void 0!==b.fragment&&b.fragment!==this.fragment?"#"+b.fragment:""},toString:function(){var a="";return this._string?this._string:(a=void 0===this.scheme?a:a+this.scheme+":",a=void 0===this.authority?a:a+"//"+this.authority,a+=this.path,a=void 0===this.query?a:a+"?"+this.query,a=void 0===this.fragment?a:a+"#"+this.fragment,this._string=a,a)}},a.uri.fn.init.prototype=a.uri.fn,a.uri.absolute=function(b){return a.uri(b,{})},a.uri.resolve=function(b,c){return a.uri(b,c)},a.uri.relative=function(b,c){return a.uri(c,{}).relative(b)},a.uri.base=function(){return a(document).base()},a.fn.base=function(){var b=a(this).parents().andSelf().find("base").attr("href"),c=a(this)[0].ownerDocument||document,d=a.uri.absolute(null===c.location?document.location.href:c.location.href);return void 0===b?d:a.uri(b,d)}}(jQuery),function(a){var b=/\sxmlns(?::([^ =]+))?\s*=\s*(?:"([^"]*)"|'([^']*)')/g;a.fn.xmlns=function(c,d,e){var f,g,h,i,j,k=this.eq(0),l=k.data("xmlns"),m=k[0],n=c?"xmlns:"+c:"xmlns",o=!1;if(void 0===d){if(void 0===c){if(void 0===l){if(l={},m.attributes&&m.attributes.getNamedItemNS)for(h=0;h<m.attributes.length;h+=1)f=m.attributes[h],/^xmlns(:(.+))?$/.test(f.nodeName)&&(c=/^xmlns(:(.+))?$/.exec(f.nodeName)[2]||"",i=f.nodeValue,(""===c||""!==i)&&(l[c]=a.uri(f.nodeValue),o=!0));else{for(j=/<[^>]+>/.exec(m.outerHTML),f=b.exec(j);null!==f;)c=f[1]||"",i=f[2]||f[3],(""===c||""!==i)&&(l[c]=a.uri(f[2]||f[3]),o=!0),f=b.exec(j);b.lastIndex=0}e=e||(1===m.parentNode.nodeType?k.parent().xmlns():{}),l=o?a.extend({},e,l):e,k.data("xmlns",l)}return l}if("object"==typeof c){for(g in c)"string"==typeof c[g]&&this.xmlns(g,c[g]);return this.find("*").andSelf().removeData("xmlns"),this}return void 0===l&&(l=k.xmlns()),l[c]}return this.find("*").andSelf().removeData("xmlns"),this.attr(n,d)},a.fn.removeXmlns=function(a){var b,c,d;if("object"==typeof a)if(void 0===a.length)for(c in a)"string"==typeof a[c]&&this.removeXmlns(c);else for(d=0;d<a.length;d+=1)this.removeXmlns(a[d]);else b=a?"xmlns:"+a:"xmlns",this.removeAttr(b);return this.find("*").andSelf().removeData("xmlns"),this},a.fn.qname=function(a){var b,c,d;if(void 0===a&&(a=void 0===this[0].outerHTML?this[0].nodeName.toLowerCase():/<([^ >]+)/.exec(this[0].outerHTML)[1].toLowerCase()),"?xml:namespace"===a)throw"XMLinHTML: Unable to get the prefix to resolve the name of this element";if(b=/^(([^:]+):)?([^:]+)$/.exec(a),c=b[2]||"",d=this.xmlns(c),void 0===d&&""!==c)throw"MalformedQName: The prefix "+c+" is not declared";return{namespace:d,localPart:b[3],prefix:c,name:a}}}(jQuery),function(a){var b=function(a){return a.replace(/[ \t\n\r]+/," ").replace(/^ +/,"").replace(/ +$/,"")};a.typedValue=function(b,c){return a.typedValue.fn.init(b,c)},a.typedValue.fn=a.typedValue.prototype={representation:void 0,value:void 0,datatype:void 0,init:function(c,d){var e;if(a.typedValue.valid(c,d))return e=a.typedValue.types[d],this.representation=c,this.datatype=d,this.value=e.value(e.strip?b(c):c),this;throw{name:"InvalidValue",message:c+" is not a valid "+d+" value"}}},a.typedValue.fn.init.prototype=a.typedValue.fn,a.typedValue.types={},a.typedValue.types["http://www.w3.org/2001/XMLSchema#string"]={regex:/^.*$/,strip:!1,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#boolean"]={regex:/^(?:true|false|1|0)$/,strip:!0,value:function(a){return"true"===a||"1"===a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#decimal"]={regex:/^[\-\+]?(?:[0-9]+\.[0-9]*|\.[0-9]+|[0-9]+)$/,strip:!0,value:function(a){return a
}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#integer"]={regex:/^[\-\+]?[0-9]+$/,strip:!0,value:function(a){return parseInt(a,10)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#int"]={regex:/^[\-\+]?[0-9]+$/,strip:!0,value:function(a){return parseInt(a,10)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"]={regex:/^(?:[\-\+]?(?:[0-9]+\.[0-9]*|\.[0-9]+|[0-9]+)(?:[eE][\-\+]?[0-9]+)?|[\-\+]?INF|NaN)$/,strip:!0,value:function(a){return"-INF"===a?-1/0:"INF"===a||"+INF"===a?1/0:parseFloat(a)}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#double"]={regex:a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"].regex,strip:!0,value:a.typedValue.types["http://www.w3.org/2001/XMLSchema#float"].value},a.typedValue.types["http://www.w3.org/2001/XMLSchema#duration"]={regex:/^([\-\+])?P(?:([0-9]+)Y)?(?:([0-9]+)M)?(?:([0-9]+)D)?(?:T(?:([0-9]+)H)?(?:([0-9]+)M)?(?:([0-9]+(?:\.[0-9]+))?S)?)$/,validate:function(a){var b=this.regex.exec(a);return b[2]||b[3]||b[4]||b[5]||b[6]||b[7]},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#dateTime"]={regex:/^(-?[0-9]{4,})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):(([0-9]{2})(\.([0-9]+))?)((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b,c=this.regex.exec(a),d=parseInt(c[1],10),e=void 0===c[10]||"Z"===c[10]?"+0000":c[10].replace(/:/,"");if(0===d||parseInt(e,10)<-1400||parseInt(e,10)>1400)return!1;try{if(d=100>d?Math.abs(d)+1e3:d,month=parseInt(c[2],10),day=parseInt(c[3],10),day>31)return!1;if(day>30&&1!==month&&3!==month&&5!==month&&7!==month&&8!==month&&10!==month&&12!==month)return!1;if(2===month){if(day>29)return!1;if(29===day&&(d%4!==0||d%100===0&&d%400!==0))return!1}return b=""+d+"/"+c[2]+"/"+c[3]+" "+c[4]+":"+c[5]+":"+c[7]+" "+e,b=new Date(b),!0}catch(f){return!1}},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#date"]={regex:/^(-?[0-9]{4,})-([0-9]{2})-([0-9]{2})((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b=this.regex.exec(a),c=parseInt(b[1],10),d=parseInt(b[2],10),e=parseInt(b[3],10),f=void 0===b[10]||"Z"===b[10]?"+0000":b[10].replace(/:/,"");return 0===c||d>12||e>31||parseInt(f,10)<-1400||parseInt(f,10)>1400?!1:!0},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#gMonthDay"]={regex:/^--([0-9]{2})-([0-9]{2})((?:[\-\+]([0-9]{2}):([0-9]{2}))|Z)?$/,validate:function(a){var b=this.regex.exec(a),c=parseInt(b[1],10),d=parseInt(b[2],10),e=void 0===b[3]||"Z"===b[3]?"+0000":b[3].replace(/:/,"");return c>12||d>31||parseInt(e,10)<-1400||parseInt(e,10)>1400?!1:2===c&&d>29?!1:(4===c||6===c||9===c||11===c)&&d>30?!1:!0},strip:!0,value:function(a){return a}},a.typedValue.types["http://www.w3.org/2001/XMLSchema#anyURI"]={regex:/^.*$/,strip:!0,value:function(b,c){var d=a.extend({},a.typedValue.defaults,c);return a.uri.resolve(b,d.base)}},a.typedValue.defaults={base:a.uri.base(),namespaces:{}},a.typedValue.valid=function(c,d){var e=a.typedValue.types[d];if(void 0===e)throw"InvalidDatatype: The datatype "+d+" can't be recognised";return c=e.strip?b(c):c,e.regex.test(c)?void 0===e.validate?!0:e.validate(c):!1}}(jQuery),function(a){a.curie=function(b,c){var d=a.extend({},a.curie.defaults,c||{}),e=/^(([^:]*):)?(.+)$/.exec(b),f=e[2],g=e[3],h=d.namespaces[f];if(/^:.+/.test(b)){if(void 0===d.reservedNamespace||null===d.reservedNamespace)throw"Malformed CURIE: No prefix and no default namespace for unprefixed CURIE "+b;h=d.reservedNamespace}else if(f){if(void 0===h)throw"Malformed CURIE: No namespace binding for "+f+" in CURIE "+b}else if("lower"===d.charcase?b=b.toLowerCase():"upper"===d.charcase&&(b=b.toUpperCase()),d.reserved.length&&a.inArray(b,d.reserved)>=0)h=d.reservedNamespace,g=b;else{if(void 0===d.defaultNamespace||null===d.defaultNamespace)throw"Malformed CURIE: No prefix and no default namespace for unprefixed CURIE "+b;h=d.defaultNamespace}return a.uri(h+g)},a.curie.defaults={namespaces:{},reserved:[],reservedNamespace:void 0,defaultNamespace:void 0,charcase:"preserve"},a.safeCurie=function(b,c){var d=/^\[([^\]]+)\]$/.exec(b);return d?a.curie(d[1],c):a.uri(b)},a.createCurie=function(b,c){var d,e=a.extend({},a.curie.defaults,c||{}),f=e.namespaces;if(b=a.uri(b).toString(),void 0!==e.reservedNamespace&&b.substring(0,e.reservedNamespace.toString().length)===e.reservedNamespace.toString()?(d=b.substring(e.reservedNamespace.toString().length),-1===a.inArray(d,e.reserved)&&(d=":"+d)):a.each(f,function(a,c){return b.substring(0,c.toString().length)===c.toString()?(d=a+":"+b.substring(c.toString().length),null):void 0}),void 0===d)throw"No Namespace Binding: There's no appropriate namespace binding for generating a CURIE from "+b;return d},a.fn.curie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.curie(b,d)},a.fn.safeCurie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.safeCurie(b,d)},a.fn.createCurie=function(b,c){var d=a.extend({},a.fn.curie.defaults,{namespaces:this.xmlns()},c||{});return a.createCurie(b,d)},a.fn.curie.defaults={reserved:["alternate","appendix","bookmark","cite","chapter","contents","copyright","first","glossary","help","icon","index","last","license","meta","next","p3pv1","prev","role","section","stylesheet","subsection","start","top","up"],reservedNamespace:"http://www.w3.org/1999/xhtml/vocab#",defaultNamespace:void 0,charcase:"lower"}}(jQuery),function(a){var b={},c={},d={},e={},f={},g="http://www.w3.org/2001/XMLSchema#",h="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2000/01/rdf-schema#",j=/^<(([^>]|\\>)*)>$/,k=/^("""((\\"|[^"])*)"""|"((\\"|[^"])*)")(@([a-z]+(-[a-z0-9]+)*)|\^\^(.+))?$/,l=/(("""((\\"|[^"])*)""")|("(\\"|[^"]|)*")|(<(\\>|[^>])*>)|\S)+/g,m=databankSeed=(new Date).getTime()%1e3,n=function(){return m+=1,"b"+m.toString(16)},o=function(){return databankSeed+=1,"data"+databankSeed.toString(16)},p=function(b,c){if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){try{return a.rdf.blank(b,c)}catch(e){throw"Bad Triple: Subject "+b+" is not a resource: "+e}}},q=function(b,c){if("a"===b)return a.rdf.type;if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){throw"Bad Triple: Property "+b+" is not a resource: "+d}},r=function(b,c){if("string"!=typeof b)return b;try{return a.rdf.resource(b,c)}catch(d){try{return a.rdf.blank(b,c)}catch(e){try{return a.rdf.literal(b,c)}catch(f){throw"Bad Triple: Object "+b+" is not a resource or a literal "+f}}}},s=function(a,b,c){var d;return"string"==typeof b?(d=b.substring(1),c[d]&&c[d]!==a?null:(c[d]=a,c)):b===a?c:null},t=function(b,c){return a.map(b,function(a){var b=c.exec(a);return null===b?null:{bindings:b,triples:[a]}})},u=function(b,c,d){return a.map(b,function(b){var e=a.map(c,function(c){var d=!0;return a.each(c.bindings,function(a,c){return void 0!==b.bindings[a]&&b.bindings[a]!==c?(d=!1,!1):void 0}),d?c:null});return e.length>0?a.map(e,function(c){return{bindings:a.extend({},b.bindings,c.bindings),triples:a.unique(b.triples.concat(c.triples))}}):d?b:null})},v=function(b,c){var d,e,f;void 0===c.filterExp||a.isFunction(c.filterExp)||(void 0===b.union?(d="string"==typeof c.filterExp.subject?"":c.filterExp.subject,e="string"==typeof c.filterExp.property?"":c.filterExp.property,f="string"==typeof c.filterExp.object?"":c.filterExp.object,void 0===b.queries[d]&&(b.queries[d]={}),void 0===b.queries[d][e]&&(b.queries[d][e]={}),void 0===b.queries[d][e][f]&&(b.queries[d][e][f]=[]),b.queries[d][e][f].push(c)):a.each(b.union,function(a,b){v(b,c)}))},w=function(b){b.length=0,b.matches=[],a.each(b.children,function(a,b){w(b)}),a.each(b.partOf,function(a,b){w(b)})},x=function(b,c){c.length>0&&(a.each(b.children,function(a,b){y(b,c)}),a.each(b.partOf,function(a,b){x(b,c)}),a.each(c,function(a,c){b.matches.push(c),Array.prototype.push.call(b,c.bindings)}))},y=function(b,c){var d;void 0===b.union?b.top||b.parent.top?d=b.alphaMemory:(c=c||b.parent.matches,d=a.isFunction(b.filterExp)?a.map(c,function(a,c){return b.filterExp.call(a.bindings,c,a.bindings,a.triples)?a:null}):u(c,b.alphaMemory,b.filterExp.optional)):d=a.map(b.union,function(a){return a.matches}),x(b,d)},z=function(a,b){var c;a.filterExp.optional?(w(a),y(a)):(c=a.top||a.parent.top?[b]:u(a.parent.matches,[b],!1),x(a,c))},A=function(a,b){var c,d=a.filterExp.exec(b);null!==d&&(c={triples:[b],bindings:d},a.alphaMemory.push(c),z(a,c))},B=function(b,c){b.alphaMemory.splice(a.inArray(c,b.alphaMemory),1),w(b),y(b)},C=function(b,c){a.each(b,function(a,b){A(b,c)})},D=function(b,c){a.each(b,function(a,b){B(b,c)})},E=function(b,c){var d=c.subject,e=c.property,f=c.object;void 0===b.union?(void 0!==b.queries[d]&&(void 0!==b.queries[d][e]&&(void 0!==b.queries[d][e][f]&&C(b.queries[d][e][f],c),void 0!==b.queries[d][e][""]&&C(b.queries[d][e][""],c)),void 0!==b.queries[d][""]&&(void 0!==b.queries[d][""][f]&&C(b.queries[d][""][f],c),void 0!==b.queries[d][""][""]&&C(b.queries[d][""][""],c))),void 0!==b.queries[""]&&(void 0!==b.queries[""][e]&&(void 0!==b.queries[""][e][f]&&C(b.queries[""][e][f],c),void 0!==b.queries[""][e][""]&&C(b.queries[""][e][""],c)),void 0!==b.queries[""][""]&&(void 0!==b.queries[""][""][f]&&C(b.queries[""][""][f],c),void 0!==b.queries[""][""][""]&&C(b.queries[""][""][""],c)))):a.each(b.union,function(a,b){E(b,c)})},F=function(b,c){var d=c.subject,e=c.property,f=c.object;void 0===b.union?(void 0!==b.queries[d]&&(void 0!==b.queries[d][e]&&(void 0!==b.queries[d][e][f]&&D(b.queries[d][e][f],c),void 0!==b.queries[d][e][""]&&D(b.queries[d][e][""],c)),void 0!==b.queries[d][""]&&(void 0!==b.queries[d][""][f]&&D(b.queries[d][""][f],c),void 0!==b.queries[d][""][""]&&D(b.queries[d][""][""],c))),void 0!==b.queries[""]&&(void 0!==b.queries[""][e]&&(void 0!==b.queries[""][e][f]&&D(b.queries[""][e][f],c),void 0!==b.queries[""][e][""]&&D(b.queries[""][e][""],c)),void 0!==b.queries[""][""]&&(void 0!==b.queries[""][""][f]&&D(b.queries[""][""][f],c),void 0!==b.queries[""][""][""]&&D(b.queries[""][""][""],c)))):a.each(b.union,function(a,b){F(b,c)})},G=function(a){var b,c,d,e,f={};for(b=0;b<a.length;b+=1)c=a[b],d=c.subject.value.toString(),e=c.property.value.toString(),void 0===f[d]&&(f[d]={}),void 0===f[d][e]&&(f[d][e]=[]),f[d][e].push(c.object.dump());return f},H=function(b){var c,d,e,f,g,h,i,j,k=[];for(c in b){d="_:"===c.substring(0,2)?a.rdf.blank(c):a.rdf.resource("<"+c+">");for(e in b[c])for(f=a.rdf.resource("<"+e+">"),i=0;i<b[c][e].length;i+=1)g=b[c][e][i],"uri"===g.type?h=a.rdf.resource("<"+g.value+">"):"bnode"===g.type?h=a.rdf.blank(g.value):void 0!==g.datatype?h=a.rdf.literal(g.value,{datatype:g.datatype}):(j={},void 0!==g.lang&&(j.lang=g.lang),h=a.rdf.literal('"'+g.value+'"',j)),k.push(a.rdf.triple(d,f,h))}return k},I=function(a,b,c,d){var e,f=a.ownerDocument;return void 0!==b&&null!==b?f.createAttributeNS?(e=f.createAttributeNS(b,c),e.nodeValue=d,a.attributes.setNamedItemNS(e)):(e=f.createNode(2,c,b),e.nodeValue=d,a.attributes.setNamedItem(e)):(e=f.createAttribute(c),e.nodeValue=d,a.attributes.setNamedItem(e)),a},J=function(a,b,c){return c?I(a,"http://www.w3.org/2000/xmlns/","xmlns:"+c,b):I(a,void 0,"xmlns",b),a},K=function(a,b){var c,d,e="",f=!1;return void 0!==a&&null!==a&&(/:/.test(b)&&(d=/([^:]+):/.exec(b)[1]),f=!0),document.implementation&&document.implementation.createDocument?(c=document.implementation.createDocument(a,b,null),f&&J(c.documentElement,a,d),c):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",e=void 0===d?' xmlns="'+a+'"':" xmlns:"+d+'="'+a+'"',c.loadXML("<"+b+e+"/>"),c)},L=function(a,b,c){var d,e=a.ownerDocument;return d=void 0!==b&&null!==b?e.createElementNS?e.createElementNS(b,c):e.createNode(1,c,b):e.createElement(c),a.appendChild(d),d},M=function(a,b){var c,d=a.ownerDocument;return c=d.createTextNode(b),a.appendChild(c),a},N=function(a,b){var c,d,e;try{d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML("<temp>"+b+"</temp>")}catch(f){c=new DOMParser,d=c.parseFromString("<temp>"+b+"</temp>","text/xml")}for(e=0;e<d.documentElement.childNodes.length;e+=1)a.appendChild(d.documentElement.childNodes[e].cloneNode(!0));return a},O=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p=K(h,"rdf:RDF"),q=G(b),r=c.namespaces||{};for(d in r)J(p.documentElement,r[d],d);for(e in q){if(void 0!==q[e][a.rdf.type.value]){l=/(.+[#\/])([^#\/]+)/.exec(q[e][a.rdf.type.value][0].value),n=l[1],m=l[2];for(d in r)if(r[d]===n){o=d;break}f=L(p.documentElement,n,o+":"+m)}else f=L(p.documentElement,h,"rdf:Description");/^_:/.test(e)?I(f,h,"rdf:nodeID",e.substring(2)):I(f,h,"rdf:about",e);for(g in q[e])if(g!==a.rdf.type.value.toString()||q[e][g].length>1){l=/(.+[#\/])([^#\/]+)/.exec(g),n=l[1],m=l[2];for(d in r)if(r[d]===n){o=d;break}for(j=g===a.rdf.type.value.toString()?1:0;j<q[e][g].length;j+=1)k=q[e][g][j],i=L(f,n,o+":"+m),"uri"===k.type?I(i,h,"rdf:resource",k.value):"literal"===k.type?void 0!==k.datatype?"http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===k.datatype?(I(i,h,"rdf:parseType","Literal"),N(i,k.value)):(I(i,h,"rdf:datatype",k.datatype),M(i,k.value)):void 0!==k.lang?(I(i,"http://www.w3.org/XML/1998/namespace","xml:lang",k.lang),M(i,k.value)):M(i,k.value):I(i,h,"rdf:nodeID",k.value.substring(2))}}return p},P=function(a){switch(a){case"http://www.w3.org/1999/02/22-rdf-syntax-ns":return"rdf";case"http://www.w3.org/XML/1998/namespace":return"xml";case"http://www.w3.org/2000/xmlns/":return"xmlns";default:throw"No default prefix mapped for namespace "+a}},Q=function(a,b,c){var d;if(a.hasAttributeNS)return a.hasAttributeNS(b,c);try{return d=/:/.test(c)?/:(.+)$/.exec(c)[1]:c,null!==a.attributes.getQualifiedItem(d,b)}catch(e){return null!==a.getAttribute(P(b)+":"+c)}},R=function(a,b,c){var d;if(a.getAttributeNS)return a.getAttributeNS(b,c);try{return d=/:/.test(c)?/:(.+)$/.exec(c)[1]:c,a.attributes.getQualifiedItem(d,b).nodeValue}catch(e){return a.getAttribute(P(b)+":"+c)}},S=function(a){return a.localName||a.baseName},T=function(b,c){var d,e;return Q(b,h,"about")?(d=R(b,h,"about"),e=a.rdf.resource("<"+d+">",{base:c})):Q(b,h,"ID")?(d=R(b,h,"ID"),e=a.rdf.resource("<#"+d+">",{base:c})):Q(b,h,"nodeID")?(d=R(b,h,"nodeID"),e=a.rdf.blank("_:"+d)):e=a.rdf.blank("[]"),e},U=function(b,c,d,e){var f,g,i,j,k,l,e,m,n,o,p,q,r,s,t,u=1,v=[],w={},x=[];for(e=R(b,"http://www.w3.org/XML/1998/namespace","lang")||e,d=R(b,"http://www.w3.org/XML/1998/namespace","base")||d,null!==e&&void 0!==e&&""!==e&&(w={lang:e}),f=T(b,d),!c||b.namespaceURI===h&&"Description"===S(b)||(i=a.rdf.type,k=a.rdf.resource("<"+b.namespaceURI+S(b)+">"),x.push(a.rdf.triple(f,i,k))),m=0;m<b.attributes.length;m+=1)g=b.attributes.item(m),void 0!==g.namespaceURI&&"http://www.w3.org/2000/xmlns/"!==g.namespaceURI&&"http://www.w3.org/XML/1998/namespace"!==g.namespaceURI&&"xmlns"!==g.prefix&&"xml"!==g.prefix&&(g.namespaceURI!==h?(i=a.rdf.resource("<"+g.namespaceURI+S(g)+">"),k=a.rdf.literal('"'+g.nodeValue+'"',w),x.push(a.rdf.triple(f,i,k))):"type"===S(g)&&(i=a.rdf.type,k=a.rdf.resource("<"+g.nodeValue+">",{base:d}),x.push(a.rdf.triple(f,i,k))));for(m=0;m<b.childNodes.length;m+=1)if(g=b.childNodes[m],1===g.nodeType){if(g.namespaceURI===h&&"li"===S(g)?(i=a.rdf.resource("<"+h+"_"+u+">"),u+=1):i=a.rdf.resource("<"+g.namespaceURI+S(g)+">"),e=R(g,"http://www.w3.org/XML/1998/namespace","lang")||e,null!==e&&void 0!==e&&""!==e&&(w={lang:e}),Q(g,h,"resource"))j=R(g,h,"resource"),k=a.rdf.resource("<"+j+">",{base:d});else if(Q(g,h,"nodeID"))j=R(g,h,"nodeID"),k=a.rdf.blank("_:"+j);else if(Q(g,h,"parseType")){if(r=R(g,h,"parseType"),"Literal"===r){try{s=new XMLSerializer,j=s.serializeToString(g.getElementsByTagName("*")[0])}catch(y){for(j="",n=0;n<g.childNodes.length;n+=1)j+=g.childNodes[n].xml}k=a.rdf.literal(j,{datatype:h+"XMLLiteral"})}else if("Resource"===r)t=U(g,!1,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=a.rdf.blank("[]");else if("Collection"===r)if(g.getElementsByTagName("*").length>0){for(n=0;n<g.childNodes.length;n+=1)j=g.childNodes[n],1===j.nodeType&&v.push(j);for(o=a.rdf.blank("[]"),k=o,n=0;n<v.length;n+=1)j=v[n],t=U(j,!0,d,e),t.length>0?(q=t[t.length-1].subject,x=x.concat(t)):q=T(j),x.push(a.rdf.triple(o,a.rdf.first,q)),n===v.length-1?x.push(a.rdf.triple(o,a.rdf.rest,a.rdf.nil)):(p=a.rdf.blank("[]"),x.push(a.rdf.triple(o,a.rdf.rest,p)),o=p)}else k=a.rdf.nil}else if(Q(g,h,"datatype"))j=g.childNodes[0].nodeValue,k=a.rdf.literal(j,{datatype:R(g,h,"datatype")});else if(g.getElementsByTagName("*").length>0)for(n=0;n<g.childNodes.length;n+=1)j=g.childNodes[n],1===j.nodeType&&(t=U(j,!0,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=T(j));else g.childNodes.length>0?(j=g.childNodes[0].nodeValue,k=a.rdf.literal('"'+j+'"',w)):(t=U(g,!1,d,e),t.length>0?(k=t[t.length-1].subject,x=x.concat(t)):k=a.rdf.blank("[]"));x.push(a.rdf.triple(f,i,k)),Q(g,h,"ID")&&(l=a.rdf.resource("<#"+R(g,h,"ID")+">",{base:d}),x.push(a.rdf.triple(l,a.rdf.subject,f)),x.push(a.rdf.triple(l,a.rdf.property,i)),x.push(a.rdf.triple(l,a.rdf.object,k)))}return x},V=function(b){var c,d,e,f=[];if(b.documentElement.namespaceURI===h&&"RDF"===S(b.documentElement))for(d=R(b.documentElement,"http://www.w3.org/XML/1998/namespace","lang"),base=R(b.documentElement,"http://www.w3.org/XML/1998/namespace","base")||a.uri.base(),c=0;c<b.documentElement.childNodes.length;c+=1)e=b.documentElement.childNodes[c],1===e.nodeType&&(f=f.concat(U(e,!0,base,d)));else f=U(b.documentElement,!0);return f};a.typedValue.types["http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"]={regex:/^.*$/m,strip:!1,value:function(a){return a}},a.rdf=function(b){return new a.rdf.fn.init(b)},a.rdf.fn=a.rdf.prototype={rdfquery:"0.9",init:function(b){var c;return b=b||{},this.parent=b.parent,this.union=b.union,this.top=void 0===this.parent&&void 0===this.union,void 0===this.union?this.databank=void 0===b.databank?void 0===this.parent?a.rdf.databank(b.triples,b):this.parent.databank:b.databank:(c=a.map(this.union,function(a){return a.databank}),c=a.unique(c),this.databank=void 0!==c[1]?a.rdf.databank(void 0,{union:c}):c[0]),this.children=[],this.partOf=[],this.filterExp=b.filter,this.alphaMemory=[],this.matches=[],this.length=0,void 0!==this.filterExp&&(a.isFunction(this.filterExp)||(v(this.databank,this),this.alphaMemory=t(this.databank.triples(),this.filterExp))),y(this),this},base:function(a){return void 0===a?this.databank.base():(this.databank.base(a),this)},prefix:function(a,b){return void 0===b?this.databank.prefix(a):(this.databank.prefix(a,b),this)},add:function(b,c){var d,e;if(void 0!==b.rdfquery){if(b.top)return e=this.databank.add(b.databank),d=a.rdf({parent:this.parent,databank:e});if(this.top)return e=b.databank.add(this.databank),d=a.rdf({parent:b.parent,databank:e});if(void 0===this.union)return d=a.rdf({union:[this,b]}),this.partOf.push(d),b.partOf.push(d),d;this.union.push(b),b.partOf.push(this)}else"string"==typeof b&&(c=a.extend({},{base:this.base(),namespaces:this.prefix(),source:b},c),b=a.rdf.pattern(b,c)),b.isFixed()?this.databank.add(b.triple(),c):(d=this,this.each(function(a,e){var f=b.triple(e);null!==f&&d.databank.add(f,c)}));return this},remove:function(b,c){return"string"==typeof b&&(c=a.extend({},{base:this.base(),namespaces:this.prefix()},c),b=a.rdf.pattern(b,c)),b.isFixed()?this.databank.remove(b.triple(),c):(query=this,this.each(function(a,d){var e=b.triple(d);null!==e&&query.databank.remove(e,c)})),this},load:function(a,b){return this.databank.load(a,b),this},except:function(b){return a.rdf({databank:this.databank.except(b.databank)})},where:function(b,c){var d,e,f,g;return c=c||{},"string"==typeof b&&(e=c.base||this.base(),f=a.extend({},this.prefix(),c.namespaces||{}),g=c.optional||!1,b=a.rdf.pattern(b,{namespaces:f,base:e,optional:g})),d=a.rdf(a.extend({},c,{parent:this,filter:b})),this.children.push(d),d},optional:function(b,c){return this.where(b,a.extend({},c||{},{optional:!0}))},about:function(a,b){return this.where(a+" ?property ?value",b)},filter:function(b,c){var d,e;return d="string"==typeof b?c.constructor===RegExp?function(){return c.test(this[b].value)}:function(){return"literal"===this[b].type?this[b].value===c:this[b]===c}:b,e=a.rdf({parent:this,filter:d}),this.children.push(e),e},select:function(a){var b,c,d=[];for(b=0;b<this.length;b+=1)if(void 0===a)d[b]=this[b];else for(d[b]={},c=0;c<a.length;c+=1)d[b][a[c]]=this[b][a[c]];return d},describe:function(a){var b,c,d,e=[];for(b=0;b<a.length;b+=1)if(d=a[b],"?"===d.substring(0,1))for(d=d.substring(1),c=0;c<this.length;c+=1)e.push(this[c][d]);else e.push(d);return this.databank.describe(e)},eq:function(a){return this.filter(function(b){return b===a})},reset:function(){for(var a=this;void 0!==a.parent;)a=a.parent;return a},end:function(){return this.parent},size:function(){return this.length},sources:function(){return a(a.map(this.matches,function(a){return[a.triples]}))},dump:function(b){var c=a.map(this.matches,function(a){return a.triples});return b=a.extend({namespaces:this.databank.namespaces,base:this.databank.base},b||{}),a.rdf.dump(c,b)},get:function(b){return void 0===b?a.makeArray(this):this[b]},each:function(b){return a.each(this.matches,function(a,c){b.call(c.bindings,a,c.bindings,c.triples)}),this},map:function(b){return a(a.map(this.matches,function(a,c){return b.call(a.bindings,c,a.bindings,a.triples)}))},jquery:function(){return a(this)}},a.rdf.fn.init.prototype=a.rdf.fn,a.rdf.gleaners=[],a.rdf.dump=function(b,c){var d,e=a.extend({},a.rdf.dump.defaults,c||{}),f=e.format,g=e.serialize;if("application/json"===f)return d=G(b,e),g?a.toJSON(d):d;if("application/rdf+xml"===f)return d=O(b,e),g?d.xml?d.xml.replace(/\s+$/,""):(serializer=new XMLSerializer,serializer.serializeToString(d)):d;throw"Unrecognised dump format: "+f+". Expected application/json or application/rdf+xml."},a.rdf.dump.defaults={format:"application/json",serialize:!1,namespaces:{}},a.fn.rdf=function(){var b=[];return a(this)[0]&&9===a(this)[0].nodeType?a(this).children("*").rdf():a(this).length>0?(b=a(this).map(function(b,c){return a.map(a.rdf.gleaners,function(b){return b.call(a(c))})}),a.rdf({triples:b,namespaces:a(this).xmlns()})):a.rdf()},a.extend(a.expr[":"],{about:function(b,c,d){var e=a(b),f=d[3]?e.safeCurie(d[3]):null,g=!1;return a.each(a.rdf.gleaners,function(a,b){return g=b.call(e,{about:f}),g?null:void 0}),g},type:function(b,c,d){var e=a(b),f=d[3]?e.curie(d[3]):null,g=!1;return a.each(a.rdf.gleaners,function(a,b){return b.call(e,{type:f})?(g=!0,null):void 0}),g}}),a.rdf.databank=function(b,c){return new a.rdf.databank.fn.init(b,c)},a.rdf.databank.fn=a.rdf.databank.prototype={init:function(b,c){var d;if(b=b||[],c=c||{},this.id=o(),void 0===c.union)for(this.queries={},this.tripleStore={},this.objectStore={},this.baseURI=c.base||a.uri.base(),this.namespaces=a.extend({},c.namespaces||{}),d=0;d<b.length;d+=1)this.add(b[d]);else this.union=c.union;return this},base:function(b){return void 0===this.union?void 0===b?this.baseURI:(this.baseURI=b,this):void 0===b?this.union[0].base():(a.each(this.union,function(a,c){c.base(b)}),this)},prefix:function(b,c){var d={};return void 0===this.union?void 0===b?this.namespaces:void 0===c?this.namespaces[b]:(this.namespaces[b]=c,this):void 0===c?(a.each(this.union,function(b,c){a.extend(d,c.prefix())}),void 0===b?d:d[b]):(a.each(this.union,function(a,d){d.prefix(b,c)}),this)},add:function(b,c){var d,e=c&&c.base||this.base(),f=a.extend({},this.prefix(),c&&c.namespaces||{});return b===this?this:void 0!==b.tripleStore?void 0===this.union?d=a.rdf.databank(void 0,{union:[this,b]}):(this.union.push(b),this):("string"==typeof b&&(b=a.rdf.triple(b,{namespaces:f,base:e,source:b})),void 0===this.union?(void 0===this.tripleStore[b.subject]&&(this.tripleStore[b.subject]=[]),-1===a.inArray(b,this.tripleStore[b.subject])&&(this.tripleStore[b.subject].push(b),("uri"===b.object.type||"bnode"===b.object.type)&&(void 0===this.objectStore[b.object]&&(this.objectStore[b.object]=[]),this.objectStore[b.object].push(b)),E(this,b))):a.each(this.union,function(a,c){c.add(b)}),this)},remove:function(b,c){var d,e,f=c&&c.base||this.base(),g=a.extend({},this.prefix(),c&&c.namespaces||{});return"string"==typeof b&&(b=a.rdf.triple(b,{namespaces:g,base:f,source:b})),d=this.tripleStore[b.subject],void 0!==d&&d.splice(a.inArray(b,d),1),("uri"===b.object.type||"bnode"===b.object.type)&&(e=this.objectStore[b.object],void 0!==e&&e.splice(a.inArray(b,e),1)),F(this,b),this},except:function(b){var c=b.tripleStore,d=[];return a.each(this.tripleStore,function(b,e){var f=c[b];void 0===f?d=d.concat(e):a.each(e,function(b,c){-1===a.inArray(c,f)&&d.push(c)})}),a.rdf.databank(d)},triples:function(){var b=[];return void 0===this.union?a.each(this.tripleStore,function(a,c){b=b.concat(c)}):(a.each(this.union,function(a,c){b=b.concat(c.triples().get())}),b=a.unique(b)),a(b)},size:function(){return this.triples().length},describe:function(b){for(var c,d,e,f={},g=[];b.length>0;)if(d=b.pop(),void 0===f[d]){if(void 0===d.value&&(d=a.rdf.resource(d)),void 0!==this.tripleStore[d])for(c=0;c<this.tripleStore[d].length;c+=1)e=this.tripleStore[d][c],g.push(e),"bnode"===e.object.type&&b.push(e.object);if(void 0!==this.objectStore[d])for(c=0;c<this.objectStore[d].length;c+=1)e=this.objectStore[d][c],g.push(e),"bnode"===e.subject.type&&b.push(e.subject);f[d]=!0}return a.unique(g)},dump:function(b){return b=a.extend({namespaces:this.namespaces,base:this.base},b||{}),a.rdf.dump(this.triples(),b)},load:function(a){var b,c;for(c=void 0!==a.ownerDocument?V(a):H(a),b=0;b<c.length;b+=1)this.add(c[b]);return this},toString:function(){return"[Databank with "+this.size()+" triples]"}},a.rdf.databank.fn.init.prototype=a.rdf.databank.fn,a.rdf.pattern=function(b,c,d,e){var g,h,i;if(void 0===d){if(e=c||{},h=a.trim(b).match(l),3!==h.length&&(4!==h.length||"."!==h[3]))throw"Bad Pattern: Couldn't parse string "+b;b=h[0],c=h[1],d=h[2],i=void 0===e.optional?a.rdf.pattern.defaults.optional:e.optional}return f[b]&&f[b][c]&&f[b][c][d]&&f[b][c][d][i]?f[b][c][d][i]:(g=new a.rdf.pattern.fn.init(b,c,d,e),f[g.subject]&&f[g.subject][g.property]&&f[g.subject][g.property][g.object]&&f[g.subject][g.property][g.object][g.optional]?f[g.subject][g.property][g.object][g.optional]:(void 0===f[g.subject]&&(f[g.subject]={}),void 0===f[g.subject][g.property]&&(f[g.subject][g.property]={}),void 0===f[g.subject][g.property][g.object]&&(f[g.subject][g.property][g.object]={}),f[g.subject][g.property][g.object][g.optional]=g,g))},a.rdf.pattern.fn=a.rdf.pattern.prototype={init:function(b,c,d,e){var f=a.extend({},a.rdf.pattern.defaults,e);return this.subject="?"===b.toString().substring(0,1)?b:p(b,f),this.property="?"===c.toString().substring(0,1)?c:q(c,f),this.object="?"===d.toString().substring(0,1)?d:r(d,f),this.optional=f.optional,this},fill:function(b){var c=this.subject,d=this.property,e=this.object;return"string"==typeof c&&b[c.substring(1)]&&(c=b[c.substring(1)]),"string"==typeof d&&b[d.substring(1)]&&(d=b[d.substring(1)]),"string"==typeof e&&b[e.substring(1)]&&(e=b[e.substring(1)]),a.rdf.pattern(c,d,e,{optional:this.optional})},exec:function(a){var b={};return b=s(a.subject,this.subject,b),null===b?null:(b=s(a.property,this.property,b),null===b?null:b=s(a.object,this.object,b))},isFixed:function(){return"string"!=typeof this.subject&&"string"!=typeof this.property&&"string"!=typeof this.object},triple:function(b){var c=this;return this.isFixed()||(c=this.fill(b)),c.isFixed()?a.rdf.triple(c.subject,c.property,c.object,{source:this.toString()}):null},toString:function(){return this.subject+" "+this.property+" "+this.object}},a.rdf.pattern.fn.init.prototype=a.rdf.pattern.fn,a.rdf.pattern.defaults={base:a.uri.base(),namespaces:{},optional:!1},a.rdf.triple=function(b,c,d,f){var g,h,i;if(void 0===d){if(f=c,i=a.trim(b).match(l),3!==i.length&&(4!==i.length||"."!==i[3]))throw"Bad Triple: Couldn't parse string "+b;b=i[0],c=i[1],d=i[2]}return h=f&&f.graph||"",e[h]&&e[h][b]&&e[h][b][c]&&e[h][b][c][d]?e[h][b][c][d]:(g=new a.rdf.triple.fn.init(b,c,d,f),h=g.graph||"",e[h]&&e[h][g.subject]&&e[h][g.subject][g.property]&&e[h][g.subject][g.property][g.object]?e[h][g.subject][g.property][g.object]:(void 0===e[h]&&(e[h]={}),void 0===e[h][g.subject]&&(e[h][g.subject]={}),void 0===e[h][g.subject][g.property]&&(e[h][g.subject][g.property]={}),e[h][g.subject][g.property][g.object]=g,g))},a.rdf.triple.fn=a.rdf.triple.prototype={init:function(b,c,d,e){var f;return f=a.extend({},a.rdf.triple.defaults,e),this.subject=p(b,f),this.property=q(c,f),this.object=r(d,f),this.graph=void 0===f.graph?void 0:p(f.graph,f),this.source=f.source,this},isFixed:function(){return!0},triple:function(){return this},dump:function(){var a={},b=this.subject.value.toString(),c=this.property.value.toString();return a[b]={},a[b][c]=this.object.dump(),a},toString:function(){return this.subject+" "+this.property+" "+this.object+" ."}},a.rdf.triple.fn.init.prototype=a.rdf.triple.fn,a.rdf.triple.defaults={base:a.uri.base(),source:[document],namespaces:{}},a.rdf.resource=function(c,d){var e;return b[c]?b[c]:(e=new a.rdf.resource.fn.init(c,d),b[e]?b[e]:(b[e]=e,e))},a.rdf.resource.fn=a.rdf.resource.prototype={type:"uri",value:void 0,init:function(b,c){var d,e,f,g;if("string"==typeof b)if(d=j.exec(b),g=a.extend({},a.rdf.resource.defaults,c),null!==d)this.value=a.uri.resolve(d[1].replace(/\\>/g,">"),g.base);else if(":"===b.substring(0,1)){if(f=g.namespaces[""],void 0===f)throw"Malformed Resource: No namespace binding for default namespace in "+b;this.value=a.uri.resolve(f+b.substring(1))}else if(":"===b.substring(b.length-1)){if(e=b.substring(0,b.length-1),f=g.namespaces[e],void 0===f)throw"Malformed Resource: No namespace binding for prefix "+e+" in "+b;this.value=a.uri.resolve(f)}else try{this.value=a.curie(b,{namespaces:g.namespaces})}catch(h){throw"Malformed Resource: Bad format for resource "+h}else this.value=b;return this},dump:function(){return{type:"uri",value:this.value.toString()}},toString:function(){return"<"+this.value+">"}},a.rdf.resource.fn.init.prototype=a.rdf.resource.fn,a.rdf.resource.defaults={base:a.uri.base(),namespaces:{}},a.rdf.type=a.rdf.resource("<"+h+"type>"),a.rdf.label=a.rdf.resource("<"+i+"label>"),a.rdf.first=a.rdf.resource("<"+h+"first>"),a.rdf.rest=a.rdf.resource("<"+h+"rest>"),a.rdf.nil=a.rdf.resource("<"+h+"nil>"),a.rdf.subject=a.rdf.resource("<"+h+"subject>"),a.rdf.property=a.rdf.resource("<"+h+"property>"),a.rdf.object=a.rdf.resource("<"+h+"object>"),a.rdf.blank=function(b){var d;return c[b]?c[b]:(d=new a.rdf.blank.fn.init(b),c[d]?c[d]:(c[d]=d,d))},a.rdf.blank.fn=a.rdf.blank.prototype={type:"bnode",value:void 0,id:void 0,init:function(a){if("[]"===a)this.id=n(),this.value="_:"+this.id;else{if("_:"!==a.substring(0,2))throw"Malformed Blank Node: "+a+" is not a legal format for a blank node";this.id=a.substring(2),this.value=a}return this},dump:function(){return{type:"bnode",value:this.value}},toString:function(){return this.value}},a.rdf.blank.fn.init.prototype=a.rdf.blank.fn,a.rdf.literal=function(b,c){var e;return d[b]?d[b]:(e=new a.rdf.literal.fn.init(b,c),d[e]?d[e]:(d[e]=e,e))},a.rdf.literal.fn=a.rdf.literal.prototype={type:"literal",value:void 0,lang:void 0,datatype:void 0,init:function(b,c){var d,e,f=a.extend({},a.rdf.literal.defaults,c);if(void 0!==f.lang&&void 0!==f.datatype)throw"Malformed Literal: Cannot define both a language and a datatype for a literal ("+b+")";if(void 0!==f.datatype)e=a.safeCurie(f.datatype,{namespaces:f.namespaces}),a.extend(this,a.typedValue(b.toString(),e));else if(void 0!==f.lang)this.value=b.toString(),this.lang=f.lang;else if("boolean"==typeof b)a.extend(this,a.typedValue(b.toString(),g+"boolean"));else if("number"==typeof b)a.extend(this,a.typedValue(b.toString(),g+"double"));else if("true"===b||"false"===b)a.extend(this,a.typedValue(b,g+"boolean"));else if(a.typedValue.valid(b,g+"integer"))a.extend(this,a.typedValue(b,g+"integer"));else if(a.typedValue.valid(b,g+"decimal"))a.extend(this,a.typedValue(b,g+"decimal"));else if(a.typedValue.valid(b,g+"double")&&!/^\s*([\-\+]?INF|NaN)\s*$/.test(b))a.extend(this,a.typedValue(b,g+"double"));
else{if(d=k.exec(b),null===d)throw"Malformed Literal: Couldn't recognise the value "+b;this.value=(d[2]||d[4]).replace(/\\"/g,'"'),d[9]?(e=a.rdf.resource(d[9],f),a.extend(this,a.typedValue(this.value,e.value))):d[7]&&(this.lang=d[7])}return this},dump:function(){var a={type:"literal",value:this.value.toString()};return void 0!==this.lang?a.lang=this.lang:void 0!==this.datatype&&(a.datatype=this.datatype.toString()),a},toString:function(){var a='"'+this.value+'"';return void 0!==this.lang?a+="@"+this.lang:void 0!==this.datatype&&(a+="^^<"+this.datatype+">"),a}},a.rdf.literal.fn.init.prototype=a.rdf.literal.fn,a.rdf.literal.defaults={base:a.uri.base(),namespaces:{},datatype:void 0,lang:void 0}}(jQuery),function(a){var b={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",xsd:"http://www.w3.org/2001/XMLSchema#"},c=b.rdf+"XMLLiteral",d=a.fn.curie.defaults,e=/\s([^ =]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|([^ >]+))/g,f=a.rdf.resource("<>"),g=function(a){var b,c,d="";if(!/&/.test(a))return a;for(;a.length>0;){if(b=/([^&]*)(&([^;]+);)(.*)/g.exec(a),null===b){d+=a;break}if(d+=b[1],c=b[3],a=b[4],"#"===c.charAt(0))d+=String.fromCharCode("x"===c.charAt(1)?parseInt(c.substring(2),16):parseInt(c.substring(1),10));else switch(c){case"amp":d+="&";break;case"nbsp":d+=String.fromCharCode(160);break;case"quot":d+='"';break;case"apos":d+="'";break;default:d+="&"+c+";"}}return d},h=function(b){var c,d,f,h,i,j,k,l,m={},n={};if(d=b[0],m[":length"]=0,d.attributes&&d.attributes.getNamedItemNS)for(k=d.attributes,c=0;c<k.length;c+=1)f=k[c],/^xmlns(:(.+))?$/.test(f.nodeName)&&""!==f.nodeValue?(l=/^xmlns(:(.+))?$/.exec(f.nodeName)[2]||"",m[l]=a.uri(f.nodeValue),m[":length"]+=1):/rel|rev|lang|xml:lang/.test(f.nodeName)?n[f.nodeName]=""===f.nodeValue?void 0:f.nodeValue:/about|href|src|resource|property|typeof|content|datatype/.test(f.nodeName)&&(n[f.nodeName]=null===f.nodeValue?void 0:f.nodeValue);else{for(h=/<[^>]+>/.exec(d.outerHTML),f=e.exec(h);null!==f;)i=f[1],j=f[2]||f[3]||f[4],/^xmlns/.test(i)&&"xmlns:"!==i&&""!==j?(l=/^xmlns(:(.+))?$/.exec(i)[2]||"",m[l]=a.uri(j),m[":length"]+=1):/about|href|src|resource|property|typeof|content|datatype|rel|rev|lang|xml:lang/.test(i)&&(n[i]=g(j)),f=e.exec(h);e.lastIndex=0}return{atts:n,namespaces:m}},j=function(a,b){var c=a[0].getAttribute(b);return("rev"===b||"rel"===b||"lang"===b||"xml:lang"===b)&&(c=""===c?void 0:c),null===c?void 0:c},k=function(b){return a.rdf.resource(b)},l=function(b,c,d){if("_:"===b.substring(0,2))return a.rdf.blank(b);try{return k(a.curie(b,d))}catch(e){return void 0}},m=function(b,c,d){var e=/^\[([^\]]+)\]$/.exec(b),f=d.base||c.base();return e?l(e[1],c,d):k(a.uri(b,f))},n=function(a,b,c){var d,e,f=[];for(a=a&&a.split?a.split(/[ \t\n\r\x0C]+/g):[],d=0;d<a.length;d+=1)""!==a[d]&&(e=l(a[d],b,c),void 0!==e&&f.push(e));return f},o=function(b,c,d){var e,f,g=[];for(c="uri"===c.type?c:a.rdf.resource(c,d),b=b&&b.split?b.split(/\s+/):[],e=0;e<b.length;e+=1)""!==b[e]&&(f=l(b[e],null,d),f!==c&&g.push(b[e]));return g.reverse().join(" ")},p=function(b,c,e){var f,g,i,j;return c=c||{},i=c.atts||h(b).atts,f=void 0===e?void 0!==i.rel||void 0!==i.rev:e,g=i.resource,g=void 0===g?i.href:g,void 0===g?g=f?a.rdf.blank("[]"):g:(j=c.curieOptions||a.extend({},d,{namespaces:b.xmlns()}),g=m(g,b,j)),g},q=function(b,c,e){var g,i,j,k,l=!1;return c=c||{},i=c.atts||h(b).atts,j=c.curieOptions||a.extend({},d,{namespaces:b.xmlns(),base:b.base()}),g=void 0===e?void 0!==i.rel||void 0!==i.rev:e,void 0!==i.about&&(k=m(i.about,b,j)),void 0===k&&void 0!==i.src&&(k=m(i.src,b,j)),g||void 0!==k||void 0===i.resource||(k=m(i.resource,b,j)),g||void 0!==k||void 0===i.href||(k=m(i.href,b,j)),void 0===k&&(/head|body/i.test(b[0].nodeName)?k=f:void 0!==i["typeof"]?k=a.rdf.blank("[]"):1===b[0].parentNode.nodeType?(k=c.object||p(b.parent())||q(b.parent()).subject,l=!g&&void 0===i.property):k=f),{subject:k,skip:l}},r=function(a,b){var c;return b=b||{},b.atts?(c=b.atts.lang,c=c||b.atts["xml:lang"]):(c=a[0].getAttribute("lang"),c=null===c||""===c?a[0].getAttribute("xml:lang"):c,c=null===c||""===c?void 0:c),void 0===c&&(b.lang?c=b.lang:1===a[0].parentNode.nodeType&&(c=r(a.parent()))),c},s=function(a){switch(a){case"<":return"&lt;";case'"':return"&quot;";case"&":return"&amp;"}},t=function(b,c){var d,f,g,h,i,j,k="";return b.contents().each(function(){var b=a(this),l=b[0];if(1===l.nodeType){if(h=l.nodeName.toLowerCase(),k+="<"+h,l.outerHTML){for(j=/<[^>]+>/.exec(l.outerHTML),g=e.exec(j);null!==g;)/^jQuery/.test(g[1])||(k+=" "+g[1]+"=",k+=g[2]?g[3]:'"'+g[1]+'"'),g=e.exec(j);e.lastIndex=0}else for(f=l.attributes,d=0;d<f.length;d+=1)g=f.item(d),k+=" "+g.nodeName+'="',k+=g.nodeValue.replace(/[<"&]/g,s),k+='"';c||(i=b.xmlns(""),void 0!==i&&void 0===b.attr("xmlns")&&(k+=' xmlns="'+i+'"')),k+=">",k+=t(b,!0),k+="</"+h+">"}else 8===l.nodeType?(k+="<!--",k+=l.nodeValue,k+="-->"):k+=l.nodeValue}),k},u=function(b){var e,f,g,i,j,k,l,m,o,s,v,w,x,y,z,A,B,C,D,E=[],F=this.children();if(b=b||{},y=b.forward||[],z=b.backward||[],A=h(this),B=A.atts,b.atts=B,C=b.namespaces||this.xmlns(),A.namespaces[":length"]>0){C=a.extend({},C);for(D in A.namespaces)":length"!==D&&(C[D]=A.namespaces[D])}if(b.curieOptions=a.extend({},d,{namespaces:C,base:this.base()}),f=q(this,b),i=r(this,b),f.skip)w=b.forward,x=b.backward,f=b.subject,g=b.object;else{if(f=f.subject,y.length>0||z.length>0){for(s=b.subject||q(this.parent()).subject,e=0;e<y.length;e+=1)o=a.rdf.triple(s,y[e],f,{source:this[0]}),E.push(o);for(e=0;e<z.length;e+=1)o=a.rdf.triple(f,z[e],s,{source:this[0]}),E.push(o)}for(g=p(this,b),l=n(B["typeof"],this,b.curieOptions),e=0;e<l.length;e+=1)o=a.rdf.triple(f,a.rdf.type,l[e],{source:this[0]}),E.push(o);if(v=n(B.property,this,b.curieOptions),v.length>0)for(j=B.datatype,k=B.content,void 0!==j&&""!==j?(j=a.curie(j,b.curieOptions),m=j===c?a.rdf.literal(t(this),{datatype:c}):void 0!==k?a.rdf.literal(k,{datatype:j}):a.rdf.literal(this.text(),{datatype:j})):void 0!==k?m=void 0===i?a.rdf.literal('"'+k+'"'):a.rdf.literal(k,{lang:i}):0===F.length||""===j?(i=r(this,b),m=void 0===i?a.rdf.literal('"'+this.text()+'"'):a.rdf.literal(this.text(),{lang:i})):m=a.rdf.literal(t(this),{datatype:c}),e=0;e<v.length;e+=1)o=a.rdf.triple(f,v[e],m,{source:this[0]}),E.push(o);if(w=n(B.rel,this,b.curieOptions),x=n(B.rev,this,b.curieOptions),void 0!==B.resource||void 0!==B.href){if(void 0!==w)for(e=0;e<w.length;e+=1)o=a.rdf.triple(f,w[e],g,{source:this[0]}),E.push(o);if(w=[],void 0!==x)for(e=0;e<x.length;e+=1)o=a.rdf.triple(g,x[e],f,{source:this[0]}),E.push(o);x=[]}}return F.each(function(){E=E.concat(u.call(a(this),{forward:w,backward:x,subject:f,object:g||f,lang:i,namespaces:C}))}),E},v=function(a){var b,c;return a&&void 0!==a.about?(c=h(this).atts,null===a.about?void 0!==c.property||void 0!==c.rel||void 0!==c.rev||void 0!==c["typeof"]:q(this,{atts:c}).subject.value===a.about):a&&void 0!==a.type?(b=j(this,"typeof"),void 0!==b?null===a.type?!0:this.curie(b)===a.type:!1):u.call(this)},w=1,x=function(d,e,f){var g,h,i;try{h=d.createCurie(f)}catch(k){f.toString()===c?(d.attr("xmlns:rdf",b.rdf),h="rdf:XMLLiteral"):(g=/^(.+[\/#])([^#]+)$/.exec(f),d.attr("xmlns:ns"+w,g[1]),h="ns"+w+":"+g[2],w+=1)}i=j(d,e),void 0!==i?-1===a.inArray(h,i.split(/\s+/))&&d.attr(e,i+" "+h):d.attr(e,h)},y=function(b,c,d){var e;e="bnode"===d.type?"[_:"+d.id+"]":a(b).base().relative(d.value),b.attr(c,e)},z=function(a,b){var c=q(a).subject;b!==c&&y(a,"about",b),a.removeData("rdfa.subject")},A=function(a,b){var c=p(a);b!==c&&y(a,"resource",b),a.removeData("rdfa.objectResource")},B=function(a,b){return a.wrapInner("<span></span>").children("span").attr("lang",b),a},C=function(b){var d,e,f,g,i,j,k,l,m,n,o,s,t,u=this.xmlns();if(i=this,t=h(this).atts,"string"==typeof b)b=a.rdf.triple(b,{namespaces:u,base:this.base()});else{if(b.rdfquery)return C.call(this,b.sources().get(0)),this;if(b.length){for(s=0;s<b.length;s+=1)C.call(this,b[s]);return this}}if(e=void 0!==t.rel||void 0!==t.rev,f=e||void 0!==t.property||void 0!==t["typeof"],"literal"!==b.object.type)j=q(this,{atts:t},!0).subject,l=p(this,{atts:t},!0),g=!f&&void 0===t.resource,k=j===b.subject,m=l===b.object,b.property===a.rdf.type?k?x(this,"typeof",b.object.value):f?(i=this.wrapInner("<span />").children("span"),x(i,"typeof",b.object.value),l!==b.subject&&z(i,b.subject)):(x(this,"typeof",b.object.value),z(this,b.subject)):k?m?x(this,"rel",b.property.value):g||!f?(x(this,"rel",b.property.value),A(this,b.object)):(i=this.wrap("<span />").parent(),x(i,"rev",b.property.value),z(i,b.object)):j===b.object?l===b.subject?x(this,"rev",b.property.value):g||!f?(x(this,"rev",b.property.value),A(this,b.subject)):(i=this.wrap("<span />").parent(),x(i,"rel",b.property.value),z(i,b.subject)):m?f?(i=this.wrapInner("<span />").children("span"),x(i,"rev",b.property.value),A(i,b.subject),i=i.wrapInner("<span />").children("span"),z(i,b.object),i=this):(z(this,b.subject),x(this,"rel",b.property.value)):l===b.subject?f?(i=this.wrapInner("<span />").children("span"),x(i,"rel",this.property.value),A(i,b.object),i=i.wrapInner("<span />").children("span"),z(i,l),i=this):(z(this,b.object),x(this,"rev",b.property.value)):f?(i=this.wrapInner("<span />").children("span"),x(i,"rel",b.property.value),z(i,b.subject),A(i,b.object),i.children("*").length>0&&(i=this.wrapInner("<span />").children("span"),z(i,j)),i=this):(x(i,"rel",b.property.value),z(this,b.subject),A(this,b.object),this.children("*").length>0&&(i=this.wrapInner("<span />").children("span"),z(i,j),i=this));else if(j=q(this,{atts:t}).subject,l=p(this,{atts:t}),k=j===b.subject,d=this.text()!==b.object.value,void 0!==t.property){if(o=t.content,m=void 0!==o?o===b.object.value:!d,!k||!m)return i=this.wrapInner("<span />").children("span"),C.call(i,b);x(this,"property",b.property.value)}else{if(l===b.subject)return i=this.wrapInner("<span />").children("span"),C.call(i,b);x(this,"property",b.property.value),z(this,b.subject),d&&(b.object.datatype&&b.object.datatype.toString()===c?this.html(b.object.value):this.attr("content",b.object.value)),n=r(this),b.object.lang?n!==b.object.lang&&(this.attr("lang",b.object.lang),d&&B(this,n)):b.object.datatype?x(this,"datatype",b.object.datatype):(d||this.attr("datatype",""),void 0!==n&&(this.attr("lang",""),d&&B(this,n)))}return this.parents().andSelf().trigger("rdfChange"),i},D=function(a){var b,c,d,e,f,g=this.xmlns();if(b=h(this).atts,a.length){for(i=0;i<a.length;i+=1)D.call(this,a[i]);return this}return hasRelation=void 0!==b.rel||void 0!==b.rev,hasRDFa=hasRelation||void 0!==b.property||void 0!==b["typeof"],hasRDFa&&(void 0!==a.property&&(void 0!==b.property&&(c=o(b.property,a.property,{namespaces:g}),""===c?this.removeAttr("property"):this.attr("property",c)),void 0!==b.rel&&(d=o(b.rel,a.property,{namespaces:g}),""===d?this.removeAttr("rel"):this.attr("rel",d)),void 0!==b.rev&&(e=o(b.rev,a.property,{namespaces:g}),""===e?this.removeAttr("rev"):this.attr("rev",e))),void 0!==a.type&&void 0!==b["typeof"]&&(f=o(b["typeof"],a.type,{namespaces:g}),""===f?this.removeAttr("typeof"):this.attr("typeof",f)),b.property===this.attr("property")&&b.rel===this.attr("rel")&&b.rev===this.attr("rev")&&b["typeof"]===this.attr("typeof"))?D.call(this.parent(),a):(this.parents().andSelf().trigger("rdfChange"),this)};a.fn.rdfa=function(b){if(void 0===b){var c=a.map(a(this),function(b){return u.call(a(b))});return a.rdf({triples:c})}return a(this).each(function(){C.call(a(this),b)}),this},a.fn.removeRdfa=function(b){return a(this).each(function(){D.call(a(this),b)}),this},a.rdf.gleaners.push(v)}(jQuery),function(a){var b=1;a.rdf.ruleset=function(b,c){return new a.rdf.ruleset.fn.init(b,c)},a.rdf.ruleset.fn=a.rdf.ruleset.prototype={init:function(b,c){var d,e=a.extend({},a.rdf.ruleset.defaults,c);for(b=b||[],this.baseURI=e.base,this.namespaces=a.extend({},e.namespaces),this.rules=[],d=0;d<b.length;d+=1)this.add.apply(this,b[d]);return this},base:function(a){return void 0===a?this.baseURI:(this.baseURI=a,this)},prefix:function(a,b){return void 0===a?this.namespaces:void 0===b?this.namespaces[a]:(this.namespaces[a]=b,this)},size:function(){return this.rules.length},add:function(b,c){var d;return void 0===c&&b.rules?this.rules=this.rules.concat(b.rules):(d=void 0===c&&b.lhs?b:a.rdf.rule(b,c,{namespaces:this.prefix(),base:this.base()}),-1===a.inArray(d,this.rules)&&this.rules.push(d)),this},run:function(b,c){var d,e,f,g=a.extend({limit:50},c),h=g.limit;do{for(f=b.size(),d=0;d<this.rules.length;d+=1)e=this.rules[d],e.run(b);h-=1}while(b.size()>f&&h>0);return this}},a.rdf.ruleset.fn.init.prototype=a.rdf.ruleset.fn,a.rdf.ruleset.defaults={base:a.uri.base(),namespaces:{}},a.rdf.rule=function(b,c,d){return new a.rdf.rule.fn.init(b,c,d)},a.rdf.rule.fn=a.rdf.rule.prototype={init:function(b,c,d){var e=a.extend({},a.rdf.rule.defaults,d),f=[],g=!1;return"string"==typeof b&&(b=[b]),"string"==typeof c&&(c=[c]),this.lhs=a.map(b,function(b){return a.isArray(b)?[b]:a.isFunction(b)?b:(b=a.rdf.pattern(b,e),"string"==typeof b.subject&&f.push(b.subject),"string"==typeof b.property&&f.push(b.property),"string"==typeof b.object&&f.push(b.object),b)}),f=a.unique(f),this.rhs=a.isFunction(c)?c:a.map(c,function(b){if(b=a.rdf.pattern(b,e),"string"==typeof b.subject&&-1===a.inArray(b.subject,f)||"string"==typeof b.property&&-1===a.inArray(b.property,f)||"string"==typeof b.object&&-1===a.inArray(b.object,f))throw"Bad Rule: Right-hand side of the rule contains a reference to an unbound wildcard";return("bnode"===b.subject.type||"bnode"===b.property.type||"bnode"===b.object.type)&&(g=!0),b}),this.rhsBlanks=g,this.cache={},this},run:function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=a.rdf({databank:c}),s=a.extend({limit:50},d),t=s.limit,u=this.rhsBlanks;for(void 0===this.cache[c.id]&&(this.cache[c.id]={}),g=0;g<this.lhs.length;g+=1)e=this.lhs[g],r=a.isArray(e)?r.filter.apply(r,e):a.isFunction(e)?r.filter.call(r,e):r.where(this.lhs[g]);do{for(f=r.length,o=r.sources(),g=0;f>g;g+=1){for(p=o[g],q=!0,n=this.cache[c.id],h=0;h<p.length;h+=1)void 0===n[p[h]]?n[p[h]]={}:h===p.length-1&&(q=!1),n=n[p[h]];if(q)if(m=r.eq(g),u){for(h=0;h<this.rhs.length;h+=1)i=this.rhs[h],j=i.subject,k=i.property,l=i.object,"bnode"===j.type&&(j=a.rdf.blank(""+j+b)),"bnode"===k.type&&(k=a.rdf.blank(""+k+b)),"bnode"===l.type&&(l=a.rdf.blank(""+l+b)),i=a.rdf.pattern(j,k,l),m.add(i);b+=1}else if(a.isFunction(this.rhs))m.map(this.rhs);else for(h=0;h<this.rhs.length;h+=1)m.add(this.rhs[h])}t-=1}while(r.length>f&&t>0);return this}},a.rdf.rule.fn.init.prototype=a.rdf.rule.fn,a.rdf.rule.defaults={base:a.uri.base(),namespaces:{}},a.extend(a.rdf.databank.fn,{reason:function(a,b){return a.run(this,b),this}}),a.extend(a.rdf.fn,{reason:function(a,b){return a.run(this.databank,b),this}})}(jQuery),function(){var a=this,b=a.jQuery,c=a.Backbone,d=a._,e=a.VIE=function(a){this.config=a?a:{},this.services={},this.jQuery=b,this.entities=new this.Collection([],{vie:this}),this.Entity.prototype.entities=this.entities,this.Entity.prototype.entityCollection=this.Collection,this.Entity.prototype.vie=this,this.Namespaces.prototype.vie=this,this.namespaces=new this.Namespaces(this.config.baseNamespace?this.config.baseNamespace:"http://viejs.org/ns/",{owl:"http://www.w3.org/2002/07/owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",schema:"http://schema.org/",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",dbpedia:"http://dbpedia.org/ontology/",dbprop:"http://dbpedia.org/property/",skos:"http://www.w3.org/2004/02/skos/core#",xsd:"http://www.w3.org/2001/XMLSchema#",sioc:"http://rdfs.org/sioc/ns#",dcterms:"http://purl.org/dc/terms/"}),this.Type.prototype.vie=this,this.Types.prototype.vie=this,this.Attribute.prototype.vie=this,this.Attributes.prototype.vie=this,this.types=new this.Types,this.types.add("owl:Thing"),this.config.classic===!0&&(this.RDFa=new this.ClassicRDFa(this),this.RDFaEntities=new this.ClassicRDFaEntities(this),this.EntityManager=new this.ClassicEntityManager(this),this.cleanup=function(){this.entities.reset()})};if(e.prototype.use=function(a,b){if(!b&&!a.name)throw new Error("Please provide a name for the service!");return a.vie=this,a.name=b?b:a.name,a.init&&a.init(),this.services[a.name]=a,this},e.prototype.service=function(a){if(!this.hasService(a))throw"Undefined service "+a;return this.services[a]},e.prototype.hasService=function(a){return this.services[a]?!0:!1},e.prototype.getServicesArray=function(){return d.map(this.services,function(a){return a})},e.prototype.load=function(a){return a||(a={}),a.vie=this,new this.Loadable(a)},e.prototype.save=function(a){return a||(a={}),a.vie=this,new this.Savable(a)},e.prototype.remove=function(a){return a||(a={}),a.vie=this,new this.Removable(a)},e.prototype.analyze=function(a){return a||(a={}),a.vie=this,new this.Analyzable(a)},e.prototype.find=function(a){return a||(a={}),a.vie=this,new this.Findable(a)},e.prototype.loadSchema=function(a,c){if(c=c?c:{},!a)throw new Error("Please provide a proper URL");var d=this;return b.getJSON(a).success(function(a){try{e.Util.loadSchemaOrg(d,a,c.baseNS),c.success&&c.success.call(d)}catch(b){return void c.error.call(d,b)}}).error(function(b,e){c.error&&c.error.call(d,"Could not load schema from URL ("+a+"): "+e)}),this},e.prototype.getTypedEntityClass=function(a){var b=this.types.get(a);if(!b)throw new Error("Unknown type "+a);return this.typeEntityClasses[a.id]||(this.typeEntityClasses[a.id]=this.Entity.extend({defaults:{"@type":a}})),this.typeEntityClasses[a.id]},e.prototype.typeEntityClasses={},"object"==typeof exports&&(exports.VIE=e,b||(b=require("jquery")),c||(c=require("backbone"),c.$=b),d||(d=require("underscore")._)),e.prototype.Able=function(){this.init=function(a,c){return this.options=a,this.services=a.from||a.using||a.to||[],this.vie=a.vie,this.methodName=c,this.deferred=b.Deferred(),this.resolve=this.deferred.resolve,this.resolveWith=this.deferred.resolveWith,this.reject=this.deferred.reject,this.rejectWith=this.deferred.rejectWith,this.success=this.done=this.deferred.done,this.fail=this.deferred.fail,this.then=this.deferred.then,this.always=this.deferred.always,this.from=this.using,this.to=this.using,this},this.using=function(a){var b=this;return a=d.isArray(a)?a:[a],d.each(a,function(a){var c="string"==typeof a?b.vie.service(a):a;b.services.push(c)}),this},this.execute=function(){var a=this;return d(this.services).each(function(b){b[a.methodName](a)}),this}},e.prototype.Loadable=function(a){this.init(a,"load")},e.prototype.Loadable.prototype=new e.prototype.Able,e.prototype.Savable=function(a){this.init(a,"save")},e.prototype.Savable.prototype=new e.prototype.Able,e.prototype.Removable=function(a){this.init(a,"remove")},e.prototype.Removable.prototype=new e.prototype.Able,e.prototype.Analyzable=function(a){this.init(a,"analyze")},e.prototype.Analyzable.prototype=new e.prototype.Able,e.prototype.Findable=function(a){this.init(a,"find")},e.prototype.Findable.prototype=new e.prototype.Able,e.Util={isReference:function(a){var b=new RegExp("^\\<([^\\>]*)\\>$");return b.exec(a)?!0:!1},toReference:function(a,b){if(d.isArray(a))return d.map(a,function(a){return this.toReference(a)},this);if(!d.isString(a))return a;var c=a;return"_:"===a.substring(0,2)?c=a:b&&b.isCurie(a)?(c=b.uri(a),c==="<"+b.base()+a+">"&&(c="<"+a+">")):b&&!b.isUri(a)&&(c="<"+a+">"),c},fromReference:function(a,b){return b&&!b.isUri(a)?a:a.substring(1,a.length-1)},toCurie:function(a,b,c){if(e.Util.isCurie(a,c))return a;var d=":";for(var f in c.toObj())if(1===a.indexOf(c.get(f))){var g=new RegExp("^<?"+c.get(f));return""===f&&(d=""),(b?"[":"")+a.replace(g,f+d).replace(/>$/,"")+(b?"]":"")}throw new Error("No prefix found for URI '"+a+"'!")},isCurie:function(a,b){if(e.Util.isUri(a))return!1;try{return e.Util.toUri(a,b),!0}catch(c){return!1}},toUri:function(a,b){if(e.Util.isUri(a))return a;var c=":";for(var d in b.toObj())if(""!==d&&(0===a.indexOf(d+":")||0===a.indexOf("["+d+":"))){var f=new RegExp("^\\[{0,1}"+d+c);return"<"+a.replace(f,b.get(d)).replace(/\]{0,1}$/,"")+">"}if(-1===a.indexOf(c))return"<"+b.base()+a+">";throw new Error("No prefix found for CURIE '"+a+"'!")},isUri:function(a){return"string"==typeof a&&0===a.search(/^<.+>$/)},mapAttributeNS:function(a,b){var c=a;return b.isUri(a)||0===a.indexOf("@")||(b.isCurie(a)?c=b.uri(a):b.isUri(a)||(c=-1===a.indexOf(":")?"<"+b.base()+a+">":"<"+a+">")),c},rdf2Entities:function(a,c){if("function"!=typeof b.rdf)return e.Util._rdf2EntitiesNoRdfQuery(a,c);var f={};try{var g=c instanceof b.rdf?c.base(a.vie.namespaces.base()):b.rdf().base(a.vie.namespaces.base()).load(c,{});if(a.rules){var h=b.rdf.ruleset();for(var i in a.vie.namespaces.toObj())""!==i&&h.prefix(i,a.vie.namespaces.get(i));for(var j=0;j<a.rules.length;j++)if(a.rules.hasOwnProperty(j)){var k=a.rules[j];h.add(k.left,k.right)}g=g.reason(h,10)}g.where("?subject ?property ?object").each(function(){function b(a){if("string"==typeof a.value){if(a.lang){var b={toString:function(){return this["@value"]},"@value":a.value.replace(/^"|"$/g,""),"@language":a.lang};return b}return a.value}return"uri"===a.type?a.toString():a.value}var c=this.subject.toString();f[c]||(f[c]={"@subject":c,"@context":a.vie.namespaces.toObj(!0),"@type":[]});var d,e=this.property.toString();try{d=a.vie.namespaces.curie(e)}catch(g){d=e}f[c][d]=f[c][d]||[],f[c][d].push(b(this.object))}),d(f).each(function(a){a["@type"]=a["@type"].concat(a["rdf:type"]),delete a["rdf:type"],d(a).each(function(b,c){1===b.length&&(a[c]=b[0])})})}catch(l){return[]}var m=[];return b.each(f,function(){try{var b=new a.vie.Entity(this);m.push(b)}catch(c){}}),m},getPreferredLangForPreferredProperty:function(a,b,c){var e,f,g;return f=[],d.each(c,function(c){d.each(b,function(b,h){e=null,"string"==typeof b&&a.get(b)?(e=d.flatten([a.get(b)]),d(e).each(function(a){var b,d,e,g,h;return g=e=h=0,b=a["@language"],"string"!=typeof a||a.indexOf("@")!==a.length-3&&a.indexOf("@")!==a.length-5||(b=a.replace(/(^\"*|\"*@)..(..)?$/g,"")),g+=b?b===c?h:20:10,d=a.toString(),d=d.replace(/(^\"*|\"*@..$)/g,""),f.push({score:g,value:d})})):"object"==typeof b&&a.get(b.property)&&(g=d.flatten([a.get(b.property)]),g=d(g).map(function(a){return a.isEntity?a.getSubject():a}),f.push({score:h,value:b.makeLabel(g)}))})}),f=d(f).sortBy(function(a){return a.score}),f.length?f[0].value:"n/a"},_rdf2EntitiesNoRdfQuery:function(a,b){var c=[];return d.forEach(b,function(a,b){var e={};e["@subject"]="<"+b+">",d.forEach(a,function(a,b){b="<"+b+">",d.forEach(a,function(a){return"uri"===a.type&&(a.value="<"+a.value+">"),e[b]&&!d.isArray(e[b])&&(e[b]=[e[b]]),d.isArray(e[b])?void e[b].push(a.value):void(e[b]=a.value)})}),c.push(e)}),c},loadSchemaOrg:function(a,b,c){if(!b)throw new Error("Please load the schema.json file.");a.types.remove("<http://schema.org/Thing>");var e=c?c:a.namespaces.base();a.namespaces.base(c);var f={DataType:"xsd:anyType",Boolean:"xsd:boolean",Date:"xsd:date",DateTime:"xsd:dateTime",Time:"xsd:time",Float:"xsd:float",Integer:"xsd:integer",Number:"xsd:anySimpleType",Text:"xsd:string",URL:"xsd:anyURI"},g=function(c,d){for(var e=a.types.add(d,[{id:"value",range:f[d]}]),h=0;h<c.length;h++){var i=a.types.get(c[h])?a.types.get(c[h]):g.call(a,b.datatypes[c[h]].supertypes,c[h]);e.inherit(i)}return e};for(var h in b.datatypes)if(!a.types.get(h)){var i=b.datatypes[h].supertypes;g.call(a,i,h)}var j=function(a){var b={};return a.label&&(b.label=a.label),a.url&&(b.url=a.url),a.comment&&(b.comment=a.comment),a.metadata&&(b=d.extend(b,a.metadata)),b},k=function(a){var c=[];return d.each(b.types[a].specific_properties,function(a){var d=b.properties[a];c.push({id:d.id,range:d.ranges,min:d.min,max:d.max,metadata:j(d)})}),c},l=function(c,d,e,f){for(var g=a.types.add(d,e,f),h=0;h<c.length;h++){var i=a.types.get(c[h])?a.types.get(c[h]):l.call(a,b.types[c[h]].supertypes,c[h],k.call(a,c[h]),j(b.types[c[h]]));g.inherit(i)}return"Thing"!==d||g.isof("owl:Thing")||g.inherit("owl:Thing"),g};d.each(b.types,function(b){if(!a.types.get(b.id)){var c=b.supertypes,d=j(b);l.call(a,c,b.id,k.call(a,b.id),d)}}),a.namespaces.base(e)},getEntityTypeUnion:function(a){var b=a.vie;return new b.Type("Union").inherit(a.get("@type"))},getFormSchemaForType:function(a,b){var c={};return d.each(a.attributes.toArray(),function(a){var b=e.Util.toCurie(a.id,!1,a.vie.namespaces);c[b]=e.Util.getFormSchemaForAttribute(a)}),d.each(c,function(a,d){a.type||delete c[d],"URL"===a.type&&(a.type="Text",a.dataType="url"),"List"!==a.type||a.listType||delete c[d],b||("NestedModel"===a.type||"NestedModel"===a.listType)&&delete c[d]}),c},getFormSchemaForAttribute:function(a){var b=a.range[0],c={},d=function(b){switch(b){case"xsd:anySimpleType":case"xsd:float":case"xsd:integer":return"Number";case"xsd:string":return"Text";case"xsd:date":return"Date";case"xsd:dateTime":return"DateTime";case"xsd:boolean":return"Checkbox";case"xsd:anyURI":return"URL";default:var c=a.vie.types.get(b);return c?c.attributes.get("value")?d(c.attributes.get("value").range[0]):"NestedModel":null}};return c.title=e.Util.toCurie(a.id,!1,a.vie.namespaces),a.min>0&&(c.validators=["required"]),a.max>1?(c.type="List",c.listType=d(b),"NestedModel"===c.listType&&(c.nestedModelType=b),c):(c.type=d(b),"NestedModel"===c.type&&(c.nestedModelType=b),c)},getFormSchema:function(a){if(!a||!a.isEntity)return{};var b=e.Util.getEntityTypeUnion(a),c=e.Util.getFormSchemaForType(b,!0);return d.each(c,function(b,d){("NestedModel"===b.type||"NestedModel"===b.listType)&&(c[d].model=a.vie.getTypedEntityClass(b.nestedModelType))}),c},xsdDateTime:function(a){function b(a){var b=a.toString();return b.length<2?"0"+b:b}var c=a.getFullYear(),d=b(a.getMonth()+1),e=b(a.getDate()),f=b(a.getHours()),g=b(a.getMinutes()),h=b(a.getSeconds());return c+"-"+d+"-"+e+"T"+f+":"+g+":"+h},extractLanguageString:function(a,b,c){var f,g,h,i,j;if(a&&"string"!=typeof a){for(b=d.isArray(b)?b:[b],c=d.isArray(c)?c:[c],f=0;f<b.length;f++)for(var k=0;k<c.length;k++){var l=c[k];if(g=b[f],a.has(g))for(h=a.get(g),h=d.isArray(h)?h:[h],i=0;i<h.length;i++)if(j=h[i],j=j.isEntity?e.Util.extractLanguageString(j,b,l):"string"==typeof j?j:"",j&&j.indexOf("@"+l)>-1)return j.replace(/"/g,"").replace(/@[a-z]+/,"").trim()}for(f=0;f<b.length;f++)if(g=b[f],a.has(g))for(h=a.get(g),h=d.isArray(h)?h:[h],i=0;i<h.length;i++)if(j=h[i],j.isEntity&&(j=e.Util.extractLanguageString(j,b,[])),j&&"string"==typeof j&&-1===j.indexOf("@"))return j.replace(/"/g,"").replace(/@[a-z]+/,"").trim()}return void 0},transformationRules:function(a){var c=[{left:["?subject a dbpedia:Person","?subject rdfs:label ?label"],right:function(a){return function(){return[b.rdf.triple(this.subject.toString(),"a","<"+a.base()+"Person>",{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"name>",this.label,{namespaces:a.toObj()})]}}(a.vie.namespaces)},{left:["?subject a foaf:Person","?subject rdfs:label ?label"],right:function(a){return function(){return[b.rdf.triple(this.subject.toString(),"a","<"+a.base()+"Person>",{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"name>",this.label,{namespaces:a.toObj()})]}}(a.vie.namespaces)},{left:["?subject a dbpedia:Place","?subject rdfs:label ?label"],right:function(a){return function(){return[b.rdf.triple(this.subject.toString(),"a","<"+a.base()+"Place>",{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"name>",this.label.toString(),{namespaces:a.toObj()})]}}(a.vie.namespaces)},{left:["?subject a dbpedia:City","?subject rdfs:label ?label","?subject dbpedia:abstract ?abs","?subject dbpedia:country ?country"],right:function(a){return function(){return[b.rdf.triple(this.subject.toString(),"a","<"+a.base()+"City>",{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"name>",this.label.toString(),{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"description>",this.abs.toString(),{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"containedIn>",this.country.toString(),{namespaces:a.toObj()})]}}(a.vie.namespaces)}];return c},getAdditionalRules:function(a){var c={Work:"CreativeWork",Film:"Movie",TelevisionEpisode:"TVEpisode",TelevisionShow:"TVSeries",Website:"WebPage",Painting:"Painting",Sculpture:"Sculpture",Event:"Event",SportsEvent:"SportsEvent",MusicFestival:"Festival",FilmFestival:"Festival",Place:"Place",Continent:"Continent",Country:"Country",City:"City",Airport:"Airport",Station:"TrainStation",Hospital:"GovernmentBuilding",Mountain:"Mountain",BodyOfWater:"BodyOfWater",Company:"Organization",Person:"Person"},e=[];return d.each(c,function(c,d){var f={left:["?subject a dbpedia:"+d,"?subject rdfs:label ?label"],right:function(a){return function(){return[b.rdf.triple(this.subject.toString(),"a","<"+a.base()+c+">",{namespaces:a.toObj()}),b.rdf.triple(this.subject.toString(),"<"+a.base()+"name>",this.label.toString(),{namespaces:a.toObj()})]}}(a.vie.namespaces)};e.push(f)}),e}},e.prototype.Entity=c.Model.extend({idAttribute:"@subject",isEntity:!0,defaults:{"@type":"owl:Thing"},initialize:function(a,b){return a||(a={}),b||(b={}),this.id=this["@subject"]=a["@subject"]?this.toReference(a["@subject"]):a["@subject"]=this.cid.replace("c","_:bnode"),this},schema:function(){return e.Util.getFormSchema(this)},get:function(a){a=e.Util.mapAttributeNS(a,this.vie.namespaces);var b=c.Model.prototype.get.call(this,a);return b=d.isArray(b)?b:[b],0===b.length?void 0:(b=d.map(b,function(b){return void 0!==b&&"@type"===a?(this.vie.types.get(b)||this.vie.types.add(b).inherit("owl:Thing"),this.vie.types.get(b)):void 0!==b&&this.vie.entities.get(b)?this.vie.entities.get(b):b},this),b=1===b.length?b[0]:b)},has:function(a){return a=e.Util.mapAttributeNS(a,this.vie.namespaces),c.Model.prototype.has.call(this,a)},hasRelations:function(){var a=!1;return d.each(this.attributes,function(b){b&&b.isCollection&&(a=!0)}),a},set:function(a,b,f){if(!a)return this;if(a["@subject"]&&(a["@subject"]=this.toReference(a["@subject"])),d.isString(a)){var g={};return g[a]=b,this.set(g,f)}b||(b={}),b.validate!==!1&&b.silent!==!0&&(b.validate=!0),a.attributes&&(a=a.attributes);var h;d.each(a,function(b,c){var d=e.Util.mapAttributeNS(c,this.vie.namespaces);c!==d&&(delete a[c],a[d]=b)},this),d.each(a,function(c,e){if(c&&-1===e.indexOf("@"))if(c.isCollection)c.each(function(a){this.vie.entities.addOrUpdate(a)},this);else if(c.isEntity)this.vie.entities.addOrUpdate(c),h=new this.vie.Collection(c,{vie:this.vie,predicate:e}),a[e]=h;else if(d.isArray(c)){if(this.attributes[e]&&this.attributes[e].isCollection){var f=this.attributes[e].addOrUpdate(c);a[e]=this.attributes[e],a[e].reset(f)}}else if(c["@value"]);else if(d.isObject(c)&&!d.isDate(c)){var g=new this.vie.Entity(c,b);this.vie.entities.addOrUpdate(g),h=new this.vie.Collection(c,{vie:this.vie,predicate:e}),a[e]=h}},this);var i=c.Model.prototype.set.call(this,a,b);return b&&b.ignoreChanges&&(this.changed={},this._previousAttributes=d.clone(this.attributes)),i},unset:function(a,b){return a=e.Util.mapAttributeNS(a,this.vie.namespaces),c.Model.prototype.unset.call(this,a,b)},validate:function(a,b){if(!b||b.validate!==!1){var c=this.get("@type");if(c){if(d.isArray(c)){var e=[];if(d.each(c,function(c){var d=this.validateByType(c,a,b);d&&e.push(d)},this),d.isEmpty(e))return;return d.flatten(e)}return this.validateByType(c,a,b)}}},validateByType:function(a,b){var c={max:"<%= property %> cannot contain more than <%= num %> items",min:"<%= property %> must contain at least <%= num %> items",required:"<%= property %> is required"};if(a.attributes){var e=function(a,b,e){return{property:a.id,constraint:b,message:d.template(c[b],d.extend({property:a.id},e))}},f=function(a,b){return!b[a.id]||d.isEmpty(b[a.id])?e(a,"required",{}):void 0},g=function(a,b){return b&&b[a.id]&&(b[a.id].isCollection||d.isArray(b[a.id]))&&b[a.id].length>a.max?e(a,"max",{num:a.max}):void 0},h=[];if(d.each(a.attributes.list(),function(a){var c;a.max&&-1!=a.max&&(c=g(a,b),c&&h.push(c)),a.min&&a.min>0&&(c=f(a,b),c&&h.push(c))}),!d.isEmpty(h))return h}},isNew:function(){return"_:bnode"===this.getSubjectUri().substr(0,7)?!0:!1
},hasChanged:function(a){return this.markedChanged?!0:c.Model.prototype.hasChanged.call(this,a)},forceChanged:function(a){this.markedChanged=a?!0:!1},getSubject:function(){return"undefined"==typeof this.id&&(this.id=this.attributes[this.idAttribute]),"string"==typeof this.id?"http://"===this.id.substr(0,7)||"urn:"===this.id.substr(0,4)?this.toReference(this.id):this.id:this.cid.replace("c","_:bnode")},getSubjectUri:function(){return this.fromReference(this.getSubject())},isReference:function(a){return e.Util.isReference(a)},toReference:function(a){return e.Util.toReference(a,this.vie.namespaces)},fromReference:function(a){return e.Util.fromReference(a,this.vie.namespaces)},as:function(a){if("JSON"===a)return this.toJSON();if("JSONLD"===a)return this.toJSONLD();throw new Error("Unknown encoding "+a)},toJSONLD:function(){var a={};return d.each(this.attributes,function(b,c){var e=this.get(c);b instanceof this.vie.Collection&&(e=b.map(function(a){return a.getSubject()})),"@type"===c&&(e=d.isArray(e)?d.map(e,function(a){return a.toString()}):e.toString()),a[c]=e},this),a["@subject"]=this.getSubject(),a},setOrAdd:function(a,b,c){return d.isString(a)&&b?this._setOrAddOne(a,b,c):d.isObject(a)&&d.each(a,function(a,c){this._setOrAddOne(c,a,b)},this),this},_setOrAddOne:function(a,b,f){if(a&&b){if(f=f?f:{},a=e.Util.mapAttributeNS(a,this.vie.namespaces),d.isArray(b))return void d.each(b,function(c){this._setOrAddOne(a,b[c],f)},this);"@type"===a&&b instanceof this.vie.Type&&(b=b.id);var g={},h=c.Model.prototype.get.call(this,a);if(h)if(h.isCollection){if(b.isCollection)b.each(function(a){h.add(a)});else if(b.isEntity)h.add(b);else{if(!d.isObject(b))throw new Error("you cannot add a literal to a collection of entities!");b=new this.vie.Entity(b),h.add(b)}this.trigger("change:"+a,this,b,{})}else{if(!d.isArray(h)){var i=[h];return i.push(b),g[a]=i,this.set(g,f)}if(b.isCollection)b.each(function(c){this._setOrAddOne(a,b.at(c).getSubject(),f)},this);else if(b.isEntity)this._setOrAddOne(a,b.getSubject(),f);else if(d.isObject(b))b=new this.vie.Entity(b),this._setOrAddOne(a,b,f);else{var j=h.slice(0);j.push(b),this.set(a,j)}}else g[a]=b,this.set(g,f)}},hasType:function(a){return a=this.vie.types.get(a),this.hasPropertyValue("@type",a)},hasPropertyValue:function(a,b){var c=this.get(a);return d.isObject(b)||(b=this.vie.entities.get(b)),d.isArray(c)?-1!==c.indexOf(b):c===b},isof:function(a){var b=this.get("@type");if(void 0===b)return!1;b=d.isArray(b)?b:[b],a=this.vie.types.get(a)?this.vie.types.get(a):new this.vie.Type(a);var c=!1;return d.each(b,function(b){this.vie.types.get(b).isof(a)&&(c=!0)},this),c},addTo:function(a,b){if(a instanceof this.vie.Collection)return b?a.addOrUpdate(this):a.add(this),this;throw new Error("Please provide a proper collection of type VIE.Collection as argument!")}}),e.prototype.Collection=c.Collection.extend({model:e.prototype.Entity,initialize:function(a,b){if(!b||!b.vie)throw new Error("Each collection needs a VIE reference");this.vie=b.vie,this.predicate=b.predicate},canAdd:function(){return!0},get:function(a){return null===a?null:(a=a.getSubject?a.getSubject():a,"string"==typeof a&&0===a.indexOf("_:")?2===a.indexOf("bnode")?(a=a.replace("_:bnode","c"),this._byId[a]):this._byId["<"+a+">"]:this._byId[a]?this._byId[a]:(a=this.toReference(a),this._byId[a]))},addOrUpdate:function(a,c){c=c||{};var e,f=this;if(d.isArray(a)){var g=[];return d.each(a,function(a){g.push(f.addOrUpdate(a,c))}),g}if(void 0===a)throw new Error("No model given");if(d.isString(a)&&(a={"@subject":a,id:a}),a.isEntity||(a=new this.model(a)),a.id&&this.get(a.id)&&(e=this.get(a.id)),this.get(a.cid)&&(e=this.get(a.cid)),e){var h={};return d.each(a.attributes,function(g,i){if(!e.has(i))return h[i]=g,!0;if("@subject"===i&&a.isNew()&&!e.isNew())return!0;if(e.get(i)===g)return!0;var j=e.attributes[i],k=g;return j instanceof f.vie.Collection?!0:c.overrideAttributes?(h[i]=g,!0):void("@context"===i?h[i]=b.extend(!0,{},j,k):(j=b.isArray(j)?j:[j],k=b.isArray(k)?k:[k],h[i]=d.uniq(j.concat(k)),h[i]=1===h[i].length?h[i][0]:h[i]))}),d.isEmpty(h)||e.set(h,c.updateOptions),e}return this.add(a,c.addOptions),a},isReference:function(a){return e.Util.isReference(a)},toReference:function(a){return e.Util.toReference(a,this.vie.namespaces)},fromReference:function(a){return e.Util.fromReference(a,this.vie.namespaces)},isCollection:!0}),e.prototype.Type=function(a,c,d){if(void 0===a||"string"!=typeof a)throw"The type constructor needs an 'id' of type string! E.g., 'Person'";if(this.id=this.vie.namespaces.isUri(a)?a:this.vie.namespaces.uri(a),this.vie.types.get(this.id))throw new Error("The type "+this.id+" is already defined!");this.supertypes=new this.vie.Types,this.subtypes=new this.vie.Types,this.attributes=new this.vie.Attributes(this,c?c:[]),this.metadata=d?d:{},this.isof=function(a){if(a instanceof e.prototype.Type||(a=this.vie.types.get(a)?this.vie.types.get(a):new this.vie.Type(a)),a)return a.subsumes(this.id);throw new Error("No valid type given")},this.subsumes=function(a){if(a=this.vie.types.get(a)){if(this.id===a.id)return!0;for(var b=this.subtypes.list(),c=0;c<b.length;c++){var d=b[c];if(d&&(d.id===a.id||d.subsumes(a)))return!0}return!1}throw new Error("No valid type given")},this.inherit=function(a){if("string"==typeof a)this.inherit(this.vie.types.get(a));else if(a instanceof this.vie.Type){a.subtypes.addOrOverwrite(this),this.supertypes.addOrOverwrite(a);try{this.attributes.list()}catch(c){throw a.subtypes.remove(this),this.supertypes.remove(a),c}}else{if(!b.isArray(a))throw new Error("Wrong argument in VIE.Type.inherit()");for(var d=0,e=a.length;e>d;d++)this.inherit(a[d])}return this},this.hierarchy=function(){for(var a={id:this.id,subtypes:[]},b=this.subtypes.list(),c=0,d=b.length;d>c;c++){var e=this.vie.types.get(b[c]);a.subtypes.push(e.hierarchy())}return a},this.instance=function(a,b){var c=this.vie.getTypedEntityClass(this);return new c(a,b)},this.toString=function(){return this.id}},e.prototype.Types=function(){this._types={},this.add=function(a,b,c){if(d.isArray(a))return d.each(a,function(a){this.add(a)},this),this;if(this.get(a))throw new Error("Type '"+a+"' already registered.");if("string"==typeof a){var e=new this.vie.Type(a,b,c);return this._types[e.id]=e,e}if(a instanceof this.vie.Type)return this._types[a.id]=a,a;throw new Error("Wrong argument to VIE.Types.add()!")},this.addOrOverwrite=function(a,b){return this.get(a)&&this.remove(a),this.add(a,b)},this.get=function(a){if(!a)return void 0;if("string"==typeof a){var b=this.vie.namespaces.isUri(a)?a:this.vie.namespaces.uri(a);return this._types[b]}return a instanceof this.vie.Type?this.get(a.id):void 0},this.remove=function(a){var b=this.get(a);if(!b)return this;if(!b||b.subsumes("owl:Thing"))return this;delete this._types[b.id];for(var c=b.subtypes.list(),d=0;d<c.length;d++){var e=c[d];1===e.supertypes.list().length?this.remove(e):e.supertypes.remove(b.id)}return b},this.toArray=this.list=function(){var a=[];for(var b in this._types)a.push(this._types[b]);return a},this.sort=function(a,c){var d=this;if(a=b.isArray(a)?a:[a],c=c?!0:!1,0===a.length)return[];var e,f,g=[a[0]];for(e=1,f=a.length;f>e;e++){var h=a[e],i=d.get(h);if(i)for(var j=0;j<g.length;j++){if(i.subsumes(g[j])){g.splice(j,0,h);break}j===g.length-1&&g.push(h)}}for(e=0;e<g.length;e++)g.lastIndexOf(g[e])!==e&&(g.splice(e,1),e--);return c||g.reverse(),g}},e.prototype.Attribute=function(a,b,c,e,f,g){if(void 0===a||"string"!=typeof a)throw new Error("The attribute constructor needs an 'id' of type string! E.g., 'Person'");if(void 0===b)throw new Error("The attribute constructor of "+a+" needs 'range'.");if(void 0===c)throw new Error("The attribute constructor of "+a+" needs a 'domain'.");this._domain=c,this.id=this.vie.namespaces.isUri(a)?a:this.vie.namespaces.uri(a),this.range=d.isArray(b)?b:[b],e=e?e:0,this.min=e>0?e:0,f=f?f:1,-1===f&&(f=Number.MAX_VALUE),this.max=f>=this.min?f:this.min,this.metadata=g?g:{},this.applies=function(a){this.vie.types.get(a)&&(a=this.vie.types.get(a));for(var b=0,c=this.range.length;c>b;b++){var d=this.vie.types.get(this.range[b]);if(void 0===d&&"string"==typeof a){if(a===this.range[b])return!0}else if(a.isof(this.range[b]))return!0}return!1}},e.prototype.Attributes=function(a,c){this._local={},this._attributes={},this.domain=a,this.add=function(a,b,c,e,f){if(d.isArray(a))return d.each(a,function(a){this.add(a)},this),this;if(this.get(a))throw new Error("Attribute '"+a+"' already registered for domain "+this.domain.id+"!");if("string"==typeof a){var g=new this.vie.Attribute(a,b,this.domain,c,e,f);return this._local[g.id]=g,g}if(a instanceof this.vie.Attribute)return a.domain=this.domain,a.vie=this.vie,this._local[a.id]=a,a;throw new Error("Wrong argument to VIE.Types.add()!")},this.remove=function(a){var b=this.get(a);if(b.id in this._local)return delete this._local[b.id],b;throw new Error("The attribute "+a+" is inherited and cannot be removed from the domain "+this.domain.id+"!")},this.get=function(a){if("string"==typeof a){var b=this.vie.namespaces.isUri(a)?a:this.vie.namespaces.uri(a);return this._inherit()._attributes[b]}if(a instanceof this.vie.Attribute)return this.get(a.id);throw new Error("Wrong argument in VIE.Attributes.get()")},this._inherit=function(){var a,c,e,f,g,h=b.extend(!0,{},this._local),i=d.map(this.domain.supertypes.list(),function(a){return a.attributes}),j={},k={};for(a=0,f=i.length;f>a;a++){var l=i[a].list();for(c=0,g=l.length;g>c;c++)e=l[c].id,e in h||(e in j||e in k?(k[e]||(k[e]={range:[],mins:[],maxs:[],metadatas:[]}),e in j&&(k[e].range=b.merge(k[e].range,j[e].range),k[e].mins=b.merge(k[e].mins,[j[e].min]),k[e].maxs=b.merge(k[e].maxs,[j[e].max]),k[e].metadatas=b.merge(k[e].metadatas,[j[e].metadata]),delete j[e]),k[e].range=b.merge(k[e].range,l[c].range),k[e].mins=b.merge(k[e].mins,[l[c].min]),k[e].maxs=b.merge(k[e].maxs,[l[c].max]),k[e].metadatas=b.merge(k[e].metadatas,[l[c].metadata]),k[e].range=d.uniq(k[e].range),k[e].mins=d.uniq(k[e].mins),k[e].maxs=d.uniq(k[e].maxs),k[e].metadatas=d.uniq(k[e].metadatas)):j[e]=l[c])}b.extend(h,j);for(e in k){for(var m=k[e].range,n=k[e].mins,o=k[e].maxs,p=k[e].metadatas,q=[],r=0,s=m.length;s>r;r++){var t=this.vie.types.get(m[r]),u=!1;if(t)for(c=0;s>c;c++)if(c!==r){var v=this.vie.types.get(m[c]);if(v&&v.isof(t)){u=!0;break}}u||q.push(m[r])}var w=d.max(n),x=d.min(o);if(!(x>=w&&x>=0&&w>=0))throw new Error("This inheritance is not allowed because of an invalid minCount/maxCount pair!");h[e]=new this.vie.Attribute(e,q,this,w,x,p[0])}return this._attributes=h,this},this.toArray=this.list=function(a){var b=[],c=this._inherit()._attributes;for(var d in c)(!a||c[d].applies(a))&&b.push(c[d]);return b},c=d.isArray(c)?c:[c],d.each(c,function(a){this.add(a.id,a.range,a.min,a.max,a.metadata)},this)},e.prototype.Namespaces)throw new Error("ERROR: VIE.Namespaces is already defined. Please check your VIE installation!");e.prototype.Namespaces=function(a,b){if(!a)throw new Error("Please provide a base namespace!");if(this._base=a,this._namespaces=b?b:{},"object"!=typeof this._namespaces||d.isArray(this._namespaces))throw new Error("If you want to initialise VIE namespace prefixes, please provide a proper object!")},e.prototype.Namespaces.prototype.base=function(a){if(a){if("string"==typeof a)return this.removeNamespace(a),this._base=a,this._base;throw new Error("Please provide a valid namespace!")}return this._base},e.prototype.Namespaces.prototype.add=function(a,b){if("object"==typeof a){for(var c in a)this.add(c,a[c]);return this}if(""===a)return this.base(b),this;if(this.contains(a)&&b!==this._namespaces[a])throw new Error("ERROR: Trying to register namespace prefix mapping ("+a+","+b+")!There is already a mapping existing: '("+a+","+this.get(a)+")'!");return this._namespaces[a]=b,this},e.prototype.Namespaces.prototype.addOrReplace=function(a,b){if("object"==typeof a){for(var c in a)this.addOrReplace(c,a[c]);return this}return this.remove(a),this.add(a,b)},e.prototype.Namespaces.prototype.get=function(a){return""===a?this.base():this._namespaces[a]},e.prototype.Namespaces.prototype.getPrefix=function(a){var c;return 0===a.indexOf("<")&&(a=a.substring(1,a.length-1)),b.each(this._namespaces,function(b,d){0===a.indexOf(d)&&(c=b),0===a.indexOf(b+":")&&(c=b)}),c},e.prototype.Namespaces.prototype.contains=function(a){return a in this._namespaces},e.prototype.Namespaces.prototype.containsNamespace=function(a){return void 0!==this.getPrefix(a)},e.prototype.Namespaces.prototype.update=function(a,b){return this.remove(a),this.add(a,b)},e.prototype.Namespaces.prototype.updateNamespace=function(a,b){return this.removeNamespace(a),this.add(a,b)},e.prototype.Namespaces.prototype.remove=function(a){return a&&delete this._namespaces[a],this},e.prototype.Namespaces.prototype.removeNamespace=function(a){var b=this.getPrefix(a);return b&&delete this._namespaces[b],this},e.prototype.Namespaces.prototype.toObj=function(a){return a?b.extend({},this._namespaces):b.extend({"":this._base},this._namespaces)},e.prototype.Namespaces.prototype.curie=function(a,b){return e.Util.toCurie(a,b,this)},e.prototype.Namespaces.prototype.isCurie=function(a){return e.Util.isCurie(a,this)},e.prototype.Namespaces.prototype.uri=function(a){return e.Util.toUri(a,this)},e.prototype.Namespaces.prototype.isUri=e.Util.isUri,e.prototype.ClassicRDFa=function(a){this.vie=a},e.prototype.ClassicRDFa.prototype={readEntities:function(a){var b=[],c=this.vie.RDFaEntities.getInstances(a);return d.each(c,function(a){b.push(a.toJSONLD())}),b},findPredicateElements:function(a,b,c){return this.vie.services.rdfa.findPredicateElements(a,b,c)},getPredicate:function(a){return this.vie.services.rdfa.getElementPredicate(a)},getSubject:function(a){return this.vie.services.rdfa.getElementSubject(a)}},e.prototype.ClassicRDFaEntities=function(a){this.vie=a},e.prototype.ClassicRDFaEntities.prototype={getInstances:function(a){this.vie.services.rdfa||this.vie.use(new this.vie.RdfaService);var b=null,c=!1;for(this.vie.load({element:a}).from("rdfa").execute().done(function(a){b=a,c=!0});!c;);return b},getInstance:function(a){var b=this.getInstances(a);return b&&b.length?b.pop():null}},e.prototype.ClassicEntityManager=function(a){this.vie=a,this.entities=this.vie.entities},e.prototype.ClassicEntityManager.prototype={getBySubject:function(a){return this.vie.entities.get(a)},getByJSONLD:function(a){if("string"==typeof a)try{a=b.parseJSON(a)}catch(c){return null}return this.vie.entities.addOrUpdate(a)},initializeCollection:function(){}},function(){e.prototype.DBPediaService=function(a){var c={name:"dbpedia",namespaces:{owl:"http://www.w3.org/2002/07/owl#",yago:"http://dbpedia.org/class/yago/",foaf:"http://xmlns.com/foaf/0.1/",georss:"http://www.georss.org/georss/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",dbpedia:"http://dbpedia.org/ontology/",dbprop:"http://dbpedia.org/property/",dcelements:"http://purl.org/dc/elements/1.1/"},rules:[]};this.options=b.extend(!0,c,a?a:{}),this.vie=null,this.name=this.options.name,b.ajaxSetup({converters:{"text application/rdf+json":function(a){return JSON.parse(a)}},timeout:6e4})},e.prototype.DBPediaService.prototype={init:function(){for(var a in this.options.namespaces){var c=this.options.namespaces[a];this.vie.namespaces.add(a,c)}return this.rules=b.extend([],e.Util.transformationRules(this)),this.rules=b.merge(this.rules,this.options.rules?this.options.rules:[]),this.connector=new this.vie.DBPediaConnector(this.options),this},load:function(a){var b=this,c=a instanceof this.vie.Loadable;if(!c)throw new Error("Invalid Loadable passed");var f=function(c){c="string"==typeof c?JSON.parse(c):c,d.defer(function(){try{var f=e.Util.rdf2Entities(b,c);f=d.isArray(f)?f:[f],d.each(f,function(a){a.set("DBPediaServiceLoad",e.Util.xsdDateTime(new Date))}),f=1===f.length?f[0]:f,a.resolve(f)}catch(g){a.reject(g)}})},g=function(b){a.reject(b)},h=a.options.entity?a.options.entity:a.options.entities;if(h){h=d.isArray(h)?h:[h];for(var i=[],j=0;j<h.length;j++){var k="string"==typeof h[j]?h[j]:h[j].id;i.push(k)}this.connector.load(i,f,g)}else a.reject([]);return this}},e.prototype.DBPediaConnector=function(a){this.options=a,this.baseUrl="http://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&timeout=0"},e.prototype.DBPediaConnector.prototype={load:function(a,c,e,f){f||(f={});var g=this.baseUrl+"&format="+encodeURIComponent("application/rdf+json")+"&query=";if(d.isArray(a)){for(var h="",i="",j=0;j<a.length;j++){var k=/^<.+>$/.test(a[j])?a[j]:"<"+a[j]+">";j>0&&(h+=" .",i+=" UNION "),h+=" "+k+" ?prop"+j+" ?val"+j,i+=" { "+k+" ?prop"+j+" ?val"+j+" }"}g+=encodeURIComponent("CONSTRUCT {"+h+" } WHERE {"+i+" }")}else a=/^<.+>$/.test(a)?a:"<"+a+">",g+=encodeURIComponent("CONSTRUCT { "+a+" ?prop ?val } WHERE { "+a+" ?prop ?val }");var l=f.format||"application/rdf+json";return"undefined"!=typeof exports&&"undefined"!=typeof process?this._loadNode(g,c,e,f,l):(b.ajax({success:function(a){c(a)},error:e,type:"GET",url:g,accepts:{"application/rdf+json":"application/rdf+json"}}),this)},_loadNode:function(a,b,c,d,e){var f=require("request"),g=f({method:"GET",uri:a,headers:{Accept:e}},function(a,d,e){return 200!==d.statusCode?c(e):void b(JSON.parse(e))});return g.end(),this}}}(),function(){e.prototype.OpenCalaisService=function(a){var c={name:"opencalais",url:["http://api.opencalais.com/enlighten/rest/"],timeout:6e4,namespaces:{opencalaisc:"http://s.opencalais.com/1/pred/",opencalaiscr:"http://s.opencalais.com/1/type/er/",opencalaiscm:"http://s.opencalais.com/1/type/em/e/"},rules:[]};this.options=b.extend(!0,c,a?a:{}),this.vie=null,this.name=this.options.name,b.ajaxSetup({converters:{"text application/rdf+json":function(a){return JSON.parse(a)}},timeout:this.options.timeout})},e.prototype.OpenCalaisService.prototype={init:function(){for(var a in this.options.namespaces){var c=this.options.namespaces[a];this.vie.namespaces.add(a,c)}this.rules=b.extend([],e.Util.transformationRules(this)),this.rules=b.merge(this.rules,this.options.rules?this.options.rules:[]),this.connector=new this.vie.OpenCalaisConnector(this.options)},analyze:function(a){var c=this,f=a instanceof this.vie.Analyzable;if(!f)throw"Invalid Analyzable passed";var g=a.options.element?a.options.element:b("body"),h=c._extractText(g);if(h.length>0){var i=function(b){d.defer(function(){var d=e.Util.rdf2Entities(c,b);a.resolve(d)})},j=function(b){a.reject(b)};this.connector.analyze(h,i,j)}else console.warn("No text found in element."),a.resolve([])},_extractText:function(a){if(a.get(0)&&a.get(0).tagName&&("TEXTAREA"==a.get(0).tagName||"INPUT"==a.get(0).tagName&&a.attr("type","text")))return a.get(0).val();var c=a.text().replace(/\s+/g," ").replace(/\0\b\n\r\f\t/g,"");return b.trim(c)}},e.prototype.OpenCalaisConnector=function(a){this.options=a,this.baseUrl=d.isArray(a.url)?a.url:[a.url],this.enhancerUrlPrefix="/"},e.prototype.OpenCalaisConnector.prototype={analyze:function(a,c,e,f){if(f||(f={urlIndex:0}),f.urlIndex>=this.baseUrl.length)return void e("Could not connect to the given OpenCalais endpoints! Please check for their setup!");var g=this.baseUrl[f.urlIndex].replace(/\/$/,"");g+=this.enhancerUrlPrefix;var h=f.format||"application/rdf+json",i=function(a,b,c,e,f){return function(){console.error("OpenCalais connection error",arguments),a.analyze(b,c,e,d.extend(f,{urlIndex:f.urlIndex+1}))}}(this,a,c,e,f),j=this._prepareData(a);return"undefined"!=typeof exports&&"undefined"!=typeof process?this._analyzeNode(g,j,c,i,f,h):void b.ajax({success:function(a,b,d){var e=d.responseText.replace(/<!--[\s\S]*?-->/g,"");c(e)},error:i,type:"POST",url:g,data:j,accept:"text/plain"})},_analyzeNode:function(a,b,c,d,e,f){var g=require("request"),h=g({method:"POST",uri:a,body:b,headers:{Accept:f}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});h.end()},_prepareData:function(a){return{licenseID:this.options.api_key,calculareRelevanceScore:"true",enableMetadataType:"GenericRelations,SocialTags",contentType:"text/html",content:a}}}}(),function(){e.prototype.RdfaRdfQueryService=function(a){var c={name:"rdfardfquery",namespaces:{},rules:[]};this.options=b.extend(!0,c,a?a:{}),this.views=[],this.vie=null,this.name=this.options.name},e.prototype.RdfaRdfQueryService.prototype={init:function(){for(var a in this.options.namespaces){var c=this.options.namespaces[a];this.vie.namespaces.add(a,c)}this.rules=b.extend([],e.Util.transformationRules(this)),this.rules=b.merge(this.rules,this.options.rules?this.options.rules:[])},analyze:function(a){return this.load(a)},load:function(a){var c=this,d=a instanceof this.vie.Loadable||a instanceof this.vie.Analyzable;if(!d)throw new Error("Invalid Loadable/Analyzable passed");var f=a.options.element?a.options.element:b(document);try{var g=b(f).find("[about],[typeof]").rdfa();b.each(b(f).xmlns(),function(a,b){c.vie.namespaces.addOrReplace(a,b.toString())});var h=e.Util.rdf2Entities(this,g);a.resolve(h)}catch(i){a.reject(i)}},save:function(a){var c=a instanceof this.vie.Savable;c||a.reject("Invalid Savable passed"),a.options.element||a.reject("Unable to write entity to RDFa, no element given"),a.options.entity||a.reject("Unable to write to RDFa, no entity given"),b.rdf||a.reject("No rdfQuery found.");var d=a.options.entity,e=[],f=d.get("@type");f=b.isArray(f)?f[0]:f,f=f.id,e.push(d.getSubject()+" a "+f),b(a.options.element).rdfa(e),a.resolve()}}}(),function(){e.prototype.RdfaService=function(a){var c={name:"rdfa",namespaces:{},subjectSelector:"[about],[typeof],[src],html",predicateSelector:"[property],[rel]",rules:[],bnodePrefix:"_a"};this.options=b.extend(!0,c,a?a:{}),this.bnodes=0,this.views=[],this.templates={},this.datatypeReaders={"<http://www.w3.org/2001/XMLSchema#boolean>":function(a){return"true"===a||1===a||a===!0?!0:!1},"<http://www.w3.org/2001/XMLSchema#dateTime>":function(a){return new Date(a)},"<http://www.w3.org/2001/XMLSchema#integer>":function(a){return parseInt(a,10)}},this.datatypeWriters={"<http://www.w3.org/2001/XMLSchema#dateTime>":function(a){return d.isDate(a)?a.toISOString():a}},this.vie=null,this.name=this.options.name},e.prototype.RdfaService.prototype={init:function(){for(var a in this.options.namespaces){var c=this.options.namespaces[a];this.vie.namespaces.add(a,c)}this.rules=b.merge([],e.Util.transformationRules(this)),this.rules=b.merge(this.rules,this.options.rules?this.options.rules:[])},analyze:function(a){return this.load(a)},load:function(a){var c=a instanceof this.vie.Loadable||a instanceof this.vie.Analyzable;if(!c)throw new Error("Invalid Loadable/Analyzable passed");var d;if(a.options.element)d=a.options.element;else{if("undefined"==typeof document)return a.resolve([]);d=b(document)}var e=this.readEntities(d);a.resolve(e)},save:function(a){var b=a instanceof this.vie.Savable;if(!b)throw"Invalid Savable passed";if(!a.options.element)throw"Unable to write entity to RDFa, no element given";if(!a.options.entity)throw"Unable to write to RDFa, no entity given";this._writeEntity(a.options.entity,a.options.element),a.resolve()},readEntities:function(a){{var c=this,d=[];b(this.options.subjectSelector,a).add(b(a).filter(this.options.subjectSelector)).each(function(){var a=c.xmlns(this);for(var e in a)c.vie.namespaces.addOrReplace(e,a[e]);var f=c._readEntity(b(this));f&&d.push(f)})}return d},_readEntity:function(a){var c=this.getElementSubject(a),e=this._getElementType(a),f=this._readEntityPredicates(c,a,!1);if(b.isEmptyObject(f))return null;var g=this.vie;d.each(f,function(a,b){if(d.isArray(a)){var c=new this.vie.Collection([],{vie:g,predicate:b});d.each(a,function(a){var b=g.entities.addOrUpdate({"@subject":a});c.addOrUpdate(b)}),f[b]=c}},this),f["@subject"]=c,e&&(f["@type"]=e);var h=new this.vie.Entity(f);return h=this.vie.entities.addOrUpdate(h,{updateOptions:{silent:!0,ignoreChanges:!0}}),this._registerEntityView(h,a),h},_writeEntity:function(a,c){var d=this;return this.findPredicateElements(this.getElementSubject(c),c,!0).each(function(){var c=b(this),e=d.getElementPredicate(c);if(!a.has(e))return!0;var f=a.get(e);return f&&f.isCollection?!0:f===d.readElementValue(e,c)?!0:void d.writeElementValue(e,c,f)}),!0},_getViewForElement:function(a,c){var d;return b.each(this.views,function(){return b(this.el).get(0)===a.get(0)?c&&!this.template?!0:(d=this,!1):void 0}),d},_registerEntityView:function(a,c,d){if(c.length){var e=this,f=this._getViewForElement(c);return f?(a.hasRelations()&&!f.collectionsChecked&&this._registerEntityCollectionViews(a,c,f),f):(f=new this.vie.view.Entity({model:a,el:c,tagName:c.get(0).nodeName,vie:this.vie,service:this.name}),this.views.push(f),d&&b(c).find(this.options.predicateSelector).add(b(c).filter(this.options.predicateSelector)).each(function(){var c=b(this).attr("rel");c&&a.set(c,new e.vie.Collection([],{vie:e.vie,predicate:c}))}),this._registerEntityCollectionViews(a,c,f),f)}},_registerEntityCollectionViews:function(a,c,e){var f=this;d.each(a.attributes,function(d,g){var h=a.fromReference(a.get(g));h&&h.isCollection&&(b.each(f.getElementByPredicate(g,c),function(){f._registerCollectionView(h,b(this),a)}),e.collectionsChecked=!0)})},setTemplate:function(a,b,c){var e;c||(c=b,b="default"),a=this.vie.namespaces.isUri(a)?a:this.vie.namespaces.uri(a),e=d.isFunction(c)?c:this.getElementTemplate(c),this.templates[a]||(this.templates[a]={}),this.templates[a][b]=e,d.each(this.views,function(c){c instanceof this.vie.view.Collection&&c.collection.predicate===b&&(c.templates[a]=e)},this)},getTemplate:function(a,b){return b||(b="default"),a=this.vie.namespaces.isUri(a)?a:this.vie.namespaces.uri(a),this.templates[a]?this.templates[a][b]:void 0},_getElementTemplates:function(a,c,e){var f={},g=c.get("@type");if(g&&g.attributes&&g.attributes.get(e)){var h=g.attributes.get(e);if(d.each(h.range,function(a){var b=this.getTemplate(a,e);if(b){var c=this.vie.types.get(a);f[c.id]=b}},this),!d.isEmpty(f))return f}var i=this;if(b("[typeof]",a).each(function(){var a=b(this),c=a.attr("typeof");if(c=i.vie.namespaces.isUri(c)?c:i.vie.namespaces.uri(c),!f[c]){var d=i.getElementTemplate(a);f[c]=d,f["<http://www.w3.org/2002/07/owl#Thing>"]=d}}),d.isEmpty(f)){var j=a.children(":first-child");j.length&&(f["<http://www.w3.org/2002/07/owl#Thing>"]=i.getElementTemplate(j))}return f},getElementTemplate:function(a){d.isString(a)&&(a=b.trim(a));var c=this;return function(d,e){var f=b(a).clone(!1);void 0!==f.attr("about")&&f.attr("about",""),f.find("[about]").attr("about","");var g=c.findPredicateElements(g,f,!1).each(function(){var a=b(this),e=c.getElementPredicate(a);return d.has(e)&&d.get(e).isCollection?!0:void c.writeElementValue(null,a,"")});e(f)}},_registerCollectionView:function(a,b,c){var d=this._getViewForElement(b,!0);return d?d:(d=new this.vie.view.Collection({owner:c,collection:a,model:a.model,el:b,templates:this._getElementTemplates(b,c,a.predicate),service:this}),this.views.push(d),d)},_getElementType:function(a){var c;return b(a).attr("typeof")!==this.options.attributeExistenceComparator?(c=b(a).attr("typeof"),c&&-1!==c.indexOf("://")?"<"+c+">":c):null},_generatebnodeId:function(){var a=this.options.bnodePrefix+":"+this.bnodes;return this.bnodes++,a},getElementSubject:function(a){var c=this;if("undefined"!=typeof document&&a===document)return document.baseURI;var d,e=null;return b(a).closest(this.options.subjectSelector).each(function(){if(e=this,b(this).attr("about")!==c.options.attributeExistenceComparator)return d=b(this).attr("about"),!0;if(b(this).attr("src")!==c.options.attributeExistenceComparator)return d=b(this).attr("src"),!0;if(b(this).attr("typeof")!==c.options.attributeExistenceComparator){var a=b(this);return a.data("vie-bnode")?(d=a.data("vie-bnode"),!0):(d=c._generatebnodeId(),a.data("vie-bnode",d),!0)}"HTML"===b(this).get(0).nodeName&&b("base",this).each(function(){d=b(this).attr("href")})}),d?"object"==typeof d?d:0===d.indexOf("_:")?d:0===d.indexOf("<")?d:"<"+d+">":void 0},setElementSubject:function(a,c){return b(c).attr("src")?b(c).attr("src",a):b(c).attr("about",a)},getElementPredicate:function(a){var c;return a=b(a),c=a.attr("property"),c||(c=a.attr("rel")),c},getElementBySubject:function(a,c){var d=this;return b(c).find(this.options.subjectSelector).add(b(c).filter(this.options.subjectSelector)).filter(function(){return d.getElementSubject(b(this))!==a?!1:!0})},getElementByPredicate:function(a,c){var d=this,e=this.getElementSubject(c);return b(c).find(this.options.predicateSelector).add(b(c).filter(this.options.predicateSelector)).filter(function(){var c=d.getElementPredicate(b(this));return d.vie.namespaces.curie(c)!==d.vie.namespaces.curie(a)?!1:d.getElementSubject(this)!==e?!1:!0})},_readEntityPredicates:function(a,c,d){var e=this,f={};return this.findPredicateElements(a,c,!0).each(function(){var a=b(this),c=e.getElementPredicate(a);if(""!==c){var g=e.readElementValue(c,a);(null!==g||d)&&(f[c]=g)}}),"HTML"!==b(c).get(0).tagName&&b(c).parent("[rev]").each(function(){var a=b(this).attr("rev");a&&(f[b(this).attr("rev")]=e.getElementSubject(this))}),f},findSubjectElements:function(a){return b("[about]",a)},findPredicateElements:function(a,c,d){var e=this;return b(c).find(this.options.predicateSelector).add(b(c).filter(this.options.predicateSelector)).filter(function(){return e.getElementSubject(this)!==a?!1:d?!0:b(this).parents("[property]").length?!1:!0})},parseElementValue:function(a,b){if(!b.attr("datatype"))return a;var c=this.vie.namespaces.uri(b.attr("datatype"));return this.datatypeReaders[c]?this.datatypeReaders[c](a):a},generateElementValue:function(a,b){if(!b.attr("datatype"))return a;var c=this.vie.namespaces.uri(b.attr("datatype"));return this.datatypeWriters[c]?this.datatypeWriters[c](a):a},readElementValue:function(a,c){var d=c.attr("content");if(d)return this.parseElementValue(d,c);var e=c.attr("resource");if(e)return["<"+e+">"];var f=c.attr("href");if(f&&c.attr("rel")===a)return["<"+f+">"];if(c.attr("rel")){var g=[],h=this;return b(c).children(this.options.subjectSelector).each(function(){g.push(h.getElementSubject(this,!0))}),g}return this.parseElementValue(c.html(),c)},writeElementValue:function(a,b,c){c=this.generateElementValue(c,b),d.isArray(c)&&c.length>0&&(c=c[0]);var e=b.attr("content");if(e)return void b.attr("content",c);var f=b.attr("resource");f&&b.attr("resource",c),b.html(c)},xmlns:function(a){var c;if(a)c=b(a);else{if("undefined"==typeof document)return{};c=b(document)}c=c.add(c.parents());var d={};return c.each(function(){var a=this;for(i=0;i<a.attributes.length;i+=1){var b=a.attributes[i];if(/^xmlns(:(.+))?$/.test(b.nodeName)){var c=/^xmlns(:(.+))?$/.exec(b.nodeName)[2]||"",e=b.nodeValue;(""===c||""!==e)&&(d[c]=b.nodeValue)}}}),d}}}(),function(){var a=["http://demo.iks-project.eu/stanbolfull","http://dev.iks-project.eu/stanbolfull"];e.prototype.StanbolService=function(c){var d={name:"stanbol",url:a,timeout:2e4,namespaces:{semdeski:"http://www.semanticdesktop.org/ontologies/2007/01/19/nie#",semdeskf:"http://www.semanticdesktop.org/ontologies/2007/03/22/nfo#",skos:"http://www.w3.org/2004/02/skos/core#",foaf:"http://xmlns.com/foaf/0.1/",opengis:"http://www.opengis.net/gml/",dbpedia:"http://dbpedia.org/ontology/",dbprop:"http://dbpedia.org/property/",owl:"http://www.w3.org/2002/07/owl#",geonames:"http://www.geonames.org/ontology#",enhancer:"http://fise.iks-project.eu/ontology/",entityhub:"http://www.iks-project.eu/ontology/rick/model/",entityhub2:"http://www.iks-project.eu/ontology/rick/query/",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dcterms:"http://purl.org/dc/terms/",schema:"http://schema.org/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#"},rules:[{left:["?subject a <http://fise.iks-project.eu/ontology/EntityAnnotation>","?subject enhancer:entity-type ?type","?subject enhancer:confidence ?confidence","?subject enhancer:entity-reference ?entity","?subject dcterms:relation ?relation","?relation a <http://fise.iks-project.eu/ontology/TextAnnotation>","?relation enhancer:selected-text ?selected-text","?relation enhancer:selection-context ?selection-context","?relation enhancer:start ?start","?relation enhancer:end ?end"],right:["?entity a ?type","?entity enhancer:hasTextAnnotation ?relation","?entity enhancer:hasEntityAnnotation ?subject"]}],enhancer:{chain:"default"},entityhub:{site:void 0}};
this.options=b.extend(!0,d,c?c:{}),this.vie=null,this.name=this.options.name},e.prototype.StanbolService.prototype={init:function(){for(var a in this.options.namespaces){var c=this.options.namespaces[a];this.vie.namespaces.add(a,c)}this.rules=b.extend([],e.Util.transformationRules(this)),this.rules=b.merge(this.rules,this.options.rules?this.options.rules:[]),this.connector=new this.vie.StanbolConnector(this.options),this.vie.types.addOrOverwrite("enhancer:EntityAnnotation",[]).inherit("owl:Thing"),this.vie.types.addOrOverwrite("enhancer:TextAnnotation",[]).inherit("owl:Thing"),this.vie.types.addOrOverwrite("enhancer:Enhancement",[]).inherit("owl:Thing")},analyze:function(a){var c=this,f=a instanceof this.vie.Analyzable;if(!f)throw"Invalid Analyzable passed";var g=a.options.element?a.options.element:b("body"),h=c._extractText(g);if(h.length>0){var i=function(b){d.defer(function(){var d=e.Util.rdf2Entities(c,b);c.vie.entities.addOrUpdate(d),a.resolve(d)})},j=function(b){a.reject(b)},k={chain:a.options.chain?a.options.chain:c.options.enhancer.chain};this.connector.analyze(h,i,j,k)}else a.resolve([])},find:function(a){var b=a instanceof this.vie.Findable;if(!b)throw"Invalid Findable passed";var c=this;a.options.term||a.reject([]);var f=a.options.term,g="undefined"==typeof a.options.limit?20:a.options.limit,h="undefined"==typeof a.options.offset?0:a.options.offset,i=function(b){d.defer(function(){var d=e.Util.rdf2Entities(c,b);a.resolve(d)})},j=function(b){a.reject(b)};a.options.site=a.options.site?a.options.site:c.options.entityhub.site;var k=this.vie;if(a.options.properties){var l=a.options.properties;a.options.ldPath=d(l).map(function(a){return k.namespaces.isCurie(a)?k.namespaces.uri(a)+";":a}).join("")}if(a.options.field&&k.namespaces.isCurie(m)){var m=a.options.field;a.options.field=k.namespaces.uri(m)}this.connector.find(f,g,h,i,j,a.options)},load:function(a){var b=a instanceof this.vie.Loadable;if(!b)throw"Invalid Loadable passed";var c=this,f=a.options.entity;f||a.resolve([]);var g=function(b){d.defer(function(){var f=e.Util.rdf2Entities(c,b);d.each(f,function(a){c.vie.entities.addOrUpdate(a)}),a.resolve(f)})},h=function(b){a.reject(b)},i={site:a.options.site?a.options.site:c.options.entityhub.site,local:a.options.local};this.connector.load(f,g,h,i)},save:function(a){var b=a instanceof this.vie.Savable;if(!b)throw"Invalid Savable passed";var c=this,f=a.options.entity;f||a.reject("StanbolConnector: No entity to save!");var g=function(b){d.defer(function(){var d=e.Util.rdf2Entities(c,b);a.resolve(d)})},h=function(b){a.reject(b)},i={site:a.options.site?a.options.site:c.options.entityhub.site,local:a.options.local};this.connector.save(f,g,h,i)},_extractText:function(a){if(a.get(0)&&a.get(0).tagName&&("TEXTAREA"==a.get(0).tagName||"INPUT"==a.get(0).tagName&&a.attr("type","text")))return a.get(0).val();var c=a.text().replace(/\s+/g," ").replace(/\0\b\n\r\f\t/g,"");return b.trim(c)}},e.prototype.StanbolConnector=function(c){var e={url:a,timeout:2e4,enhancer:{urlPostfix:"/enhancer",chain:"default"},entityhub:{site:void 0,urlPostfix:"/entityhub",local:!1},sparql:{urlPostfix:"/sparql"},contenthub:{urlPostfix:"/contenthub",index:"contenthub"},ontonet:{urlPostfix:"/ontonet"},factstore:{urlPostfix:"/factstore"},rules:{urlPostfix:"/rules"},cmsadapter:{urlPostfix:"/cmsadapter"}};this.options=b.extend(!0,e,c?c:{}),this.options.url=d.isArray(this.options.url)?this.options.url:[this.options.url],this._init(),this.baseUrl=d.isArray(c.url)?c.url:[c.url]},e.prototype.StanbolConnector.prototype={_init:function(){var a=this;return b.ajaxSetup({converters:{"text application/rdf+json":function(a){return JSON.parse(a)}},timeout:a.options.timeout}),this},_iterate:function(a){if(a){if(a.urlIndex>=this.options.url.length)return void a.error.call(this,"Could not connect to the given Stanbol endpoints! Please check for their setup!");var b=function(a,b){return function(){b.urlIndex=b.urlIndex+1,a._iterate(b)}}(this,a);return"undefined"!=typeof exports&&"undefined"!=typeof process?a.methodNode.call(this,a.url.call(this,a.urlIndex,a.args.options),a.args,a.success,b):a.method.call(this,a.url.call(this,a.urlIndex,a.args.options),a.args,a.success,b)}},analyze:function(a,b,c,d){d=d?d:{};var e=this;e._iterate({method:e._analyze,methodNode:e._analyzeNode,url:function(a,b){var c=b.chain?b.chain:this.options.enhancer.chain,d=this.options.url[a].replace(/\/$/,"");return d+=this.options.enhancer.urlPostfix+"/chain/"+c.replace(/\/$/,"")},args:{text:a,format:d.format||"application/rdf+json",options:d},success:b,error:c,urlIndex:0})},_analyze:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"POST",data:c.text,dataType:c.format,contentType:"text/plain",accepts:{"application/rdf+json":"application/rdf+json"}})},_analyzeNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:b.text,headers:{Accept:b.format,"Content-Type":"text/plain"}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},load:function(a,b,c,d){var e=this;d=d?d:{},d.uri=a.replace(/^</,"").replace(/>$/,""),e._iterate({method:e._load,methodNode:e._loadNode,success:b,error:c,url:function(a,b){var c=b.site?b.site:this.options.entityhub.site;c=c?"/"+c:"s";var d=b.local,e=this.options.url[a].replace(/\/$/,"")+this.options.entityhub.urlPostfix;return e+=d?"/entity?id="+encodeURIComponent(b.uri):"/site"+c+"/entity?id="+encodeURIComponent(b.uri)},args:{format:d.format||"application/rdf+json",options:d},urlIndex:0})},_load:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"GET",dataType:c.format,contentType:"text/plain",accepts:{"application/rdf+json":"application/rdf+json"}})},_loadNode:function(a,b,c,d){var e=require("request"),f=e({method:"GET",uri:a,body:b.text,headers:{Accept:b.format}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},find:function(a,b,c,d,e,f){f=f?f:{};var g=this;return a&&""!==a?(c=c?c:0,b=b?b:10,void g._iterate({method:g._find,methodNode:g._findNode,success:d,error:e,url:function(a,b){var c=b.site?b.site:this.options.entityhub.site;c=c?"/"+c:"s";var d=b.local,e=this.options.url[a].replace(/\/$/,"")+this.options.entityhub.urlPostfix;return e+=d?"/sites/find":"/site"+c+"/find"},args:{term:a,offset:c,limit:b,format:f.format||"application/rdf+json",options:f},urlIndex:0})):void e("No term given!")},_find:function(a,c,d,e){var f={name:c.term,limit:c.limit,offset:c.offset};b.ajax({success:d,error:e,url:a,type:"POST",data:b.param(f),dataType:c.format,contentType:"application/x-www-form-urlencoded",accepts:{"application/rdf+json":"application/rdf+json"}})},_findNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:"name="+b.term+"&limit="+b.limit+"&offset="+b.offset,headers:{Accept:b.format}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},lookup:function(a,b,c,d){d=d?d:{};var e=this;a=a.replace(/^</,"").replace(/>$/,""),d.uri=a,d.create=d.create?d.create:!1,e._iterate({method:e._lookup,methodNode:e._lookupNode,success:b,error:c,url:function(a,b){var c=this.options.url[a].replace(/\/$/,"")+this.options.entityhub.urlPostfix;return c+="/lookup?id="+encodeURIComponent(b.uri)+"&create="+b.create},args:{format:d.format||"application/rdf+json",options:d},urlIndex:0})},_lookup:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"GET",dataType:c.format,contentType:"text/plain",accepts:{"application/rdf+json":"application/rdf+json"}})},_lookupNode:function(a,b,c,d){var e=require("request"),f=e({method:"GET",uri:a,body:b.text,headers:{Accept:b.format}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},referenced:function(a,b,c){c=c?c:{};var e=this,f=function(b){d.isArray(b)||(b=JSON.parse(b));for(var c=[],e=0,f=b.length;f>e;e++)c.push(b[e].replace(/.+\/(.+?)\/?$/,"$1"));return a(c)};e._iterate({method:e._referenced,methodNode:e._referencedNode,success:f,error:b,url:function(a){var b=this.options.url[a].replace(/\/$/,"");return b+=this.options.entityhub.urlPostfix+"/sites/referenced"},args:{options:c},urlIndex:0})},_referenced:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"GET",accepts:{"application/rdf+json":"application/rdf+json"}})},_referencedNode:function(a,b,c,d){var e=require("request"),f=e({method:"GET",uri:a,headers:{Accept:b.format}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},sparql:function(a,b,c,d){d=d?d:{};var e=this;e._iterate({method:e._sparql,methodNode:e._sparqlNode,success:b,error:c,url:function(a){var b=this.options.url[a].replace(/\/$/,"");return b+=this.options.sparql.urlPostfix.replace(/\/$/,"")},args:{query:a,options:d},urlIndex:0})},_sparql:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"POST",data:"query="+c.query,contentType:"application/x-www-form-urlencoded"})},_sparqlNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:JSON.stringify({query:b.query}),headers:{Accept:b.format}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},ldpath:function(a,b,c,e,f){f=f?f:{};var g=this;b=d.isArray(b)?b:[b];for(var h="",i=0;i<b.length;i++)h+="&context="+b[i];g._iterate({method:g._ldpath,methodNode:g._ldpathNode,success:c,error:e,url:function(a,b){var c=b.site?b.site:this.options.entityhub.site;c=c?"/"+c:"s";var d=b.local,e=this.options.url[a].replace(/\/$/,"")+this.options.entityhub.urlPostfix;return d||(e+="/site"+c),e+="/ldpath"},args:{ldpath:a,context:h,format:f.format||"application/rdf+json",options:f},urlIndex:0})},_ldpath:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"POST",data:"ldpath="+c.ldpath+c.context,contentType:"application/x-www-form-urlencoded",dataType:c.format,accepts:{"application/rdf+json":"application/rdf+json"}})},_ldpathNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:"ldpath="+b.ldpath+b.context,headers:{Accept:b.format}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},uploadContent:function(a,b,c,d){d=d?d:{};var e=this;e._iterate({method:e._uploadContent,methodNode:e._uploadContentNode,success:b,error:c,url:function(a,b){var c=this.options.url[a].replace(/\/$/,"");c+=this.options.contenthub.urlPostfix.replace(/\/$/,"");var d=b.index?b.index:this.options.contenthub.index;return c+="/"+d.replace(/\/$/,""),c+="/store"},args:{content:a,options:d},urlIndex:0})},_uploadContent:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"POST",data:c.content,contentType:"text/plain"})},_uploadContentNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:b.content,headers:{Accept:"application/rdf+xml","Content-Type":"text/plain"}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},createFactSchema:function(a,b,c,d,e){e=e?e:{};var f=this;e.url=a,f._iterate({method:f._createFactSchema,methodNode:f._createFactSchemaNode,success:c,error:d,url:function(a,b){var c=this.options.url[a].replace(/\/$/,"");return c+=this.options.factstore.urlPostfix.replace(/\/$/,""),c+="/facts/"+encodeURIComponent(b.url)},args:{url:a,schema:b,options:e},urlIndex:0})},_createFactSchema:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"PUT",data:c.schema,contentType:"application/json",dataType:"application/json"})},_createFactSchemaNode:function(a,b,c,d){var e=require("request"),f=e({method:"PUT",uri:a,body:b.schema,headers:{Accept:"application/json","Content-Type":"application/json"}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},createFact:function(a,b,c,d){d=d?d:{};var e=this;e._iterate({method:e._createFact,methodNode:e._createFactNode,success:b,error:c,url:function(a){var b=this.options.url[a].replace(/\/$/,"");return b+=this.options.factstore.urlPostfix.replace(/\/$/,""),b+="/facts"},args:{fact:a,options:d},urlIndex:0})},_createFact:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"POST",data:c.fact,contentType:"application/json",dataType:"application/json"})},_createFactNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:b.fact,headers:{Accept:"application/json","Content-Type":"application/json"}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()},queryFact:function(a,b,c,d){d=d?d:{};var e=this;e._iterate({method:e._queryFact,methodNode:e._queryFactNode,success:b,error:c,url:function(a){var b=this.options.url[a].replace(/\/$/,"");return b+=this.options.factstore.urlPostfix.replace(/\/$/,""),b+="/query"},args:{query:a,options:d},urlIndex:0})},_queryFact:function(a,c,d,e){b.ajax({success:d,error:e,url:a,type:"POST",data:c.query,contentType:"application/json",dataType:"application/json"})},_queryFactNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:b.query,headers:{Accept:"application/json","Content-Type":"application/json"}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()}}}(),function(){e.prototype.ZemantaService=function(a){var c={name:"zemanta",url:["http://api.zemanta.com/services/rest/0.0/"],timeout:2e4,namespaces:{zemanta:"http://s.zemanta.com/ns#"},rules:[{left:["?subject a zemanta:Recognition","?subject zemanta:object ?object","?object owl:sameAs ?entity"],right:["?entity zemanta:hasEntityAnnotation ?subject"]}],api_key:void 0};this.options=b.extend(!0,c,a?a:{}),this.vie=null,this.name=this.options.name,b.ajaxSetup({converters:{"text application/rdf+json":function(a){return JSON.parse(a)}},timeout:this.options.timeout})},e.prototype.ZemantaService.prototype={init:function(){for(var a in this.options.namespaces){var c=this.options.namespaces[a];this.vie.namespaces.add(a,c)}this.rules=b.extend([],e.Util.transformationRules(this)),this.rules=b.merge(this.rules,this.options.rules?this.options.rules:[]),this.connector=new this.vie.ZemantaConnector(this.options),this.vie.types.addOrOverwrite("zemanta:Recognition",[]).inherit("owl:Thing")},analyze:function(a){var c=this,f=a instanceof this.vie.Analyzable;if(!f)throw"Invalid Analyzable passed";var g=a.options.element?a.options.element:b("body"),h=c._extractText(g);if(h.length>0){var i=function(b){d.defer(function(){var d=e.Util.rdf2Entities(c,b);a.resolve(d)})},j=function(b){a.reject(b)},k={};this.connector.analyze(h,i,j,k)}else a.resolve([])},_extractText:function(a){return b(a).wrap("<div>").parent().html()}},e.prototype.ZemantaConnector=function(a){var c={url:["http://api.zemanta.com/services/rest/0.0/"],timeout:2e4,api_key:void 0};this.options=b.extend(!0,c,a?a:{}),this.options.url=d.isArray(this.options.url)?this.options.url:[this.options.url],this._init(),this.baseUrl=d.isArray(a.url)?a.url:[a.url]},e.prototype.ZemantaConnector.prototype={_init:function(){var a=this;return b.ajaxSetup({converters:{"text application/rdf+json":function(a){return JSON.parse(a)}},timeout:a.options.timeout}),this},_iterate:function(a){if(a){if(a.urlIndex>=this.options.url.length)return void a.error.call(this,"Could not connect to the given Zemanta endpoints! Please check for their setup!");var b=function(a,b){return function(){b.urlIndex=b.urlIndex+1,a._iterate(b)}}(this,a);return"undefined"!=typeof exports&&"undefined"!=typeof process?a.methodNode.call(this,a.url.call(this,a.urlIndex,a.args.options),a.args,a.success,b):a.method.call(this,a.url.call(this,a.urlIndex,a.args.options),a.args,a.success,b)}},analyze:function(a,b,c,d){d=d?d:{};var e=this;e._iterate({method:e._analyze,methodNode:e._analyzeNode,success:b,error:c,url:function(a){var b=this.options.url[a].replace(/\/$/,"");return b},args:{text:a,format:d.format||"rdfxml",options:d},urlIndex:0})},_analyze:function(a,c,d,e){b.ajax({success:function(a,b,c){var e=c.responseText.replace(/<z:signature>.*?<\/z:signature>/,"");d(e)},error:e,url:a,type:"POST",dataType:"xml",data:{method:"zemanta.suggest",text:c.text,format:c.format,api_key:this.options.api_key,return_rdf_links:c.options.return_rdf_links},contentType:"text/plain",accepts:{"application/rdf+json":"application/rdf+json"}})},_analyzeNode:function(a,b,c,d){var e=require("request"),f=e({method:"POST",uri:a,body:b.text,headers:{Accept:b.format,"Content-Type":"text/plain"}},function(a,b,e){try{c({results:JSON.parse(e)})}catch(f){d(f)}});f.end()}}}(),e.prototype.view||(e.prototype.view={}),e.prototype.view.Collection=c.View.extend({initialize:function(){if(this.templates=this.options.templates,this.service=this.options.service,!this.service)throw"No RDFa service provided to the Collection View";this.owner=this.options.owner,this.definition=this.options.definition,this.entityViews={},this.listenTo(this.collection,"add",this.addItem),this.listenTo(this.collection,"remove",this.removeItem),this.listenTo(this.collection,"reset",this.refreshItems),this.collection.each(function(a){this.registerItem(a,this.collection)},this)},canAdd:function(a){return d.isEmpty(this.templates)?!1:a&&!this.templates[a]?!1:this.collection.canAdd(a)},addItem:function(a,b){if(b===this.collection){var c,e=a.get("@type");if(d.isArray(e)?d.each(e,function(a){this.canAdd(a.id)&&(c=a.id)},this):this.canAdd(e.id)&&(c=e.id),c){var f=this;this.templates[c](a,function(c){var d=f.service._registerEntityView(a,c,!0),e=d.render().$el;a.id&&f.service.setElementSubject(a.getSubjectUri(),e);var g=b.indexOf(a);if(0===g)f.$el.prepend(e);else{var h=b.at(g-1),i=f.entityViews[h.cid];i?i.$el.after(e):f.$el.append(e)}f.findReverseRelations(a,e),f.trigger("add",d),f.entityViews[a.cid]=d,e.show()},this)}}},findReverseRelations:function(a,c){var d=this.service;c.parent("[rev]").each(function(){var c=b(this).attr("rev"),e={};e[c]=new d.vie.Collection([],{vie:d.vie,predicate:c});var f=d.vie.entities.get(d.getElementSubject(this));f&&e[c].addOrUpdate(f),a.set(e)})},registerItem:function(a){var b=this.service.getElementBySubject(a.id,this.el);if(b){var c=this.service._registerEntityView(a,b);this.entityViews[a.cid]=c}},removeItem:function(a){this.entityViews[a.cid]&&(this.trigger("remove",this.entityViews[a.cid]),b(this.entityViews[a.cid].el).remove(),delete this.entityViews[a.cid])},refreshItems:function(a){d.each(this.entityViews,function(a){b(a.el).remove()}),this.entityViews={},a.forEach(function(b){this.addItem(b,a)},this)}}),e.prototype.view||(e.prototype.view={}),e.prototype.view.Entity=c.View.extend({initialize:function(a){this.service=a.service?a.service:"rdfa",this.vie=a.vie,this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"change:@subject",this.renderAbout)},render:function(){return this.vie.save({element:this.el,entity:this.model}).to(this.service).execute(),this},renderAbout:function(){this.vie.service(this.service).setElementSubject(this.model.getSubjectUri(),this.el)}});var a=this;!function(b){a.XDomainRequest&&b.ajaxTransport(function(a){if(a.crossDomain&&a.async){a.timeout&&(a.xdrTimeout=a.timeout,delete a.timeout);var c;return{send:function(d,e){function f(a,d,f,g){c.onload=c.onerror=c.ontimeout=b.noop,c=void 0,e(a,d,f,g)}if(c=new XDomainRequest,a.dataType){var g="header_Accept="+encodeURIComponent(a.dataType)+"&header_Content-Type=text/plain";a.url=a.url+(-1===a.url.indexOf("?")?"?":"&")+g}c.open(a.type,a.url),c.onload=function(){f(200,"OK",{text:c.responseText},"Content-Type: "+c.contentType)},c.onerror=function(){f(404,"Not Found")},a.xdrTimeout&&(c.ontimeout=function(){f(0,"timeout")},c.timeout=a.xdrTimeout),c.send(a.hasContent&&a.data||null)},abort:function(){c&&(c.onerror=b.noop(),c.abort())}}}})}(b)}(this),function(a){var b=new Array,c=new Array;a.fn.doAutosize=function(b){var c=a(this).data("minwidth"),d=a(this).data("maxwidth"),e="",f=a(this),g=a("#"+a(this).data("tester_id"));if(e!==(e=f.val())){var h=e.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");g.html(h);var i=g.width(),j=i+b.comfortZone>=c?i+b.comfortZone:c,k=f.width(),l=k>j&&j>=c||j>c&&d>j;l&&f.width(j)}},a.fn.resetAutosize=function(b){var c=a(this).data("minwidth")||b.minInputWidth||a(this).width(),d=a(this).data("maxwidth")||b.maxInputWidth||a(this).closest(".tagsinput").width()-b.inputPadding,e=a(this),f=a("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:e.css("fontSize"),fontFamily:e.css("fontFamily"),fontWeight:e.css("fontWeight"),letterSpacing:e.css("letterSpacing"),whiteSpace:"nowrap"}),g=a(this).attr("id")+"_autosize_tester";!a("#"+g).length>0&&(f.attr("id",g),f.appendTo("body")),e.data("minwidth",c),e.data("maxwidth",d),e.data("tester_id",g),e.css("width",c)},a.fn.addTag=function(d,e){return e=jQuery.extend({focus:!1,callback:!0},e),this.each(function(){var f=a(this).attr("id"),g=a(this).val().split(b[f]);if(""==g[0]&&(g=new Array),d=jQuery.trim(d),e.unique){var h=a(g).tagExist(d);1==h&&a("#"+f+"_tag").addClass("not_valid")}else var h=!1;if(""!=d&&1!=h){if(a("<span>").addClass("tag").append(a("<span>").text(d).append("&nbsp;&nbsp;"),a("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return a("#"+f).removeTag(escape(d))})).insertBefore("#"+f+"_addTag"),g.push(d),a("#"+f+"_tag").val(""),e.focus?a("#"+f+"_tag").focus():a("#"+f+"_tag").blur(),a.fn.tagsInput.updateTagsField(this,g),e.callback&&c[f]&&c[f].onAddTag){var i=c[f].onAddTag;i.call(this,d)}if(c[f]&&c[f].onChange){var j=g.length,i=c[f].onChange;i.call(this,a(this),g[j-1])}}}),!1},a.fn.removeTag=function(d){return d=unescape(d),this.each(function(){var e=a(this).attr("id"),f=a(this).val().split(b[e]);for(a("#"+e+"_tagsinput .tag").remove(),str="",i=0;i<f.length;i++)f[i]!=d&&(str=str+b[e]+f[i]);if(a.fn.tagsInput.importTags(this,str),c[e]&&c[e].onRemoveTag){var g=c[e].onRemoveTag;g.call(this,d)}}),!1},a.fn.tagExist=function(b){return jQuery.inArray(b,a(this))>=0},a.fn.importTags=function(b){id=a(this).attr("id"),a("#"+id+"_tagsinput .tag").remove(),a.fn.tagsInput.importTags(this,b)},a.fn.tagsInput=function(d){var e=jQuery.extend({interactive:!0,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:!1},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12},d);return this.each(function(){e.hide&&a(this).hide();var d=a(this).attr("id"),f=jQuery.extend({pid:d,real_input:"#"+d,holder:"#"+d+"_tagsinput",input_wrapper:"#"+d+"_addTag",fake_input:"#"+d+"_tag"},e);b[d]=f.delimiter,(e.onAddTag||e.onRemoveTag||e.onChange)&&(c[d]=new Array,c[d].onAddTag=e.onAddTag,c[d].onRemoveTag=e.onRemoveTag,c[d].onChange=e.onChange);var g='<div id="'+d+'_tagsinput" class="tagsinput"><div id="'+d+'_addTag">';if(e.interactive&&(g=g+'<input id="'+d+'_tag" value="" data-default="'+e.defaultText+'" />'),g+='</div><div class="tags_clear"></div></div>',a(g).insertAfter(this),a(f.holder).css("width",e.width),a(f.holder).css("height",e.height),""!=a(f.real_input).val()&&a.fn.tagsInput.importTags(a(f.real_input),a(f.real_input).val()),e.interactive){if(a(f.fake_input).val(a(f.fake_input).attr("data-default")),a(f.fake_input).css("color",e.placeholderColor),a(f.fake_input).resetAutosize(e),a(f.holder).bind("click",f,function(b){a(b.data.fake_input).focus()}),a(f.fake_input).bind("focus",f,function(b){a(b.data.fake_input).val()==a(b.data.fake_input).attr("data-default")&&a(b.data.fake_input).val(""),a(b.data.fake_input).css("color","#000000")}),void 0!=e.autocomplete_url){autocomplete_options={source:e.autocomplete_url};for(attrname in e.autocomplete)autocomplete_options[attrname]=e.autocomplete[attrname];void 0!==jQuery.Autocompleter?(a(f.fake_input).autocomplete(e.autocomplete_url,e.autocomplete),a(f.fake_input).bind("result",f,function(b,c){c&&a("#"+d).addTag(c[0]+"",{focus:!0,unique:e.unique})})):void 0!==jQuery.ui.autocomplete&&(a(f.fake_input).autocomplete(autocomplete_options),a(f.fake_input).bind("autocompleteselect",f,function(b,c){return a(b.data.real_input).addTag(c.item.value,{focus:!0,unique:e.unique}),!1}))}else a(f.fake_input).bind("blur",f,function(b){var c=a(this).attr("data-default");return""!=a(b.data.fake_input).val()&&a(b.data.fake_input).val()!=c?b.data.minChars<=a(b.data.fake_input).val().length&&(!b.data.maxChars||b.data.maxChars>=a(b.data.fake_input).val().length)&&a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:!0,unique:e.unique}):(a(b.data.fake_input).val(a(b.data.fake_input).attr("data-default")),a(b.data.fake_input).css("color",e.placeholderColor)),!1});a(f.fake_input).bind("keypress",f,function(b){return b.which==b.data.delimiter.charCodeAt(0)||13==b.which?(b.preventDefault(),b.data.minChars<=a(b.data.fake_input).val().length&&(!b.data.maxChars||b.data.maxChars>=a(b.data.fake_input).val().length)&&a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:!0,unique:e.unique}),a(b.data.fake_input).resetAutosize(e),!1):void(b.data.autosize&&a(b.data.fake_input).doAutosize(e))}),f.removeWithBackspace&&a(f.fake_input).bind("keydown",function(b){if(8==b.keyCode&&""==a(this).val()){b.preventDefault();var c=a(this).closest(".tagsinput").find(".tag:last").text(),d=a(this).attr("id").replace(/_tag$/,"");c=c.replace(/[\s]+x$/,""),a("#"+d).removeTag(escape(c)),a(this).trigger("focus")}}),a(f.fake_input).blur(),f.unique&&a(f.fake_input).keydown(function(b){(8==b.keyCode||String.fromCharCode(b.which).match(/\w+|[,/]+/))&&a(this).removeClass("not_valid")})}return!1}),this},a.fn.tagsInput.updateTagsField=function(c,d){var e=a(c).attr("id");a(c).val(d.join(b[e]))},a.fn.tagsInput.importTags=function(d,e){a(d).val("");var f=a(d).attr("id"),g=e.split(b[f]);for(i=0;i<g.length;i++)a(d).addTag(g[i],{focus:!1,callback:!1});if(c[f]&&c[f].onChange){var h=c[f].onChange;h.call(d,d,g[i])}}}(jQuery),function(){var a,b,c,d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};f={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",enhancer:"http://fise.iks-project.eu/ontology/",dcterms:"http://purl.org/dc/terms/",rdfs:"http://www.w3.org/2000/01/rdf-schema#",skos:"http://www.w3.org/2004/02/skos/core#"},g=this,e=g.jQuery,a=g.Backbone,j=g._,d=g.VIE,i=new d,i.use(new i.StanbolService({url:"http://dev.iks-project.eu:8080",proxyDisabled:!0})),i.namespaces.add("skos",f.skos),null==(k=String.prototype).trim&&(k.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),b=function(){function a(a){this.vie=a.vie,this.logger=a.logger}return a.name="EntityCache",a.prototype._entities=function(){var a;return null!=(a=window.entityCache)?a:window.entityCache={}},a.prototype.get=function(a,b,c,d){var e,f=this;return a=a.replace(/^<|>$/g,""),this._entities()[a]&&"done"===this._entities()[a].status?"function"==typeof c&&c.apply(b,[this._entities()[a].entity]):this._entities()[a]&&"error"===this._entities()[a].status?"function"==typeof d&&d.apply(b,["error"]):this._entities()[a]||(this._entities()[a]={status:"pending",uri:a},e=this,this.vie.load({entity:a}).using("stanbol").execute().success(function(b){return j.defer(function(){var c,d;return c=f._entities()[a],d=j.detect(b,function(b){return b.getSubject()==="<"+a+">"?!0:void 0}),d?(c.entity=d,c.status="done",$(c).trigger("done",d)):(f.logger.warn("couldn''t load "+a,b),c.status="not found")})}).fail(function(b){return j.defer(function(){var c;return f.logger.error("couldn't load "+a),c=f._entities()[a],c.status="error",$(c).trigger("fail",b)})})),this._entities()[a]&&"pending"===this._entities()[a].status?$(this._entities()[a]).bind("done",function(a,d){return"function"==typeof c?c.apply(b,[d]):void 0}).bind("fail",function(a,c){return"function"==typeof c?c.apply(b,[c]):void 0}):void 0},a}(),h=function(a){var b;return b=a.substring(a.lastIndexOf("#")+1),b.substring(b.lastIndexOf("/")+1)},e.widget("IKS.annotate",{__widgetName:"IKS.annotate",options:{vie:i,vieServices:["stanbol"],autoAnalyze:!1,showTooltip:!0,debug:!1,depictionProperties:["foaf:depiction","schema:thumbnail"],labelProperties:["rdfs:label","skos:prefLabel","schema:name","foaf:name"],descriptionProperties:["rdfs:comment","skos:note","schema:description","skos:definition",{property:"skos:broader",makeLabel:function(a){var b;return b=j(a).map(function(a){return a.replace(/<.*[\/#](.*)>/,"$1").replace(/_/g,"&nbsp;")}),"Subcategory of "+b.join(", ")+"."}},{property:"dcterms:subject",makeLabel:function(a){var b;return b=j(a).map(function(a){return a.replace(/<.*[\/#](.*)>/,"$1").replace(/_/g,"&nbsp;")}),"Subject(s): "+b.join(", ")+"."}}],fallbackLanguage:"en",ns:{dbpedia:"http://dbpedia.org/ontology/",skos:"http://www.w3.org/2004/02/skos/core#"},typeFilter:null,annotationInteractionWidget:"annotationInteraction",getTypes:function(){return[{uri:""+this.ns.dbpedia+"Place",label:"Place"},{uri:""+this.ns.dbpedia+"Person",label:"Person"},{uri:""+this.ns.dbpedia+"Organisation",label:"Organisation"},{uri:""+this.ns.skos+"Concept",label:"Concept"}]},getSources:function(){return[{uri:"http://dbpedia.org/resource/",label:"dbpedia"},{uri:"http://sws.geonames.org/",label:"geonames"}]}},_create:function(){var a;return a=this,this._logger=this.options.debug?console:{info:function(){},warn:function(){},error:function(){},log:function(){}},this.entityCache=new b({vie:this.options.vie,logger:this._logger}),this.options.autoAnalyze&&this.enable(),e().tooltip||(this.options.showTooltip=!1,this._logger.warn("the used jQuery UI doesn't support tooltips, disabling.")),this._initExistingAnnotations()},_destroy:function(){return this.disable(),$(":IKS-annotationSelector",this.element).each(function(){return $(this).data().annotationSelector?$(this).annotationSelector("destroy"):void 0}),this._destroyExistingAnnotationInteractionWidgets()},enable:function(b){var d,e=this;return d=this.element,this.options.vie.analyze({element:this.element}).using(this.options.vieServices).execute().success(function(f){return j.defer(function(){var g,h,i,k,l,m,n,o,p,q;for(h=c.getEntityAnnotations(f),m=0,o=h.length;o>m;m++)if(g=h[m],l=g.get("dcterms:relation"))for(q=j.flatten([l]),n=0,p=q.length;p>n;n++)i=q[n],i instanceof a.Model||(i=g.vie.entities.get(i)),i&&j(j.flatten([i])).each(function(a){return a.setOrAdd({entityAnnotation:g.getSubject()})});else e._logger.error("For "+g.getSubject()+" dcterms:relation is not set! This makes this EntityAnnotation unusable!",g);return k=c.getTextAnnotations(f),k=e._filterByType(k),k=j(k).filter(function(a){return a.getSelectedText&&a.getSelectedText()?!0:!1}),j(k).each(function(a){return e._logger.info(a._enhancement,"confidence",a.getConfidence(),"selectedText",a.getSelectedText(),"type",a.getType(),"EntityEnhancements",a.getEntityEnhancements()),e._processTextEnhancement(a,d)}),e._trigger("success",!0),"function"==typeof b?b(!0):void 0})}).fail(function(a){return"function"==typeof b&&b(!1,a),e._trigger("error",a),e._logger.error("analyze failed",a.responseText,a)})},disable:function(){return $(":IKS-annotationSelector",this.element).each(function(){return $(this).data().annotationSelector?$(this).annotationSelector("disable"):void 0})},_initExistingAnnotations:function(){return this.existingAnnotations=e("a[resource]",this.element),this._logger.info(this.existingAnnotations),this.existingAnnotations[this.options.annotationInteractionWidget](this.options)},_destroyExistingAnnotationInteractionWidgets:function(){return this.existingAnnotations[this.options.annotationInteractionWidget]("destroy"),this.existingAnnotations=[]},acceptAll:function(a){var b;return b={updated:[],accepted:0},$(":IKS-annotationSelector",this.element).each(function(){var a;return $(this).data().annotationSelector&&(a=$(this).annotationSelector("acceptBestCandidate"))?(b.updated.push(this),b.accepted++):void 0}),a(b)},_processTextEnhancement:function(a,b){var c,d,e,f,g,i,j,k,l,m,n,o,p=this;if(!a.getSelectedText())return void this._logger.warn("textEnh",a,"doesn't have selected-text!");for(e=$(this._getOrCreateDomElement(b[0],a.getSelectedText(),{createElement:"span",createMode:"existing",context:a.getContext(),start:a.getStart(),end:a.getEnd()})),g=a.getType()||"Other",j=this,e.addClass("entity"),k=0,m=g.length;m>k;k++)i=g[k],e.addClass(h(i).toLowerCase());for(a.getEntityEnhancements().length&&e.addClass("withSuggestions"),o=a.getEntityEnhancements(),l=0,n=o.length;n>l;l++)c=o[l],d=c.getUri(),this.entityCache.get(d,c,function(a){return"<"+d+">"===a.getSubject()?p._logger.info("entity "+d+" is loaded:",a.as("JSON")):j._logger.info("forwarded entity for "+d+" loaded:",a.getSubject())
});return f=this.options,f.cache=this.entityCache,f.annotateElement=this.element,e.annotationSelector(f).annotationSelector("addTextEnhancement",a)},_filterByType:function(a){var b=this;return this.options.typeFilter?j.filter(a,function(a){var c,d,e,f,g;if(f=b.options.typeFilter,l.call(a.getType(),f)>=0)return!0;for(g=b.options.typeFilter,d=0,e=g.length;e>d;d++)if(c=g[d],l.call(a.getType(),c)>=0)return!0}):a},_getOrCreateDomElement:function(a,b,c){var d,e,f,g,h,i,k,l,m,n;if(null==c&&(c={}),i=function(a,b){var c,d,e,f;for(e=[],c=0,f=[];-1!==a.indexOf(b,c+1);)d=a.indexOf(b,c+1),e.push(d),f.push(c=d);return f},f=function(a,b){return j(a).sortedIndex(b)},g=function(a,b,c){var d,e,g,h,j;return d=i(a,b),j=f(d,c),1===d.length?d[0]:j===d.length?d[j-1]:(h=j-1,e=c-d[h],g=d[j]-c,g>e?d[h]:d[j])},d=a,m=function(a){return $(a).text().replace(/\n/g," ")},-1===m(a).indexOf(b))return this._logger.error("'"+b+"' doesn't appear in the text block."),$();for(l=c.start+m(a).indexOf(m(a).trim()),l=g(m(a),b,l),k=0;-1!==m(d).indexOf(b)&&"#text"!==d.nodeName;)d=j(d.childNodes).detect(function(a){var c;return c=m(a).lastIndexOf(b),c>=l-k?!0:(k+=m(a).length,!1)});return"existing"===c.createMode&&m($(d).parent())===b?$(d).parent()[0]:(k=l-k,e=b.length,n=m(d).substring(k,k+e),n===b?(d.splitText(k+e),h=document.createElement(c.createElement||"span"),h.innerHTML=b,$(d).parent()[0].replaceChild(h,d.splitText(k)),$(h)):this._logger.warn("dom element creation problem: "+n+" isnt "+b))}}),e.widget("IKS.annotationInteraction",{__widgetName:"IKS.annotationInteraction",options:{ns:{dbpedia:"http://dbpedia.org/ontology/",skos:"http://www.w3.org/2004/02/skos/core#"},getTypes:function(){return[{uri:""+this.ns.dbpedia+"Place",label:"Place"},{uri:""+this.ns.dbpedia+"Person",label:"Person"},{uri:""+this.ns.dbpedia+"Organisation",label:"Organisation"},{uri:""+this.ns.skos+"Concept",label:"Concept"}]},getSources:function(){return[{uri:"http://dbpedia.org/resource/",label:"dbpedia"},{uri:"http://sws.geonames.org/",label:"geonames"}]}},_create:function(){var a=this;return this._logger=this.options.debug?console:{info:function(){},warn:function(){},error:function(){},log:function(){}},this.vie=this.options.vie,this._loadEntity(function(b){return a.entity=b,a._initTooltip()})},_destroy:function(){return this.element.tooltip("destroy")},_initTooltip:function(){var a,b=this;return a=this,this._logger.info("init tooltip for",this.element),this.options.showTooltip?e(this.element).tooltip({items:"[resource]",hide:{effect:"hide",delay:50},show:{effect:"show",delay:50},content:function(){var c;return c=b.element.attr("resource"),b._logger.info("tooltip uri:",c),a._createPreview(c)}}):void 0},_createPreview:function(a){var b,c,d,e;return d="",e=100,b=this._getDepiction(this.entity,e),b&&(d+="<img style='float:left;padding: 5px;width: "+e+"px' src='"+b.substring(1,b.length-1)+"'/>"),c=this._getDescription(this.entity),c||(this._logger.warn("No description found for",this.entity),c="No description found."),d+="<div style='padding 5px;width:250px;float:left;'><small>"+c+"</small></div>",this._logger.info("tooltip for "+a+": cacheEntry loaded",this.entity),d},_loadEntity:function(a){var b,c=this;return b=this.element.attr("resource"),this.vie.load({entity:b}).using("stanbol").execute().success(function(c){var d;return d=j(c).detect(function(a){return a.getSubject().replace(/^<|>$/g,"")===b}),a(d)}).fail(function(a){return c._logger.error("error getting entity from stanbol",a,entity.getSubject())})},_getUserLang:function(){var a;return a=window.navigator.language||window.navigator.userLanguage,a.split("-")[0]},_getDepiction:function(a,b){var c,d,e,f;return f=this.options.depictionProperties,d=j(f).detect(function(b){return a.get(b)?!0:void 0}),d&&(e=j([a.get(d)]).flatten())?c=j(e).detect(function(a){return a=("function"==typeof a.getSubject?a.getSubject():void 0)||a,-1!==a.indexOf("thumb")?!0:void 0}).replace(/[0-9]{2..3}px/,""+b+"px"):void 0},_getLabel:function(a){var b,c;return b=this.options.labelProperties,c=[this._getUserLang(),this.options.fallbackLanguage],d.Util.getPreferredLangForPreferredProperty(a,b,c)},_getDescription:function(a){var b,c;return b=this.options.descriptionProperties,c=[this._getUserLang(),this.options.fallbackLanguage],d.Util.getPreferredLangForPreferredProperty(a,b,c)}}),e.widget("IKS.annotationSelector",{__widgetName:"IKS.annotationSelector",options:{ns:{dbpedia:"http://dbpedia.org/ontology/",skos:"http://www.w3.org/2004/02/skos/core#"},getTypes:function(){return[{uri:""+this.ns.dbpedia+"Place",label:"Place"},{uri:""+this.ns.dbpedia+"Person",label:"Person"},{uri:""+this.ns.dbpedia+"Organisation",label:"Organisation"},{uri:""+this.ns.skos+"Concept",label:"Concept"}]},getSources:function(){return[{uri:"http://dbpedia.org/resource/",label:"dbpedia"},{uri:"http://sws.geonames.org/",label:"geonames"}]}},_create:function(){var a=this;return this.enableEditing(),this._logger=this.options.debug?console:{info:function(){},warn:function(){},error:function(){},log:function(){}},this.isAnnotated()?(this._initTooltip(),this.linkedEntity={uri:this.element.attr("resource")},this.options.cache.get(this.linkedEntity.uri,this,function(b){var c,e;return c=window.navigator.language||window.navigator.userLanguage,e=c.split("-")[0],a.linkedEntity.label=d.Util.getPreferredLangForPreferredProperty(b,["skos:prefLabel","rdfs:label"],[e,"en"])})):void 0},enableEditing:function(){var a=this;return this.element.click(function(b){return a._logger.log("click",b,b.isDefaultPrevented()),!a.dialog&&a.dialog?a.searchEntryField.find(".search").focus(100):(a._createDialog(),setTimeout(function(){return a.dialog.open()},220),a.entityEnhancements=a._getEntityEnhancements(),a._createSearchbox(),a.entityEnhancements.length>0?a._createMenu():void 0)})},disableEditing:function(){return e(this.element).unbind("click")},_destroy:function(){return this.disableEditing(),this.menu&&(this.menu.destroy(),this.menu.element.remove(),delete this.menu),this.dialog&&(this.dialog.destroy(),this.dialog.element.remove(),this.dialog.uiDialogTitlebar.remove(),delete this.dialog),this._logger.info("destroy tooltip"),this.element.data().tooltip?this.element.tooltip("destroy"):void 0},remove:function(a){var b;return b=this.element.parent(),this._logger.info("destroy tooltip"),this.element.data().tooltip&&this.element.tooltip("destroy"),!this.isAnnotated()&&this.textEnhancements?this._trigger("decline",a,{textEnhancements:this.textEnhancements}):this._trigger("remove",a,{textEnhancement:this._acceptedTextEnhancement,entityEnhancement:this._acceptedEntityEnhancement,linkedEntity:this.linkedEntity}),this.destroy(),"#text"!==this.element.qname().name?this.element.replaceWith(document.createTextNode(this.element.text())):void 0},disable:function(){return this.isAnnotated()||"#text"===this.element.qname().name?this.disableEditing():this.element.replaceWith(document.createTextNode(this.element.text()))},isAnnotated:function(){return this.element.attr("resource")?!0:!1},annotate:function(a,b){var c,d,g,i,k,l,m,n,o,p,q,r,s;for(i=a.getUri(),g=a.getTextEnhancement().getType()||"",d=this.element.html(),m=a.getTextEnhancement().getType(),m.length||(m=["Other"]),this.element.attr("xmlns:skos",f.skos),l=b.rel||"skos:related",c="entity "+h(m[0]).toLowerCase(),r=["Person","Place","Organisation"],p=0,q=r.length;q>p;p++)n=r[p],j(m).each(function(a){return-1!==a.indexOf(n)?c+=" "+n:void 0});return k=$("<a href='"+i+"'            resource='"+i+"'            rel='"+l+"'            class='"+c+"'>"+d+"</a>"),this._cloneCopyEvent(this.element[0],k[0]),this.linkedEntity={uri:i,type:g,label:a.getLabel()},this.element.replaceWith(k),this.element=k.addClass(b.styleClass),this._logger.info("created annotation in",this.element),this._updateTitle(),this._insertLink(),this._acceptedTextEnhancement=a.getTextEnhancement(),this._acceptedEntityEnhancement=a,o={linkedEntity:this.linkedEntity,textEnhancement:a.getTextEnhancement(),entityEnhancement:a},this.select(o),this._initTooltip(),e(k).annotationSelector(this.options),null!=(s=this.dialog)?s.close():void 0},select:function(a){var b;return b=new e.Event("select"),b.ui=a,this._trigger("select",b,a),e(this.options.annotateElement).trigger("annotateselect",a)},acceptBestCandidate:function(){var a;return a=this._getEntityEnhancements(),a.length&&!this.isAnnotated()?(this.annotate(a[0],{styleClass:"acknowledged"}),a[0]):void 0},addTextEnhancement:function(a){return this.options.textEnhancements=this.options.textEnhancements||[],this.options.textEnhancements.push(a),this.textEnhancements=this.options.textEnhancements},close:function(){var a;return null!=(a=this.dialog)&&"function"==typeof a.close&&a.close(),e(".ui-tooltip").remove()},_initTooltip:function(){var a,b=this;return a=this,this.options.showTooltip?(this._logger.info("init tooltip for",this.element),e(this.element).tooltip({items:"[resource]",hide:{effect:"hide",delay:50},show:{effect:"show",delay:50},content:function(c){var d;return d=b.element.attr("resource"),b._logger.info("tooltip uri:",d),a._createPreview(d,c),"loading..."}})):void 0},_getEntityEnhancements:function(){var a,b,c,d,e,f,g,h,i,k;for(a=[],h=this.textEnhancements,d=0,f=h.length;f>d;d++)for(c=h[d],i=c.getEntityEnhancements(),e=0,g=i.length;g>e;e++)b=i[e],a.push(b);return k=[],a=j(a).filter(function(a){var b;return b=a.getUri(),-1===j.indexOf(k,b)?(k.push(b),!0):!1}),j(a).sortBy(function(a){return-1*a.getConfidence()})},_typeLabels:function(a){var b,c,d;return c=this.options.getTypes(),b=j(c).map(function(a){return a.uri}),d=j.intersect(b,a),j(d).map(function(a){var b;return b=j(c).detect(function(b){return b.uri===a}),b.label})},_sourceLabel:function(a){var b,c;return a||this._logger.warn("No source"),a?(c=this.options.getSources(),b=j(c).detect(function(b){return-1!==a.indexOf(b.uri)}),b?b.label:a.split("/")[2]):""},_createDialog:function(){var a,b,c,d=this;return b=this.element.text(),e(".annotateselector-dialog-content").dialog("destroy").remove(),a=$("<div class='annotateselector-dialog-content'><span class='entity-link'></span></div>").attr("tabIndex",-1).addClass().keydown(function(a){return!a.isDefaultPrevented()&&a.keyCode&&a.keyCode===$.ui.keyCode.ESCAPE?(d.close(a),a.preventDefault()):void 0}).bind("dialogblur",function(a){return d._logger.info("dialog dialogblur"),d.close(a)}).bind("blur",function(a){return d._logger.info("dialog blur"),d.close(a)}).appendTo($("body")[0]),c=this,a.dialog({width:400,dialogClass:"annotation-selector-dialog",title:b,autoOpen:!1,open:function(){return $.data(this,"dialog").uiDialog.position({of:c.element,my:"left top",at:"left bottom",collision:"none"})}}),this.dialog=a.data("dialog"),this.dialog.uiDialogTitlebar.hide(),this._logger.info("dialog widget:",this.dialog),this.dialog.element.focus(100),window.d=this.dialog,this._insertLink(),this._updateTitle(),this._setButtons()},_insertLink:function(){return this.isAnnotated()&&this.dialog?$("Annotated: <a href='"+this.linkedEntity.uri+"' target='_blank'>            "+this.linkedEntity.label+" @ "+this._sourceLabel(this.linkedEntity.uri)+"</a><br/>").appendTo($(".entity-link",this.dialog.element)):void 0},_setButtons:function(){var a=this;return this.dialog.element.dialog("option","buttons",{rem:{text:this.isAnnotated()?"Remove":"Decline",click:function(b){return a.remove(b),a.close()}},Cancel:function(){return a.close()}})},_updateTitle:function(){var a;return this.dialog?(a=this.isAnnotated()?""+this.linkedEntity.label+" <small>@ "+this._sourceLabel(this.linkedEntity.uri)+"</small>":this.element.text(),this.dialog._setOption("title",a)):void 0},_createMenu:function(){var a,b,c,d=this;return c=this,b=$('<ul class="suggestion-menu"></ul>').appendTo(this.dialog.element),this._renderMenu(b,this.entityEnhancements),a=function(a,b){return d._logger.info("selected menu item",b.item),d.annotate(b.item.data("enhancement"),{styleClass:"acknowledged"}),d.close(a)},this.menu=b.menu({selected:a,select:a,blur:function(a,b){return d._logger.info("menu.blur()",b.item)},styleClass:"suggestion-menu"}).focus(150),this.options.showTooltip&&this.menu.tooltip({items:".ui-menu-item",hide:{effect:"hide",delay:50},show:{effect:"show",delay:50},content:function(a){var b;return b=e(this).attr("entityuri"),c._createPreview(b,a),"loading..."}}),this.menu=this.menu.data("menu")},_createPreview:function(a,b){var c,d,f=this;return d=function(c){var d,e,g,h;return g="",h=100,d=f._getDepiction(c,h),d&&(g+="<img style='float:left;padding: 5px;width: "+h+"px' src='"+d.substring(1,d.length-1)+"'/>"),e=f._getDescription(c),e||(f._logger.warn("No description found for",c),e="No description found."),g+="<div style='padding 5px;width:250px;float:left;'><small>"+e+"</small></div>",f._logger.info("tooltip for "+a+": cacheEntry loaded",c),setTimeout(function(){return b(g)},200)},c=function(c){return f._logger.error("error loading "+a,c),b("error loading entity for "+a)},e(".ui-tooltip").remove(),this.options.cache.get(a,this,d,c)},_getUserLang:function(){var a;return a=window.navigator.language||window.navigator.userLanguage,a.split("-")[0]},_getDepiction:function(a,b){var c,d,e,f;return f=this.options.depictionProperties,d=j(f).detect(function(b){return a.get(b)?!0:void 0}),d&&(e=j([a.get(d)]).flatten())?c=j(e).detect(function(a){return a=("function"==typeof a.getSubject?a.getSubject():void 0)||a,-1!==a.indexOf("thumb")?!0:void 0}).replace(/[0-9]{2..3}px/,""+b+"px"):void 0},_getLabel:function(a){var b,c;return b=this.options.labelProperties,c=[this._getUserLang(),this.options.fallbackLanguage],d.Util.getPreferredLangForPreferredProperty(a,b,c)},_getDescription:function(a){var b,c;return b=this.options.descriptionProperties,c=[this._getUserLang(),this.options.fallbackLanguage],d.Util.getPreferredLangForPreferredProperty(a,b,c)},_renderMenu:function(a,b){var c,d,e;for(b=j(b).sortBy(function(a){return-1*a.getConfidence()}),d=0,e=b.length;e>d;d++)c=b[d],this._renderItem(a,c);return this._logger.info("rendered menu for the elements",b)},_renderItem:function(a,b){var c,d,e,f,g;return e=b.getLabel().replace(/^\"|\"$/g,""),g=this._typeLabels(b.getTypes()).toString()||"Other",f=this._sourceLabel(b.getUri()),c=this.linkedEntity&&b.getUri()===this.linkedEntity.uri?" class='ui-state-active'":"",d=$("<li"+c+" entityuri='"+b.getUri()+"' resource='"+b.getUri()+"'><a>"+e+" <small>("+g+" from "+f+")</small></a></li>").data("enhancement",b).appendTo(a)},_createSearchbox:function(){var a,b,c=this;return this.searchEntryField=$('<span style="background: fff;"><label for="search">Search:</label> <input id="search" class="search"></span>').appendTo(this.dialog.element),a=this.textEnhancements[0],b=this,this.searchbox=$(".search",this.searchEntryField).vieAutocomplete({vie:i,urifield:e("#urifield"),select:function(b,d){var e;return e=d.item,e.getUri=function(){return this.key},e._tEnh=a,e.getTextEnhancement=function(){return this._tEnh},e.getLabel=function(){return this.label},c.annotate(d.item,{styleClass:"acknowledged"}),c._logger.info("autocomplete.select",b.target,d)}}),this.searchEntryField.focus(200).blur(function(){return c._dialogCloseTimeout=setTimeout(function(){return c.close()},200)}),this.entityEnhancements.length||this.isAnnotated()||setTimeout(function(){var a;return a=c.element.html(),c.searchbox.val(a),c.searchbox.autocomplete("search",a)},300),this._logger.info("show searchbox")},_cloneCopyEvent:function(a,b){return 0===e().jquery.indexOf("1.6")?this._cloneCopyEvent1_6(a,b):this._cloneCopyEvent1_7(a,b)},_cloneCopyEvent1_6:function(a,b){var c,d,f,g,h,i,j;if(1===b.nodeType&&e.hasData(a)&&(g=$.expando,i=$.data(a),c=$.data(b,i),i=i[g])){if(d=i.events,c=c[g]=e.extend({},i),d){delete c.handle,c.events={};for(j in d)for(f=0,h=d[j].length;h>f;)e.event.add(b,j+(d[j][f].namespace?".":"")+d[j][f].namespace,d[j][f],d[j][f].data),f++}return null}},_cloneCopyEvent1_7:function(a,b){var c,d,f,g,h,i;if(1===b.nodeType&&e.hasData(a)){if(i=void 0,f=void 0,g=void 0,h=e._data(a),c=e._data(b,h),d=h.events){delete c.handle,c.events={};for(i in d)for(f=0,g=d[i].length;g>f;)e.event.add(b,i+(d[i][f].namespace?".":"")+d[i][f].namespace,d[i][f],d[i][f].data),f++}return c.data?c.data=e.extend({},c.data):void 0}}}),c=null!=c?c:{},c.getTextAnnotations=function(a){var b;return b=j(a).filter(function(a){return a.isof("<"+f.enhancer+"TextAnnotation>")}),b=j(b).sortBy(function(a){var b;return a.get("enhancer:confidence")&&(b=Number(a.get("enhancer:confidence"))),-1*b}),j(b).map(function(b){return new c.TextEnhancement(b,a)})},c.getEntityAnnotations=function(a){return j(a).filter(function(a){return a.isof("<"+f.enhancer+"EntityAnnotation>")})},c.TextEnhancement=function(){function b(a,b){this._enhancement=a,this._enhList=b,this.id=this._enhancement.getSubject()}return b.name="TextEnhancement",b.prototype.getSelectedText=function(){var a;return a=this._vals("enhancer:selected-text"),"string"==typeof a?a:"object"==typeof a?a.toString():void 0},b.prototype.getConfidence=function(){return this._vals("enhancer:confidence")},b.prototype.getEntityEnhancements=function(){var a,b=this;return(a=this._enhancement.get("entityAnnotation"))?(a=j.flatten([a]),j(a).map(function(a){return new c.EntityEnhancement(a,b)})):[]},b.prototype.getType=function(){return this._uriTrim(this._vals("dcterms:type"))},b.prototype.getContext=function(){return this._vals("enhancer:selection-context")},b.prototype.getStart=function(){return Number(this._vals("enhancer:start"))},b.prototype.getEnd=function(){return Number(this._vals("enhancer:end"))},b.prototype.getOrigText=function(){var a;return a=this._vals("enhancer:extracted-from"),this._enhList[a]["http://www.semanticdesktop.org/ontologies/2007/01/19/nie#plainTextContent"][0].value},b.prototype._vals=function(a){return this._enhancement.get(a)},b.prototype._uriTrim=function(b){var c,d;return b?b instanceof a.Model||b instanceof a.Collection?(c=b,function(){var a,b,e,f;for(e=c.models,f=[],a=0,b=e.length;b>a;a++)d=e[a],f.push(d.get("@subject").replace(/^<|>$/g,""));return f}()):j(j.flatten([b])).map(function(a){return a.replace(/^<|>$/g,"")}):[]},b}(),c.EntityEnhancement=function(){function b(a,b){this._enhancement=a,this._textEnhancement=b}return b.name="EntityEnhancement",b.prototype.getLabel=function(){return this._vals("enhancer:entity-label").toString().replace(/(^\"*|\"*@..$)/g,"")},b.prototype.getUri=function(){return this._uriTrim(this._vals("enhancer:entity-reference"))[0]},b.prototype.getTextEnhancement=function(){return this._textEnhancement},b.prototype.getTypes=function(){return this._uriTrim(this._vals("enhancer:entity-type"))},b.prototype.getConfidence=function(){return Number(this._vals("enhancer:confidence"))},b.prototype._vals=function(a){var b;return b=this._enhancement.get(a),b?b.pluck?b.pluck("@subject"):b:[]},b.prototype._uriTrim=function(b){var c,d;return b?b instanceof a.Collection?(c=b,function(){var a,b,e,f;for(e=c.models,f=[],a=0,b=e.length;b>a;a++)d=e[a],f.push(d.getSubject().replace(/^<|>$/g,""));return f}()):(b instanceof a.Model&&(b=b.getSubject()),j(j.flatten([b])).map(function(a){return a.replace(/^<|>$/g,"")})):[]},b}(),i=new d,i.use(new i.StanbolService({url:"http://dev.iks-project.eu:8080",proxyDisabled:!0})),e.widget("IKS.vieAutocomplete",{options:{vie:i,select:function(){},urifield:null,field:"rdfs:label",services:"stanbol",debug:!1,depictionProperties:["foaf:depiction","schema:thumbnail"],labelProperties:["rdfs:label","skos:prefLabel","schema:name","foaf:name"],descriptionProperties:["rdfs:comment","skos:note","schema:description","skos:definition",{property:"skos:broader",makeLabel:function(a){var b;return b=j(a).map(function(a){return a.replace(/<.*[\/#](.*)>/,"$1").replace(/_/g,"&nbsp;")}),"Subcategory of "+b.join(", ")+"."}},{property:"dcterms:subject",makeLabel:function(a){var b;return b=j(a).map(function(a){return a.replace(/<.*[\/#](.*)>/,"$1").replace(/_/g,"&nbsp;")}),"Subject(s): "+b.join(", ")+"."}}],fallbackLanguage:"en",styleClass:"vie-autocomplete",getTypes:function(){return[{uri:""+this.ns.dbpedia+"Place",label:"Place"},{uri:""+this.ns.dbpedia+"Person",label:"Person"},{uri:""+this.ns.dbpedia+"Organisation",label:"Organisation"},{uri:""+this.ns.skos+"Concept",label:"Concept"}]},getSources:function(){return[{uri:"http://dbpedia.org/resource/",label:"dbpedia"},{uri:"http://sws.geonames.org/",label:"geonames"}]}},_create:function(){return this._logger=this.options.debug?console:{info:function(){},warn:function(){},error:function(){},log:function(){}},this.menuContainer=e("<span class='"+this.options.styleClass+"'/>"),this.menuContainer.appendTo("body"),this._instantiateAutocomplete()},_destroy:function(){return this.menuContainer.remove()},_instantiateAutocomplete:function(){var a,b=this;return a=this,this.element.autocomplete({source:function(b,c){var d;return a._logger.info("req:",b),d=j.flatten([a.options.labelProperties,a.options.descriptionProperties,a.options.depictionProperties]),d=j(d).map(function(a){return"object"==typeof a?a.property:a}),a.options.vie.find({term:""+b.term+(b.term.length>3?"*":""),field:a.options.field,properties:d}).using(a.options.services).execute().fail(function(b){return a._logger.error("Something wrong happened at stanbol find:",b)}).success(function(b){return j.defer(function(){var d,e;return a._logger.info("resp:",j(b).map(function(a){return a.id})),d=10,b=j(b).filter(function(a){return"http://www.iks-project.eu/ontology/rick/query/QueryResultSet"===a.getSubject().replace(/^<|>$/g,"")?!1:!0}),e=j(b.slice(0,d)).map(function(b){return{key:b.getSubject().replace(/^<|>$/g,""),label:""+a._getLabel(b)+" @ "+a._sourceLabel(b.id),value:a._getLabel(b)}}),c(e)})})},open:function(b,c){return a._logger.info("autocomplete.open",b,c),a.options.showTooltip?$(this).data().autocomplete.menu.activeMenu.tooltip({items:".ui-menu-item",hide:{effect:"hide",delay:50},show:{effect:"show",delay:50},content:function(b){var c;return c=$(this).data()["item.autocomplete"].getUri(),a._createPreview(c,b),"loading..."}}):void 0},select:function(c,d){return b.options.select(c,d),b._logger.info("autocomplete.select",c.target,d),a.options.urifield?a.options.urifield.val(d.item.key):void 0},appendTo:this.menuContainer})},_getUserLang:function(){return window.navigator.language.split("-")[0]},_getDepiction:function(a,b){var c,d,e,f;return f=this.options.depictionProperties,d=j(f).detect(function(b){return a.get(b)?!0:void 0}),d&&(e=j([a.get(d)]).flatten())?c=j(e).detect(function(a){return-1!==a.indexOf("thumb")?!0:void 0}).replace(/[0-9]{2..3}px/,""+b+"px"):void 0},_getLabel:function(a){var b,c;return b=this.options.labelProperties,c=[this._getUserLang(),this.options.fallbackLanguage],d.Util.getPreferredLangForPreferredProperty(a,b,c)},_getDescription:function(a){var b,c;return b=this.options.descriptionProperties,c=[this._getUserLang(),this.options.fallbackLanguage],d.Util.getPreferredLangForPreferredProperty(a,b,c)},_sourceLabel:function(a){var b,c;return a||this._logger.warn("No source"),a?(c=this.options.getSources(),b=j(c).detect(function(b){return-1!==a.indexOf(b.uri)}),b?b.label:a.split("/")[2]):""}})}.call(this),function(a){function b(a,b,c,d){if(!a.tag.isInline&&c.length>0)for(c.push("\n"),i=0;d>i;i++)c.push("	")}function c(d,e){var f,g=[],i=0==d.attributes.length,m=(this.name.concat(void 0==d.tag.rawAttributes?"":d.tag.rawAttributes),d.tag.render&&(0==e.allowedTags.length||a.inArray(d.tag.name,e.allowedTags)>-1)&&(0==e.removeTags.length||-1==a.inArray(d.tag.name,e.removeTags)));if(!d.isRoot&&m&&(g.push("<"),g.push(d.tag.name),a.each(d.attributes,function(){if(-1==a.inArray(this.name,e.removeAttrs)){var b=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value),c=b[2],f=b[1]||"'";"class"==this.name&&(c=a.grep(c.split(" "),function(b){return a.grep(e.allowedClasses,function(c){return c[0]==b&&(1==c.length||a.inArray(d.tag.name,c[1])>-1)}).length>0}).join(" "),f="'"),null!=c&&(c.length>0||a.inArray(this.name,d.tag.requiredAttributes)>-1)&&(g.push(" "),g.push(this.name),g.push("="),g.push(f),g.push(c),g.push(f))}})),d.tag.isSelfClosing)m&&g.push(" />"),i=!1;else if(d.tag.isNonClosing)i=!1;else{!d.isRoot&&m&&g.push(">");var f=e.formatIndent++;if(d.tag.toProtect){var o=a.htmlClean.trim(d.children.join("")).replace(/<br>/gi,"\n");g.push(o),i=0==o.length}else{for(var o=[],p=0;p<d.children.length;p++){var q=d.children[p],r=a.htmlClean.trim(n(k(q)?q:q.childrenToString()));l(q)&&p>0&&r.length>0&&(h(q)||j(d.children[p-1]))&&o.push(" "),k(q)?r.length>0&&o.push(r):(p!=d.children.length-1||"br"!=q.tag.name)&&(e.format&&b(q,e,o,f),o=o.concat(c(q,e)))}e.formatIndent--,o.length>0&&(e.format&&"\n"!=o[0]&&b(d,e,g,f),g=g.concat(o),i=!1)}!d.isRoot&&m&&(e.format&&b(d,e,g,f-1),g.push("</"),g.push(d.tag.name),g.push(">"))}return!d.tag.allowEmpty&&i?[]:g}function d(b,c,e){return e=e||1,a.inArray(b[b.length-e].tag.name,c)>-1?!0:b.length-(e+1)>0&&d(b,c,e+1)?(b.pop(),!0):!1}function e(a){return a?(this.tag=a,this.isRoot=!1):(this.tag=new g("root"),this.isRoot=!0),this.attributes=[],this.children=[],this.hasAttribute=function(a){for(var b=0;b<this.attributes.length;b++)if(this.attributes[b].name==a)return!0;return!1},this.childrenToString=function(){return this.children.join("")},this}function f(a,b){return this.name=a,this.value=b,this}function g(b,c,d,e){if(this.name=b.toLowerCase(),this.isSelfClosing=a.inArray(this.name,t)>-1,this.isNonClosing=a.inArray(this.name,u)>-1,this.isClosing=void 0!=c&&c.length>0,this.isInline=a.inArray(this.name,o)>-1,this.disallowNest=a.inArray(this.name,p)>-1,this.requiredParent=r[a.inArray(this.name,r)+1],this.allowEmpty=a.inArray(this.name,q)>-1,this.toProtect=a.inArray(this.name,s)>-1,this.rawAttributes=d,this.requiredAttributes=w[a.inArray(this.name,w)+1],e){if(e.tagAttributesCache||(e.tagAttributesCache=[]),-1==a.inArray(this.name,e.tagAttributesCache)){for(var f=v[a.inArray(this.name,v)+1].slice(0),g=0;g<e.allowedAttributes.length;g++){var h=e.allowedAttributes[g][0];(1==e.allowedAttributes[g].length||a.inArray(this.name,e.allowedAttributes[g][1])>-1)&&-1==a.inArray(h,f)&&f.push(h)}e.tagAttributesCache.push(this.name),e.tagAttributesCache.push(f)}this.allowedAttributes=e.tagAttributesCache[a.inArray(this.name,e.tagAttributesCache)+1]}return this.render=!0,this}function h(b){for(;m(b)&&b.children.length>0;)b=b.children[0];return k(b)&&b.length>0&&a.htmlClean.isWhitespace(b.charAt(0))}function j(b){for(;m(b)&&b.children.length>0;)b=b.children[b.children.length-1];return k(b)&&b.length>0&&a.htmlClean.isWhitespace(b.charAt(b.length-1))}function k(a){return a.constructor==String}function l(a){return k(a)||a.tag.isInline}function m(a){return a.constructor==e}function n(a){return a.replace(/&nbsp;|\n/g," ").replace(/\s\s+/g," ")}a.fn.htmlClean=function(b){return this.each(function(){a(this);this.value?this.value=a.htmlClean(this.value,b):this.innerHTML=a.htmlClean(this.innerHTML,b)})},a.htmlClean=function(b,h){h=a.extend({},a.htmlClean.defaults,h);var i,j=/<(\/)?(\w+:)?([\w]+)([^>]*)>/gi,l=/(\w+)=(".*?"|'.*?'|[^\s>]*)/gi,m=new e,n=[m],o=m;h.bodyOnly&&(i=/<body[^>]*>((\n|.)*)<\/body>/i.exec(b))&&(b=i[1]),b=b.concat("<xxx>");for(var p;i=j.exec(b);){var q=new g(i[3],i[1],i[4],h),r=b.substring(p,i.index);if(r.length>0){var s=o.children[o.children.length-1];o.children.length>0&&k(s=o.children[o.children.length-1])?o.children[o.children.length-1]=s.concat(r):o.children.push(r)}if(p=j.lastIndex,q.isClosing)d(n,[q.name])&&(n.pop(),o=n[n.length-1]);else{for(var t,u=new e(q);t=l.exec(q.rawAttributes);){if("style"==t[1].toLowerCase()&&h.replaceStyles)for(var v=!q.isInline,w=0;w<h.replaceStyles.length;w++)h.replaceStyles[w][0].test(t[2])&&(v||(q.render=!1,v=!0),o.children.push(u),n.push(u),o=u,q=new g(h.replaceStyles[w][1],"","",h),u=new e(q));null!=q.allowedAttributes&&(0==q.allowedAttributes.length||a.inArray(t[1],q.allowedAttributes)>-1)&&u.attributes.push(new f(t[1],t[2]))}a.each(q.requiredAttributes,function(){var a=this.toString();u.hasAttribute(a)||u.attributes.push(new f(a,""))});for(var x=0;x<h.replace.length;x++)for(var y=0;y<h.replace[x][0].length;y++){var z="string"==typeof h.replace[x][0][y];if(z&&h.replace[x][0][y]==q.name||!z&&h.replace[x][0][y].test(i)){q.render=!1,o.children.push(u),n.push(u),o=u,q=new g(h.replace[x][1],i[1],i[4],h),u=new e(q),u.attributes=o.attributes,x=h.replace.length;break}}var A=!0;if(o.isRoot||(o.tag.isInline&&!q.isInline?A=!1:o.tag.disallowNest&&q.disallowNest&&!q.requiredParent?A=!1:q.requiredParent&&(A=d(n,q.requiredParent))&&(o=n[n.length-1])),A)if(o.children.push(u),q.toProtect)for(;tagMatch2=j.exec(b);){var B=new g(tagMatch2[3],tagMatch2[1],tagMatch2[4],h);if(B.isClosing&&B.name==q.name){u.children.push(RegExp.leftContext.substring(p)),p=j.lastIndex;break}}else q.isSelfClosing||q.isNonClosing||(n.push(u),o=u)}}return a.htmlClean.trim(c(m,h).join(""))},a.htmlClean.defaults={bodyOnly:!0,allowedTags:[],removeTags:["basefont","center","dir","font","frame","frameset","iframe","isindex","menu","noframes","s","strike","u"],allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:!1,formatIndent:0,replace:[[["b","big"],"strong"],[["i"],"em"]],replaceStyles:[[/font-weight:\s*bold/i,"strong"],[/font-style:\s*italic/i,"em"],[/vertical-align:\s*super/i,"sup"],[/vertical-align:\s*sub/i,"sub"]]},a.htmlClean.trim=function(b){return a.htmlClean.trimStart(a.htmlClean.trimEnd(b))},a.htmlClean.trimStart=function(b){return b.substring(a.htmlClean.trimStartIndex(b))},a.htmlClean.trimStartIndex=function(b){for(var c=0;c<b.length-1&&a.htmlClean.isWhitespace(b.charAt(c));c++);return c},a.htmlClean.trimEnd=function(b){return b.substring(0,a.htmlClean.trimEndIndex(b))},a.htmlClean.trimEndIndex=function(b){for(var c=b.length-1;c>=0&&a.htmlClean.isWhitespace(b.charAt(c));c--);return c+1},a.htmlClean.isWhitespace=function(b){return-1!=a.inArray(b,x)};var o=["a","abbr","acronym","address","b","big","br","button","caption","cite","code","del","em","font","hr","i","input","img","ins","label","legend","map","q","s","samp","select","small","span","strike","strong","sub","sup","tt","u","var"],p=["h1","h2","h3","h4","h5","h6","p","th","td"],q=["th","td"],r=[null,"li",["ul","ol"],"dt",["dl"],"dd",["dl"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"]],s=["script","style","pre","code"],t=["br","hr","img","link","meta"],u=["!doctype","?xml"],v=[["class"],"?xml",[],"!doctype",[],"a",["accesskey","class","href","name","title","rel","rev","type","tabindex"],"abbr",["class","title"],"acronym",["class","title"],"blockquote",["cite","class"],"button",["class","disabled","name","type","value"],"del",["cite","class","datetime"],"form",["accept","action","class","enctype","method","name"],"input",["accept","accesskey","alt","checked","class","disabled","ismap","maxlength","name","size","readonly","src","tabindex","type","usemap","value"],"img",["alt","class","height","src","width"],"ins",["cite","class","datetime"],"label",["accesskey","class","for"],"legend",["accesskey","class"],"link",["href","rel","type"],"meta",["content","http-equiv","name","scheme","charset"],"map",["name"],"optgroup",["class","disabled","label"],"option",["class","disabled","label","selected","value"],"q",["class","cite"],"script",["src","type"],"select",["class","disabled","multiple","name","size","tabindex"],"style",["type"],"table",["class","summary"],"th",["class","colspan","rowspan"],"td",["class","colspan","rowspan"],"textarea",["accesskey","class","cols","disabled","name","readonly","rows","tabindex"]],w=[[],"img",["alt"]],x=[""," ","	","\n","\r","\f"]}(jQuery),window.rangy=function(){function a(a,b){var c=typeof a[b];return c==l||!(c!=k||!a[b])||"unknown"==c}function b(a,b){return!(typeof a[b]!=k||!a[b])}function c(a,b){return typeof a[b]!=m}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&r(a,q)&&t(a,p)}function f(a){window.alert("Rangy not supported in your browser. Reason: "+a),u.initialized=!0,u.supported=!1}function g(a){var b="Rangy warning: "+a;u.config.alertOnWarn?window.alert(b):typeof window.console!=m&&typeof window.console.log!=m&&window.console.log(b)
}function h(){if(!u.initialized){var c,d=!1,g=!1;a(document,"createRange")&&(c=document.createRange(),r(c,o)&&t(c,n)&&(d=!0),c.detach());var h=b(document,"body")?document.body:document.getElementsByTagName("body")[0];h&&a(h,"createTextRange")&&(c=h.createTextRange(),e(c)&&(g=!0)),d||g||f("Neither Range nor TextRange are implemented"),u.initialized=!0,u.features={implementsDomRange:d,implementsTextRange:g};for(var i=w.concat(v),j=0,k=i.length;k>j;++j)try{i[j](u)}catch(l){b(window,"console")&&a(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",l)}}}function i(a){a=a||window,h();for(var b=0,c=x.length;c>b;++b)x[b](a)}function j(a){this.name=a,this.initialized=!1,this.supported=!1}var k="object",l="function",m="undefined",n=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],o=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],p=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],q=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],r=d(a),s=d(b),t=d(c),u={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:r,areHostObjects:s,areHostProperties:t,isTextRange:e},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};u.fail=f,u.warn=g,{}.hasOwnProperty?u.util.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}:f("hasOwnProperty not supported");var v=[],w=[];u.init=h,u.addInitListener=function(a){u.initialized?a(u):v.push(a)};var x=[];u.addCreateMissingNativeApiListener=function(a){x.push(a)},u.createMissingNativeApi=i,j.prototype.fail=function(a){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+a)},j.prototype.warn=function(a){u.warn("Module "+this.name+": "+a)},j.prototype.createError=function(a){return new Error("Error in Rangy "+this.name+" module: "+a)},u.createModule=function(a,b){var c=new j(a);u.modules[a]=c,w.push(function(a){b(a,c),c.initialized=!0,c.supported=!0})},u.requireModules=function(a){for(var b,c,d=0,e=a.length;e>d;++d){if(c=a[d],b=u.modules[c],!(b&&b instanceof j))throw new Error("Module '"+c+"' not found");if(!b.supported)throw new Error("Module '"+c+"' not supported")}};var y=!1,z=function(){y||(y=!0,u.initialized||h())};return typeof window==m?void f("No window found"):typeof document==m?void f("No document found"):(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",z,!1),a(window,"addEventListener")?window.addEventListener("load",z,!1):a(window,"attachEvent")?window.attachEvent("onload",z):f("Window does not have required addEventListener or attachEvent method"),u)}(),rangy.createModule("DomUtil",function(a,b){function c(a){var b;return typeof a.namespaceURI==z||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)b++;return b}function f(a){var b;return j(a)?a.length:(b=a.childNodes)?b.length:0}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(D(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function j(a){var b=a.nodeType;return 3==b||4==b||8==b}function k(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function l(a,b){var c=a.cloneNode(!1);return c.deleteData(0,b),a.deleteData(b,a.length-b),k(c,a),c}function m(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=z)return a.ownerDocument;if(typeof a.document!=z)return a.document;if(a.parentNode)return m(a.parentNode);throw new Error("getDocument: no document found for node")}function n(a){var b=m(a);if(typeof b.defaultView!=z)return b.defaultView;if(typeof b.parentWindow!=z)return b.parentWindow;throw new Error("Cannot get a window object for node")}function o(a){if(typeof a.contentDocument!=z)return a.contentDocument;if(typeof a.contentWindow!=z)return a.contentWindow.document;throw new Error("getIframeWindow: No Document object found for iframe element")}function p(a){if(typeof a.contentWindow!=z)return a.contentWindow;if(typeof a.contentDocument!=z)return a.contentDocument.defaultView;throw new Error("getIframeWindow: No Window object found for iframe element")}function q(a){return A.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]}function r(a){for(var b;b=a.parentNode;)a=b;return a}function s(a,b,c,d){var f,h,j,k,l;if(a==c)return b===d?0:d>b?-1:1;if(f=i(c,a,!0))return b<=e(f)?-1:1;if(f=i(a,c,!0))return e(f)<d?-1:1;if(h=g(a,c),j=a===h?h:i(a,h,!0),k=c===h?h:i(c,h,!0),j===k)throw new Error("comparePoints got to case 4 and childA and childB are the same!");for(l=h.firstChild;l;){if(l===j)return-1;if(l===k)return 1;l=l.nextSibling}throw new Error("Should not be here!")}function t(a){for(var b,c=m(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function u(a){if(!a)return"[No node]";if(j(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">["+a.childNodes.length+"]"}return a.nodeName}function v(a){this.root=a,this._next=a}function w(a){return new v(a)}function x(a,b){this.node=a,this.offset=b}function y(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var z="undefined",A=a.util;A.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),A.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var B=document.createElement("div");A.areHostMethods(B,["insertBefore","appendChild","cloneNode"]||!A.areHostObjects(B,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),A.isHostProperty(B,"innerHTML")||b.fail("Element is missing innerHTML property");var C=document.createTextNode("test");A.areHostMethods(C,["splitText","deleteData","insertData","appendData","cloneNode"]||!A.areHostObjects(B,["previousSibling","nextSibling","childNodes","parentNode"])||!A.areHostProperties(C,["data"]))||b.fail("Incomplete Text Node implementation");var D=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};v.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b,c=this._current=this._next;if(this._current)if(a=c.firstChild)this._next=a;else{for(b=null;c!==this.root&&!(b=c.nextSibling);)c=c.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},x.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+u(this.node)+":"+this.offset+")]"}},y.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},y.prototype.toString=function(){return this.message},a.dom={arrayContains:D,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,getClosestAncestorIn:i,isCharacterDataNode:j,insertAfter:k,splitDataNode:l,getDocument:m,getWindow:n,getIframeWindow:p,getIframeDocument:o,getBody:q,getRootContainer:r,comparePoints:s,inspectNode:u,fragmentFromNodeChildren:t,createIterator:w,DomPosition:x},a.DOMException=y}),rangy.createModule("DomRange",function(a){function b(a,b){return 3!=a.nodeType&&(L.isAncestorOf(a,b.startContainer,!0)||L.isAncestorOf(a,b.endContainer,!0))}function c(a){return L.getDocument(a.startContainer)}function d(a,b,c){var d=a._listeners[b];if(d)for(var e=0,f=d.length;f>e;++e)d[e].call(a,{target:a,args:c})}function e(a){return new M(a.parentNode,L.getNodeIndex(a))}function f(a){return new M(a.parentNode,L.getNodeIndex(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return L.isCharacterDataNode(b)?c==b.length?L.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:L.splitDataNode(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a){for(var b,d,e,f=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(e=a.getSubtreeIterator(),d.appendChild(h(e)),e.detach(!0)),10==d.nodeType)throw new N("HIERARCHY_REQUEST_ERR");f.appendChild(d)}return f}function i(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),i(g,b,c),g.detach(!0),c.stop)return}else for(d=L.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function j(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),j(b),b.detach(!0)):a.remove()}function k(a){for(var b,d,e=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(k(d)),d.detach(!0)):a.remove(),10==b.nodeType)throw new N("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function l(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return i(new n(a,!1),function(a){e&&!d.test(a.nodeType)||f&&!c(a)||g.push(a)}),g}function m(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+L.inspectNode(a.startContainer)+":"+a.startOffset+", "+L.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function n(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&L.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||L.isCharacterDataNode(this.sc)?L.getClosestAncestorIn(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||L.isCharacterDataNode(this.ec)?L.getClosestAncestorIn(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function o(a){this.code=this[a],this.codeName=a,this.message="RangeException: "+this.codeName}function p(a,b,c){this.nodes=l(a,b,c),this._next=this.nodes[0],this._position=0}function q(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,L.arrayContains(a,d))return e;e=e.parentNode}return null}}function r(a,b){if(W(a,b))throw new o("INVALID_NODE_TYPE_ERR")}function s(a){if(!a.startContainer)throw new N("INVALID_STATE_ERR")}function t(a,b){if(!L.arrayContains(b,a.nodeType))throw new o("INVALID_NODE_TYPE_ERR")}function u(a,b){if(0>b||b>(L.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new N("INDEX_SIZE_ERR")}function v(a,b){if(U(a,!0)!==U(b,!0))throw new N("WRONG_DOCUMENT_ERR")}function w(a){if(V(a,!0))throw new N("NO_MODIFICATION_ALLOWED_ERR")}function x(a,b){if(!a)throw new N(b)}function y(a){return!L.arrayContains(P,a.nodeType)&&!U(a,!0)}function z(a,b){return b<=(L.isCharacterDataNode(a)?a.length:a.childNodes.length)}function A(a){return!!a.startContainer&&!!a.endContainer&&!y(a.startContainer)&&!y(a.endContainer)&&z(a.startContainer,a.startOffset)&&z(a.endContainer,a.endOffset)}function B(a){if(s(a),!A(a))throw new Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function C(){}function D(a){a.START_TO_START=ab,a.START_TO_END=bb,a.END_TO_END=cb,a.END_TO_START=db,a.NODE_BEFORE=eb,a.NODE_AFTER=fb,a.NODE_BEFORE_AND_AFTER=gb,a.NODE_INSIDE=hb}function E(a){D(a),D(a.prototype)}function F(a,b){return function(){B(this);var c,d,e=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,j=new n(this,!0);e!==h&&(c=L.getClosestAncestorIn(e,h,!0),d=f(c),e=d.node,g=d.offset),i(j,w),j.reset();var k=a(j);return j.detach(),b(this,e,g,e,g),k}}function G(c,d,g){function h(a,b){return function(c){s(this),t(c,O),t(T(c),P);var d=(a?e:f)(c);(b?i:l)(this,d.node,d.offset)}}function i(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((T(b)!=T(e)||1==L.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function l(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((T(b)!=T(e)||-1==L.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}function m(a,b,c){(b!==a.startContainer||c!==a.startOffset||b!==a.endContainer||c!==a.endOffset)&&d(a,b,c,b,c)}c.prototype=new C,a.util.extend(c.prototype,{setStart:function(a,b){s(this),r(a,!0),u(a,b),i(this,a,b)},setEnd:function(a,b){s(this),r(a,!0),u(a,b),l(this,a,b)},setStartBefore:h(!0,!0),setStartAfter:h(!1,!0),setEndBefore:h(!0,!1),setEndAfter:h(!1,!1),collapse:function(a){B(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){s(this),r(a,!0),d(this,a,0,a,L.getNodeLength(a))},selectNode:function(a){s(this),r(a,!1),t(a,O);var b=e(a),c=f(a);d(this,b.node,b.offset,c.node,c.offset)},extractContents:F(k,d),deleteContents:F(j,d),canSurroundContents:function(){B(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},detach:function(){g(this)},splitBoundaries:function(){B(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=a===c;L.isCharacterDataNode(c)&&e>0&&e<c.length&&L.splitDataNode(c,e),L.isCharacterDataNode(a)&&b>0&&b<a.length&&(a=L.splitDataNode(a,b),f?(e-=b,c=a):c==a.parentNode&&e>=L.getNodeIndex(a)&&e++,b=0),d(this,a,b,c,e)},normalizeBoundaries:function(){B(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,e=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},g=function(d){var f=d.previousSibling;if(f&&f.nodeType==d.nodeType){a=d;var g=d.length;if(b=f.length,d.insertData(0,f.data),f.parentNode.removeChild(f),a==c)e+=b,c=a;else if(c==d.parentNode){var h=L.getNodeIndex(d);e==h?(c=d,e=g):e>h&&e--}}},h=!0;if(L.isCharacterDataNode(c))c.length==e&&f(c);else{if(e>0){var i=c.childNodes[e-1];i&&L.isCharacterDataNode(i)&&f(i)}h=!this.collapsed}if(h){if(L.isCharacterDataNode(a))0==b&&g(a);else if(b<a.childNodes.length){var j=a.childNodes[b];j&&L.isCharacterDataNode(j)&&g(j)}}else a=c,b=e;d(this,a,b,c,e)},collapseToPoint:function(a,b){s(this),r(a,!0),u(a,b),m(this,a,b)}}),E(c)}function H(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:L.getCommonAncestor(a.startContainer,a.endContainer)}function I(a,b,c,e,f){var g=a.startContainer!==b||a.startOffset!==c,h=a.endContainer!==e||a.endOffset!==f;a.startContainer=b,a.startOffset=c,a.endContainer=e,a.endOffset=f,H(a),d(a,"boundarychange",{startMoved:g,endMoved:h})}function J(a){s(a),a.startContainer=a.startOffset=a.endContainer=a.endOffset=null,a.collapsed=a.commonAncestorContainer=null,d(a,"detach",null),a._listeners=null}function K(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},H(this)}a.requireModules(["DomUtil"]);var L=a.dom,M=L.DomPosition,N=a.DOMException;n.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,L.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!L.isCharacterDataNode(c)||c!==this.sc&&c!==this.ec?c.parentNode&&c.parentNode.removeChild(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return b(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new K(c(this.range));var b=this._current,d=b,e=0,f=b,g=L.getNodeLength(b);L.isAncestorOf(b,this.sc,!0)&&(d=this.sc,e=this.so),L.isAncestorOf(b,this.ec,!0)&&(f=this.ec,g=this.eo),I(a,d,e,f,g)}return new n(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},o.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},o.prototype.toString=function(){return this.message},p.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var O=[1,3,4,5,7,8,10],P=[2,9,11],Q=[5,6,10,12],R=[1,3,4,5,7,8,10,11],S=[1,3,4,5,7,8],T=L.getRootContainer,U=q([9,11]),V=q(Q),W=q([6,10,12]),X=document.createElement("style"),Y=!1;try{X.innerHTML="<b>x</b>",Y=3==X.firstChild.nodeType}catch(Z){}a.features.htmlParsingConforms=Y;var $=Y?function(a){var b=this.startContainer,c=L.getDocument(b);if(!b)throw new N("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:L.isCharacterDataNode(b)&&(d=L.parentElement(b)),d=null===d||"HTML"==d.nodeName&&L.isHtmlNamespace(L.getDocument(d).documentElement)&&L.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,L.fragmentFromNodeChildren(d)}:function(a){s(this);var b=c(this),d=b.createElement("body");return d.innerHTML=a,L.fragmentFromNodeChildren(d)},_=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ab=0,bb=1,cb=2,db=3,eb=0,fb=1,gb=2,hb=3;C.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){B(this),v(this.startContainer,b.startContainer);var c,d,e,f,g=a==db||a==ab?"start":"end",h=a==bb||a==ab?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],L.comparePoints(c,d,e,f)},insertNode:function(a){if(B(this),t(a,R),w(this.startContainer),L.isAncestorOf(a,this.startContainer,!0))throw new N("HIERARCHY_REQUEST_ERR");var b=g(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){B(this);var a,b;if(this.collapsed)return c(this).createDocumentFragment();if(this.startContainer===this.endContainer&&L.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b;var d=new n(this,!0);return a=h(d),d.detach(),a},canSurroundContents:function(){B(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(t(a,S),!this.canSurroundContents())throw new o("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){B(this);for(var a,b=new K(c(this)),d=_.length;d--;)a=_[d],b[a]=this[a];return b},toString:function(){B(this);var a=this.startContainer;if(a===this.endContainer&&L.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new n(this,!0);return i(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){B(this);var b=a.parentNode,c=L.getNodeIndex(a);if(!b)throw new N("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?gb:eb:e>0?fb:hb},comparePoint:function(a,b){return B(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),L.comparePoints(a,b,this.startContainer,this.startOffset)<0?-1:L.comparePoints(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:$,toHtml:function(){B(this);var a=c(this).createElement("div");return a.appendChild(this.cloneContents()),a.innerHTML},intersectsNode:function(a,b){if(B(this),x(a,"NOT_FOUND_ERR"),L.getDocument(a)!==c(this))return!1;var d=a.parentNode,e=L.getNodeIndex(a);x(d,"NOT_FOUND_ERR");var f=L.comparePoints(d,e,this.endContainer,this.endOffset),g=L.comparePoints(d,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return B(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),L.comparePoints(a,b,this.startContainer,this.startOffset)>=0&&L.comparePoints(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a,b){if(B(this),c(a)!=c(this))throw new N("WRONG_DOCUMENT_ERR");var d=L.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),e=L.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);return b?0>=d&&e>=0:0>d&&e>0},intersection:function(a){if(this.intersectsRange(a)){var b=L.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=L.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();return-1==L.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==L.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new o("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==hb},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,L.getNodeLength(a))<=0},containsRange:function(a){return this.intersection(a).equals(a)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();b.setEnd(d,d.length);var e=this.containsRange(b);return b.detach(),e}return this.containsNodeContents(a)},createNodeIterator:function(a,b){return B(this),new p(this,a,b)},getNodes:function(a,b){return B(this),l(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){s(this),this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){s(this),this.setStartAfter(a),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return K.rangesEqual(this,a)},isValid:function(){return A(this)},inspect:function(){return m(this)}},G(K,I,J),a.rangePrototype=C.prototype,K.rangeProperties=_,K.RangeIterator=n,K.copyComparisonConstants=E,K.createPrototypeRange=G,K.inspect=m,K.getRangeDocument=c,K.rangesEqual=function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset},a.DomRange=K,a.RangeException=o}),rangy.createModule("WrappedRange",function(a){function b(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var e=c.parentElement(),f=d==e?d:g.getCommonAncestor(d,e);return f==b?f:g.getCommonAncestor(b,f)}function c(a){return 0==a.compareEndPoints("StartToEnd",a)}function d(a,b,c,d){var e=a.duplicate();e.collapse(c);var f=e.parentElement();if(g.isAncestorOf(b,f,!0)||(f=b),!f.canHaveHTML)return new h(f.parentNode,g.getNodeIndex(f));var i,j,k,l,m,n=g.getDocument(f).createElement("span"),o=c?"StartToStart":"StartToEnd";do f.insertBefore(n,n.previousSibling),e.moveToElementText(n);while((i=e.compareEndPoints(o,a))>0&&n.previousSibling);if(m=n.nextSibling,-1==i&&m&&g.isCharacterDataNode(m)){e.setEndPoint(c?"EndToStart":"EndToEnd",a);var p;if(/[\r\n]/.test(m.data)){var q=e.duplicate(),r=q.text.replace(/\r\n/g,"\r").length;for(p=q.moveStart("character",r);-1==(i=q.compareEndPoints("StartToEnd",q));)p++,q.moveStart("character",1)}else p=e.text.length;l=new h(m,p)}else j=(d||!c)&&n.previousSibling,k=(d||c)&&n.nextSibling,l=k&&g.isCharacterDataNode(k)?new h(k,0):j&&g.isCharacterDataNode(j)?new h(j,j.length):new h(f,g.getNodeIndex(n));return n.parentNode.removeChild(n),l}function e(a,b){var c,d,e,f,h=a.offset,i=g.getDocument(a.node),j=i.body.createTextRange(),k=g.isCharacterDataNode(a.node);return k?(c=a.node,d=c.parentNode):(f=a.node.childNodes,c=h<f.length?f[h]:null,d=a.node),e=i.createElement("span"),e.innerHTML="&#feff;",c?d.insertBefore(e,c):d.appendChild(e),j.moveToElementText(e),j.collapse(!b),d.removeChild(e),k&&j[b?"moveStart":"moveEnd"]("character",h),j}a.requireModules(["DomUtil","DomRange"]);var f,g=a.dom,h=g.DomPosition,i=a.DomRange;if(!a.features.implementsDomRange||a.features.implementsTextRange&&a.config.preferTextRange){if(a.features.implementsTextRange){f=function(a){this.textRange=a,this.refresh()},f.prototype=new i(document),f.prototype.refresh=function(){var a,e,f=b(this.textRange);c(this.textRange)?e=a=d(this.textRange,f,!0,!0):(a=d(this.textRange,f,!0,!1),e=d(this.textRange,f,!1,!1)),this.setStart(a.node,a.offset),this.setEnd(e.node,e.offset)},i.copyComparisonConstants(f);var j=function(){return this}();"undefined"==typeof j.Range&&(j.Range=f),a.createNativeRange=function(a){return a=a||document,a.body.createTextRange()}}}else!function(){function b(a){for(var b,c=k.length;c--;)b=k[c],a[b]=a.nativeRange[b]}function c(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e;(f||g)&&(a.setEnd(d,e),a.setStart(b,c))}function d(a){a.nativeRange.detach(),a.detached=!0;for(var b,c=k.length;c--;)b=k[c],a[b]=null}var e,h,j,k=i.rangeProperties;f=function(a){if(!a)throw new Error("Range must be specified");this.nativeRange=a,b(this)},i.createPrototypeRange(f,c,d),e=f.prototype,e.selectNode=function(a){this.nativeRange.selectNode(a),b(this)},e.deleteContents=function(){this.nativeRange.deleteContents(),b(this)},e.extractContents=function(){var a=this.nativeRange.extractContents();return b(this),a},e.cloneContents=function(){return this.nativeRange.cloneContents()},e.surroundContents=function(a){this.nativeRange.surroundContents(a),b(this)},e.collapse=function(a){this.nativeRange.collapse(a),b(this)},e.cloneRange=function(){return new f(this.nativeRange.cloneRange())},e.refresh=function(){b(this)},e.toString=function(){return this.nativeRange.toString()};var l=document.createTextNode("test");g.getBody(document).appendChild(l);var m=document.createRange();m.setStart(l,0),m.setEnd(l,0);try{m.setStart(l,1),h=!0,e.setStart=function(a,c){this.nativeRange.setStart(a,c),b(this)},e.setEnd=function(a,c){this.nativeRange.setEnd(a,c),b(this)},j=function(a){return function(c){this.nativeRange[a](c),b(this)}}}catch(n){h=!1,e.setStart=function(a,c){try{this.nativeRange.setStart(a,c)}catch(d){this.nativeRange.setEnd(a,c),this.nativeRange.setStart(a,c)}b(this)},e.setEnd=function(a,c){try{this.nativeRange.setEnd(a,c)}catch(d){this.nativeRange.setStart(a,c),this.nativeRange.setEnd(a,c)}b(this)},j=function(a,c){return function(d){try{this.nativeRange[a](d)}catch(e){this.nativeRange[c](d),this.nativeRange[a](d)}b(this)}}}e.setStartBefore=j("setStartBefore","setEndBefore"),e.setStartAfter=j("setStartAfter","setEndAfter"),e.setEndBefore=j("setEndBefore","setStartBefore"),e.setEndAfter=j("setEndAfter","setStartAfter"),m.selectNodeContents(l),e.selectNodeContents=m.startContainer==l&&m.endContainer==l&&0==m.startOffset&&m.endOffset==l.length?function(a){this.nativeRange.selectNodeContents(a),b(this)}:function(a){this.setStart(a,0),this.setEnd(a,i.getEndOffset(a))},m.selectNodeContents(l),m.setEnd(l,3);var o=document.createRange();o.selectNodeContents(l),o.setEnd(l,4),o.setStart(l,2),e.compareBoundaryPoints=-1==m.compareBoundaryPoints(m.START_TO_END,o)&1==m.compareBoundaryPoints(m.END_TO_START,o)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)},a.util.isHostMethod(m,"createContextualFragment")&&(e.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),g.getBody(document).removeChild(l),m.detach(),o.detach()}(),a.createNativeRange=function(a){return a=a||document,a.createRange()};a.features.implementsTextRange&&(f.rangeToTextRange=function(a){if(a.collapsed){var b=e(new h(a.startContainer,a.startOffset),!0);return b}var c=e(new h(a.startContainer,a.startOffset),!0),d=e(new h(a.endContainer,a.endOffset),!1),f=g.getDocument(a.startContainer).body.createTextRange();return f.setEndPoint("StartToStart",c),f.setEndPoint("EndToEnd",d),f}),f.prototype.getName=function(){return"WrappedRange"},a.WrappedRange=f,a.createRange=function(b){return b=b||document,new f(a.createNativeRange(b))},a.createRangyRange=function(a){return a=a||document,new i(a)},a.createIframeRange=function(b){return a.createRange(g.getIframeDocument(b))},a.createIframeRangyRange=function(b){return a.createRangyRange(g.getIframeDocument(b))},a.addCreateMissingNativeApiListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(this)}),c=b=null})}),rangy.createModule("WrappedSelection",function(a,b){function c(a){return(a||window).getSelection()}function d(a){return(a||window).document.selection}function e(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function f(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function g(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function h(b){var c;return b instanceof y?(c=b._selectionNativeRange,c||(c=a.createNativeRange(w.getDocument(b.startContainer)),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset),b._selectionNativeRange=c,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof z?c=b.nativeRange:a.features.implementsDomRange&&b instanceof w.getWindow(b.startContainer).Range&&(c=b),c}function i(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!w.isAncestorOf(a[0],a[b]))return!1;return!0}function j(a){var b=a.getNodes();if(!i(b))throw new Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}function k(a){return!!a&&"undefined"!=typeof a.text}function l(a,b){var c=new z(b);a._ranges=[c],e(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function m(b){if(b._ranges.length=0,"None"==b.docSelection.type)g(b);else{var c=b.docSelection.createRange();if(k(c))l(b,c);else{b.rangeCount=c.length;for(var d,f=w.getDocument(c.item(0)),h=0;h<b.rangeCount;++h)d=a.createRange(f),d.selectNode(c.item(h)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,e(b,b._ranges[b.rangeCount-1],!1)}}}function n(a,b){for(var c=a.docSelection.createRange(),d=j(b),e=w.getDocument(c.item(0)),f=w.getBody(e).createControlRange(),g=0,h=c.length;h>g;++g)f.add(c.item(g));try{f.add(d)}catch(i){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}f.select(),m(a)}function o(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()
}function p(a,b){for(var c,d=w.getDocument(b[0].startContainer),e=w.getBody(d).createControlRange(),f=0;rangeCount>f;++f){c=j(b[f]);try{e.add(c)}catch(g){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}e.select(),m(a)}function q(a,b){if(a.anchorNode&&w.getDocument(a.anchorNode)!==w.getDocument(b))throw new A("WRONG_DOCUMENT_ERR")}function r(a){var b=[],c=new B(a.anchorNode,a.anchorOffset),d=new B(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=y.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]),a.config.checkSelectionRanges=!0;var s,t,u="boolean",v="_rangySelection",w=a.dom,x=a.util,y=a.DomRange,z=a.WrappedRange,A=a.DOMException,B=w.DomPosition,C="Control",D=a.util.isHostMethod(window,"getSelection"),E=a.util.isHostObject(document,"selection"),F=E&&(!D||a.config.preferTextRange);F?(s=d,a.isSelectionValid=function(a){var b=(a||window).document,c=b.selection;return"None"!=c.type||w.getDocument(c.createRange().parentElement())==b}):D?(s=c,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=s;var G=s(),H=a.createNativeRange(document),I=w.getBody(document),J=x.areHostObjects(G,["anchorNode","focusNode"]&&x.areHostProperties(G,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=J;var K=x.isHostMethod(G,"extend");a.features.selectionHasExtend=K;var L="number"==typeof G.rangeCount;a.features.selectionHasRangeCount=L;var M=!1,N=!0;x.areHostMethods(G,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof G.rangeCount&&a.features.implementsDomRange&&!function(){var a=document.createElement("iframe");a.frameBorder=0,a.style.position="absolute",a.style.left="-10000px",I.appendChild(a);var b=w.getIframeDocument(a);b.open(),b.write("<html><head></head><body>12</body></html>"),b.close();var c=w.getIframeWindow(a).getSelection(),d=b.documentElement,e=d.lastChild,f=e.firstChild,g=b.createRange();g.setStart(f,1),g.collapse(!0),c.addRange(g),N=1==c.rangeCount,c.removeAllRanges();var h=g.cloneRange();g.setStart(f,0),h.setEnd(f,2),c.addRange(g),c.addRange(h),M=2==c.rangeCount,g.detach(),h.detach(),I.removeChild(a)}(),a.features.selectionSupportsMultipleRanges=M,a.features.collapsedNonEditableSelectionsSupported=N;var O,P=!1;I&&x.isHostMethod(I,"createControlRange")&&(O=I.createControlRange(),x.areHostProperties(O,["item","add"])&&(P=!0)),a.features.implementsControlRange=P,t=J?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var Q;x.isHostMethod(G,"getRangeAt")?Q=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:J&&(Q=function(b){var c=w.getDocument(b.anchorNode),d=a.createRange(c);return d.setStart(b.anchorNode,b.anchorOffset),d.setEnd(b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&(d.setStart(b.focusNode,b.focusOffset),d.setEnd(b.anchorNode,b.anchorOffset)),d}),a.getSelection=function(a){a=a||window;var b=a[v],c=s(a),e=E?d(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh(a)):(b=new o(c,e,a),a[v]=b),b},a.getIframeSelection=function(b){return a.getSelection(w.getIframeWindow(b))};var R=o.prototype;if(!F&&J&&x.areHostMethods(G,["removeAllRanges","addRange"])){R.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),g(this)};var S=function(b,c){var d=y.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.nativeSelection.addRange(h(e)),b.nativeSelection.extend(c.startContainer,c.startOffset),b.refresh()};R.addRange=L?function(b,c){if(P&&E&&this.docSelection.type==C)n(this,b);else if(c&&K)S(this,b);else{var d;if(M?d=this.rangeCount:(this.removeAllRanges(),d=0),this.nativeSelection.addRange(h(b)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==d+1){if(a.config.checkSelectionRanges){var f=Q(this.nativeSelection,this.rangeCount-1);f&&!y.rangesEqual(f,b)&&(b=new z(f))}this._ranges[this.rangeCount-1]=b,e(this,b,V(this.nativeSelection)),this.isCollapsed=t(this)}else this.refresh()}}:function(a,b){b&&K?S(this,a):(this.nativeSelection.addRange(h(a)),this.refresh())},R.setRanges=function(a){if(P&&a.length>1)p(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(x.isHostMethod(G,"empty")&&x.isHostMethod(H,"select")&&P&&F))return b.fail("No means of selecting a Range or TextRange was found"),!1;R.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=w.getDocument(this.anchorNode);else if(this.docSelection.type==C){var b=this.docSelection.createRange();b.length&&(a=w.getDocument(b.item(0)).body.createTextRange())}if(a){var c=a.body.createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}g(this)},R.addRange=function(a){this.docSelection.type==C?n(this,a):(z.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,e(this,a,!1))},R.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?p(this,a):b&&this.addRange(a[0])}}R.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new A("INDEX_SIZE_ERR");return this._ranges[a]};var T;if(F)T=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=w.getBody(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==C?m(b):k(c)?l(b,c):g(b)};else if(x.isHostMethod(G,"getRangeAt")&&"number"==typeof G.rangeCount)T=function(b){if(P&&E&&b.docSelection.type==C)m(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));e(b,b._ranges[b.rangeCount-1],V(b.nativeSelection)),b.isCollapsed=t(b)}else g(b)};else{if(!J||typeof G.isCollapsed!=u||typeof H.collapsed!=u||!a.features.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;T=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=Q(c,0),a._ranges=[b],a.rangeCount=1,f(a),a.isCollapsed=t(a)):g(a)}}R.refresh=function(a){var b=a?this._ranges.slice(0):null;if(T(this),a){var c=b.length;if(c!=this._ranges.length)return!1;for(;c--;)if(!y.rangesEqual(b[c],this._ranges[c]))return!1;return!0}};var U=function(a,b){var c=a.getAllRanges(),d=!1;a.removeAllRanges();for(var e=0,f=c.length;f>e;++e)d||b!==c[e]?a.addRange(c[e]):d=!0;a.rangeCount||g(a)};R.removeRange=P?function(a){if(this.docSelection.type==C){for(var b,c=this.docSelection.createRange(),d=j(a),e=w.getDocument(c.item(0)),f=w.getBody(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),m(this)}else U(this,a)}:function(a){U(this,a)};var V;!F&&J&&a.features.implementsDomRange?(V=function(a){var b=!1;return a.anchorNode&&(b=1==w.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b},R.isBackwards=function(){return V(this)}):V=R.isBackwards=function(){return!1},R.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},R.collapse=function(b,c){q(this,b);var d=a.createRange(w.getDocument(b));d.collapseToPoint(b,c),this.removeAllRanges(),this.addRange(d),this.isCollapsed=!0},R.collapseToStart=function(){if(!this.rangeCount)throw new A("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},R.collapseToEnd=function(){if(!this.rangeCount)throw new A("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},R.selectAllChildren=function(b){q(this,b);var c=a.createRange(w.getDocument(b));c.selectNodeContents(b),this.removeAllRanges(),this.addRange(c)},R.deleteFromDocument=function(){if(P&&E&&this.docSelection.type==C){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),a.parentNode.removeChild(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}},R.getAllRanges=function(){return this._ranges.slice(0)},R.setSingleRange=function(a){this.setRanges([a])},R.containsNode=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1},R.toHtml=function(){var a="";if(this.rangeCount){for(var b=y.getRangeDocument(this._ranges[0]).createElement("div"),c=0,d=this._ranges.length;d>c;++c)b.appendChild(this._ranges[c].cloneContents());a=b.innerHTML}return a},R.getName=function(){return"WrappedSelection"},R.inspect=function(){return r(this)},R.detach=function(){this.win[v]=null,this.win=this.anchorNode=this.focusNode=null},o.inspect=r,a.Selection=o,a.selectionPrototype=R,a.addCreateMissingNativeApiListener(function(b){"undefined"==typeof b.getSelection&&(b.getSelection=function(){return a.getSelection(this)}),b=null})}),function(){!function(a){return a.widget("IKS.hallo",{toolbar:null,bound:!1,originalContent:"",previousContent:"",uuid:"",selection:null,_keepActivated:!1,originalHref:null,options:{editable:!0,plugins:{},toolbar:"halloToolbarContextual",parentElement:"body",buttonCssClass:null,toolbarCssClass:null,toolbarPositionAbove:!1,toolbarOptions:{},placeholder:"",forceStructured:!0,checkTouch:!0,touchScreen:null},_create:function(){var b,c,d,e=this;this.id=this._generateUUID(),this.options.checkTouch&&null===this.options.touchScreen&&this.checkTouch(),d=this.options.plugins;for(c in d)b=d[c],a.isPlainObject(b)||(b={}),a.extend(b,{editable:this,uuid:this.id,buttonCssClass:this.options.buttonCssClass}),a(this.element)[c](b);return this.element.one("halloactivated",function(){return e._prepareToolbar()}),this.originalContent=this.getContents()},_init:function(){return this.options.editable?this.enable():this.disable()},destroy:function(){var b,c,d;this.disable(),this.toolbar&&(this.toolbar.remove(),this.element[this.options.toolbar]("destroy")),d=this.options.plugins;for(c in d)b=d[c],a(this.element)[c]("destroy");return a.Widget.prototype.destroy.call(this)},disable:function(){var b=this;return this.element.attr("contentEditable",!1),this.element.off("focus",this._activated),this.element.off("blur",this._deactivated),this.element.off("keyup paste change",this._checkModified),this.element.off("keyup",this._keys),this.element.off("keyup mouseup",this._checkSelection),this.bound=!1,a(this.element).removeClass("isModified"),a(this.element).removeClass("inEditMode"),this.element.parents("a").addBack().each(function(c,d){var e;return e=a(d),e.is("a")&&b.originalHref?e.attr("href",b.originalHref):void 0}),this._trigger("disabled",null)},enable:function(){var b=this;return this.element.parents("a[href]").addBack().each(function(c,d){var e;return e=a(d),e.is("a[href]")?(b.originalHref=e.attr("href"),e.removeAttr("href")):void 0}),this.element.attr("contentEditable",!0),a.parseHTML(this.element.html())||(this.element.html(this.options.placeholder),a(this.element).addClass("inPlaceholderMode"),this.element.css({"min-width":this.element.innerWidth(),"min-height":this.element.innerHeight()})),this.bound||(this.element.on("focus",this,this._activated),this.element.on("blur",this,this._deactivated),this.element.on("keyup paste change",this,this._checkModified),this.element.on("keyup",this,this._keys),this.element.on("keyup mouseup",this,this._checkSelection),this.bound=!0),this.options.forceStructured&&this._forceStructured(),this._trigger("enabled",null)},activate:function(){return this.element.focus()},containsSelection:function(){var a;return a=this.getSelection(),this.element.has(a.startContainer).length>0},getSelection:function(){var a,b;return b=rangy.getSelection(),a=null,a=b.rangeCount>0?b.getRangeAt(0):rangy.createRange()},restoreSelection:function(a){var b;return b=rangy.getSelection(),b.setSingleRange(a)},replaceSelection:function(a){var b,c,d,e,f;return"Microsoft Internet Explorer"===navigator.appName?(f=document.selection.createRange().text,c=document.selection.createRange(),c.pasteHTML(a(f))):(e=window.getSelection(),d=e.getRangeAt(0),b=document.createTextNode(a(d.extractContents())),d.insertNode(b),d.setStartAfter(b),e.removeAllRanges(),e.addRange(d))},removeAllSelections:function(){return"Microsoft Internet Explorer"===navigator.appName?range.empty():window.getSelection().removeAllRanges()},getPluginInstance:function(b){var c;if(c=a(this.element).data("IKS-"+b))return c;if(c=a(this.element).data(b))return c;throw new Error("Plugin "+b+" not found")},getContents:function(){var b,c,d;for(d in this.options.plugins)c=this.getPluginInstance(d),c&&(b=c.cleanupContentClone,a.isFunction(b)&&a(this.element)[d]("cleanupContentClone",this.element));return this.element.html()},setContents:function(a){return this.element.html(a)},isModified:function(){return this.previousContent||(this.previousContent=this.originalContent),this.previousContent!==this.getContents()},setUnmodified:function(){return a(this.element).removeClass("isModified"),this.previousContent=this.getContents()},setModified:function(){return a(this.element).addClass("isModified"),this._trigger("modified",null,{editable:this,content:this.getContents()})},restoreOriginalContent:function(){return this.element.html(this.originalContent)},execute:function(a,b){return document.execCommand(a,!1,b)?this.element.trigger("change"):void 0},protectFocusFrom:function(a){var b=this;return a.on("mousedown",function(a){return a.preventDefault(),b._protectToolbarFocus=!0,setTimeout(function(){return b._protectToolbarFocus=!1},300)})},keepActivated:function(a){this._keepActivated=a},_generateUUID:function(){var a;return a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},""+a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},_prepareToolbar:function(){var b,c,d,e,f;this.toolbar=a('<div class="hallotoolbar"></div>').hide(),this.options.toolbarCssClass&&this.toolbar.addClass(this.options.toolbarCssClass),b={editable:this,parentElement:this.options.parentElement,toolbar:this.toolbar,positionAbove:this.options.toolbarPositionAbove},f=a.extend({},b,this.options.toolbarOptions),this.element[this.options.toolbar](f);for(d in this.options.plugins)c=this.getPluginInstance(d),c&&(e=c.populateToolbar,a.isFunction(e)&&this.element[d]("populateToolbar",this.toolbar));return this.element[this.options.toolbar]("setPosition"),this.protectFocusFrom(this.toolbar)},changeToolbar:function(a,b,c){var d;return null==c&&(c=!1),d=this.options.toolbar,this.options.parentElement=a,b&&(this.options.toolbar=b),this.toolbar?(this.element[d]("destroy"),this.toolbar.remove(),this._prepareToolbar(),c?this.toolbar.hide():void 0):void 0},_checkModified:function(a){var b;return b=a.data,b.isModified()?b.setModified():void 0},_keys:function(a){var b,c;return c=a.data,27===a.keyCode?(b=c.getContents(),c.restoreOriginalContent(a),c._trigger("restored",null,{editable:c,content:c.getContents(),thrown:b}),c.turnOff()):void 0},_rangesEqual:function(a,b){return a.startContainer!==b.startContainer?!1:a.startOffset!==b.startOffset?!1:a.endContainer!==b.endContainer?!1:a.endOffset!==b.endOffset?!1:!0},_checkSelection:function(a){var b;if(27!==a.keyCode)return b=a.data,setTimeout(function(){var c;return c=b.getSelection(),b._isEmptySelection(c)||b._isEmptyRange(c)?void(b.selection&&(b.selection=null,b._trigger("unselected",null,{editable:b,originalEvent:a}))):b.selection&&b._rangesEqual(c,b.selection)?void 0:(b.selection=c.cloneRange(),b._trigger("selected",null,{editable:b,selection:b.selection,ranges:[b.selection],originalEvent:a}))},0)},_isEmptySelection:function(a){return"Caret"===a.type?!0:!1},_isEmptyRange:function(a){return a.collapsed?!0:a.isCollapsed?"function"==typeof a.isCollapsed?a.isCollapsed():a.isCollapsed:!1},turnOn:function(){return this.getContents()===this.options.placeholder&&this.setContents(""),a(this.element).removeClass("inPlaceholderMode"),a(this.element).addClass("inEditMode"),this._trigger("activated",null,this)},turnOff:function(){return a(this.element).removeClass("inEditMode"),this._trigger("deactivated",null,this),this.getContents()?void 0:(a(this.element).addClass("inPlaceholderMode"),this.setContents(this.options.placeholder))},_activated:function(a){return a.data.turnOn()},_deactivated:function(b){return b.data._keepActivated?void 0:b.data._protectToolbarFocus!==!0?b.data.turnOff():setTimeout(function(){return a(b.data.element).focus()},300)},_forceStructured:function(){var a;try{return document.execCommand("styleWithCSS",0,!1)}catch(b){a=b;try{return document.execCommand("useCSS",0,!0)}catch(b){a=b;try{return document.execCommand("styleWithCSS",!1,!1)}catch(b){a=b}}}},checkTouch:function(){return this.options.touchScreen=!!("createTouch"in document)}})}(jQuery)}.call(this),function(){!function(a){var b;return b=null,void 0!==this.VIE&&(b=new VIE,b.use(new b.StanbolService({proxyDisabled:!0,url:"http://dev.iks-project.eu:8081"}))),a.widget("IKS.halloannotate",{options:{vie:b,editable:null,toolbar:null,uuid:"",select:function(){},decline:function(){},remove:function(){},buttonCssClass:null},_create:function(){var b,c,d;if(d=this,void 0===this.options.vie)throw new Error("The halloannotate plugin requires VIE");if("function"!=typeof this.element.annotate)throw new Error("The halloannotate plugin requires annotate.js");return this.state="off",this.instantiate(),c=function(){var b;return b=this,a(b).halloannotate("turnOff")},b=this.options.editable.element,b.on("hallodisabled",c)},populateToolbar:function(b){var c,d=this;return c=a('<span class="'+this.widgetName+'"></span>'),this.button=c.hallobutton({label:"Annotate",icon:"icon-tags",editable:this.options.editable,command:null,uuid:this.options.uuid,cssClass:this.options.buttonCssClass,queryState:!1}),c.on("change",function(){return"pending"!==d.state?"off"===d.state?d.turnOn():d.turnOff():void 0}),c.buttonset(),b.append(this.button)},cleanupContentClone:function(b){return"on"===this.state?b.find(".entity:not([about])").each(function(){return a(this).replaceWith(a(this).html())}):void 0},instantiate:function(){var b;return b=this,this.options.editable.element.annotate({vie:this.options.vie,debug:!1,showTooltip:!0,select:this.options.select,remove:this.options.remove,success:this.options.success,error:this.options.error}).on("annotateselect",function(){return b.options.editable.setModified()}).on("annotateremove",function(){return a.noop()})},turnPending:function(){return this.state="pending",this.button.hallobutton("checked",!1),this.button.hallobutton("disable")},turnOn:function(){var a,b,c=this;this.turnPending(),b=this;try{return this.options.editable.element.annotate("enable",function(a){return a?(c.state="on",c.button.hallobutton("checked",!0),c.button.hallobutton("enable")):void 0})}catch(d){return a=d,alert(a)}},turnOff:function(){return this.options.editable.element.annotate("disable"),this.state="off",this.button?(this.button.attr("checked",!1),this.button.find("label").removeClass("ui-state-clicked"),this.button.button("refresh")):void 0}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloblacklist",{options:{tags:[]},_init:function(){return-1!==this.options.tags.indexOf("br")?this.element.on("keydown",function(a){return 13===a.originalEvent.keyCode?a.preventDefault():void 0}):void 0},cleanupContentClone:function(b){var c,d,e,f,g;for(f=this.options.tags,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(a(c,b).remove());return g}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloblock",{options:{editable:null,toolbar:null,uuid:"",elements:["h1","h2","h3","p","pre","blockquote"],buttonCssClass:null},populateToolbar:function(b){var c,d,e;return c=a('<span class="'+this.widgetName+'"></span>'),d=""+this.options.uuid+"-"+this.widgetName+"-data",e=this._prepareDropdown(d),b.append(c),c.hallobuttonset(),c.append(e),c.append(this._prepareButton(e))},_prepareDropdown:function(b){var c,d,e,f,g,h,i,j=this;for(e=a('<div id="'+b+'"></div>'),d=this.options.editable.element.get(0).tagName.toLowerCase(),c=function(b){var c,e,f;return c=a("<button class='blockselector'>          <"+b+' class="menu-item">'+b+"</"+b+">        </button>"),d===b&&c.addClass("selected"),"div"!==d&&c.addClass("disabled"),c.on("click",function(){var a;return a=b.toUpperCase(),c.hasClass("disabled")?void 0:"Microsoft Internet Explorer"===navigator.appName?void j.options.editable.execute("FormatBlock","<"+a+">"):j.options.editable.execute("formatBlock",a)}),f=function(){var a;return a=document.queryCommandValue("formatBlock"),a.toLowerCase()===b?void c.addClass("selected"):c.removeClass("selected")},e="keyup paste change mouseup",j.options.editable.element.on(e,f),j.options.editable.element.on("halloenabled",function(){return j.options.editable.element.on(e,f)}),j.options.editable.element.on("hallodisabled",function(){return j.options.editable.element.off(e,f)}),c},i=this.options.elements,g=0,h=i.length;h>g;g++)f=i[g],e.append(c(f));return e},_prepareButton:function(b){var c;return c=a("<span></span>"),c.hallodropdownbutton({uuid:this.options.uuid,editable:this.options.editable,label:"block",icon:"icon-text-height",target:b,cssClass:this.options.buttonCssClass}),c}})}(jQuery)}.call(this),function(){!function(a){var b;return b="The hallocleanhtml plugin requires the selection save and    restore module from Rangy",a.widget("IKS.hallocleanhtml",{_create:function(){var c,d=this;if(void 0===a.htmlClean)throw new Error("The hallocleanhtml plugin requires jQuery.htmlClean");return c=this.element,c.bind("paste",this,function(e){var f,g,h;if(void 0===rangy.saveSelection)throw new Error(b);return h=e.data,h.options.editable.getSelection().deleteContents(),g=rangy.saveSelection(),f=c.html(),c.html(""),setTimeout(function(){var b,e,i,j;if(i=c.html(),b=a.htmlClean(i,d.options),c.html(f),rangy.restoreSelection(g),""!==b)try{return document.execCommand("insertHTML",!1,b)}catch(k){return e=k,j=h.options.editable.getSelection(),j.insertNode(j.createContextualFragment(b))}},4)})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloformat",{options:{editable:null,uuid:"",formattings:{bold:!0,italic:!0,strikeThrough:!1,underline:!1},buttonCssClass:null},populateToolbar:function(b){var c,d,e,f,g,h,i=this;g=this,d=a('<span class="'+g.widgetName+'"></span>'),c=function(b){var c;return c=a("<span></span>"),c.hallobutton({label:b,editable:i.options.editable,command:b,uuid:i.options.uuid,cssClass:i.options.buttonCssClass}),d.append(c)},h=this.options.formattings;for(f in h)e=h[f],e&&c(f);return d.hallobuttonset(),b.append(d)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloheadings",{options:{editable:null,uuid:"",formatBlocks:["p","h1","h2","h3"],buttonCssClass:null},populateToolbar:function(b){var c,d,e,f,g,h,i,j,k,l=this;for(h=this,d=a('<span class="'+h.widgetName+'"></span>'),g="Microsoft Internet Explorer"===navigator.appName,e=g?"FormatBlock":"formatBlock",c=function(b){var c;return c=a("<span></span>"),c.hallobutton({label:b,editable:l.options.editable,command:e,commandValue:g?"<"+b+">":b,uuid:l.options.uuid,cssClass:l.options.buttonCssClass,queryState:function(){var a,d,f,h,i,j,k,l,m;try{if(j=document.queryCommandValue(e),g){for(f={p:"normal"},m=[1,2,3,4,5,6],k=0,l=m.length;l>k;k++)i=m[k],f["h"+i]=i;a=j.match(new RegExp(f[b],"i"))}else a=j.match(new RegExp(b,"i"));return h=a?!0:!1,c.hallobutton("checked",h)}catch(n){d=n}}}),c.find("button .ui-button-text").text(b.toUpperCase()),d.append(c)},k=this.options.formatBlocks,i=0,j=k.length;j>i;i++)f=k[i],c(f);return d.hallobuttonset(),b.append(d)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallohtml",{options:{editable:null,toolbar:null,uuid:"",lang:"en",dialogOpts:{autoOpen:!1,width:600,height:"auto",modal:!1,resizable:!0,draggable:!0,dialogClass:"htmledit-dialog"},dialog:null,buttonCssClass:null},translations:{en:{title:"Edit HTML",update:"Update"},de:{title:"HTML bearbeiten",update:"Aktualisieren"}},texts:null,populateToolbar:function(b){var c,d,e,f,g;return g=this,this.texts=this.translations[this.options.lang],this.options.toolbar=b,f=""+this.options.uuid+"-htmledit-dialog",this.options.dialog=a("<div>").attr("id",f),d=a("<span>").addClass(g.widgetName),e=""+this.options.uuid+"-htmledit",c=a("<span>"),c.hallobutton({label:this.texts.title,icon:"icon-list-alt",editable:this.options.editable,command:null,queryState:!1,uuid:this.options.uuid,cssClass:this.options.buttonCssClass}),d.append(c),this.button=c,this.button.click(function(){return g.options.dialog.dialog("isOpen")?g._closeDialog():g._openDialog(),!1}),this.options.editable.element.on("hallodeactivated",function(){return g._closeDialog()}),b.append(d),this.options.dialog.dialog(this.options.dialogOpts),this.options.dialog.dialog("option","title",this.texts.title)},_openDialog:function(){var b,c,d,e,f,g=this;return d=this,b=a(this.options.editable.element),e=b.offset().left+b.outerWidth()+10,f=this.options.toolbar.offset().top-a(document).scrollTop(),this.options.dialog.dialog("option","position",[e,f]),this.options.editable.keepActivated(!0),this.options.dialog.dialog("open"),this.options.dialog.on("dialogclose",function(){return a("label",g.button).removeClass("ui-state-active"),g.options.editable.element.focus(),g.options.editable.keepActivated(!1)}),this.options.dialog.html(a("<textarea>").addClass("html_source")),c=this.options.editable.element.html(),this.options.dialog.children(".html_source").val(c),this.options.dialog.prepend(a("<button>"+this.texts.update+"</button>")),this.options.dialog.on("click","button",function(){return c=d.options.dialog.children(".html_source").val(),d.options.editable.element.html(c),d.options.editable.element.trigger("change"),!1})},_closeDialog:function(){return this.options.dialog.dialog("close")}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloimage",{options:{editable:null,toolbar:null,uuid:"",limit:8,search:null,searchUrl:null,suggestions:null,loaded:null,upload:null,uploadUrl:null,dialogOpts:{autoOpen:!1,width:270,height:"auto",title:"Insert Images",modal:!1,resizable:!1,draggable:!0,dialogClass:"halloimage-dialog"},dialog:null,buttonCssClass:null,entity:null,vie:null,dbPediaUrl:"http://dev.iks-project.eu/stanbolfull",maxWidth:250,maxHeight:250},populateToolbar:function(b){var c,d,e,f,g,h,i;return this.options.toolbar=b,i=this,e=""+this.options.uuid+"-image-dialog",this.options.dialog=a('<div id="'+e+'">        <div class="nav">          <ul class="tabs">          </ul>          <div id="'+this.options.uuid+'-tab-activeIndicator"            class="tab-activeIndicator" />        </div>        <div class="dialogcontent">        </div>'),h=a(".tabs",this.options.dialog),g=a(".dialogcontent",this.options.dialog),i.options.suggestions&&this._addGuiTabSuggestions(h,g),(i.options.search||i.options.searchUrl)&&this._addGuiTabSearch(h,g),(i.options.upload||i.options.uploadUrl)&&this._addGuiTabUpload(h,g),this.current=a('<div class="currentImage"></div>').halloimagecurrent({uuid:this.options.uuid,imageWidget:this,editable:this.options.editable,dialog:this.options.dialog,maxWidth:this.options.maxWidth,maxHeight:this.options.maxHeight}),a(".dialogcontent",this.options.dialog).append(this.current),d=a('<span class="'+i.widgetName+'"></span>'),f=""+this.options.uuid+"-image",c=a("<span></span>"),c.hallobutton({label:"Images",icon:"icon-picture",editable:this.options.editable,command:null,queryState:!1,uuid:this.options.uuid,cssClass:this.options.buttonCssClass}),d.append(c),this.button=c,this.button.on("click",function(){return i.options.dialog.dialog("isOpen")?i._closeDialog():i._openDialog(),!1}),this.options.editable.element.on("hallodeactivated",function(){return i._closeDialog()}),a(this.options.editable.element).delegate("img","click",function(){return i._openDialog()}),b.append(d),this.options.dialog.dialog(this.options.dialogOpts),this._handleTabs()},setCurrent:function(a){return this.current.halloimagecurrent("setImage",a)},_handleTabs:function(){var b;return b=this,a(".nav li",this.options.dialog).on("click",function(){var c,d;return a("."+b.widgetName+"-tab").hide(),c=a(this).attr("id"),a("#"+c+"-content").show(),d=a(this).position().left+a(this).width()/2,a("#"+b.options.uuid+"-tab-activeIndicator").css({"margin-left":d})}),a(".nav li",this.options.dialog).first().click()},_openDialog:function(){var b,c,d,e,f,g,h,i,j=this;return g=this,b=function(){return window.setTimeout(function(){var b;return b=a(".imageThumbnail"),a(b).each(function(){var b;return b=a("#"+this.id).width(),20>=b?a("#"+this.id).parent("li").remove():void 0})},15e3)},e="#"+this.options.uuid+"-tab-suggestions-content",d=function(){return a(".imageThumbnailActive",e).first().attr("src")},a("#"+this.options.uuid+"-sugg-activeImage").attr("src",d()),a("#"+this.options.uuid+"-sugg-activeImageBg").attr("src",d()),this.lastSelection=this.options.editable.getSelection(),c=a(this.options.editable.element),f=a(this.options.toolbar),h=c.offset().left+c.outerWidth()-3,i=f.offset().top+f.outerHeight()+29,i-=a(document).scrollTop(),this.options.dialog.dialog("option","position",[h,i]),b(),g.options.loaded=1,this.options.editable.keepActivated(!0),this.options.dialog.dialog("open"),this.options.dialog.on("dialogclose",function(){return a("label",j.button).removeClass("ui-state-active"),j.options.editable.element.focus(),j.options.editable.keepActivated(!1)})},_closeDialog:function(){return this.options.dialog.dialog("close")},_addGuiTabSuggestions:function(b,c){var d;return b.append(a('<li id="'+this.options.uuid+'-tab-suggestions"        class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-suggestions">          <span>Suggestions</span>        </li>')),d=a('<div id="'+this.options.uuid+'-tab-suggestions-content"        class="'+this.widgetName+'-tab tab-suggestions"></div>'),c.append(d),d.halloimagesuggestions({uuid:this.options.uuid,imageWidget:this,entity:this.options.entity})},_addGuiTabSearch:function(b,c){var d,e,f;return f=this,d=""+this.options.uuid+"-image-dialog",b.append(a('<li id="'+this.options.uuid+'-tab-search"        class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-search">          <span>Search</span>        </li>')),e=a('<div id="'+this.options.uuid+'-tab-search-content"        class="'+f.widgetName+'-tab tab-search"></div>'),c.append(e),e.halloimagesearch({uuid:this.options.uuid,imageWidget:this,searchCallback:this.options.search,searchUrl:this.options.searchUrl,limit:this.options.limit,entity:this.options.entity})},_addGuiTabUpload:function(b,c){var d;return b.append(a('<li id="'+this.options.uuid+'-tab-upload"        class="'+this.widgetName+"-tabselector "+this.widgetName+'-tab-upload">          <span>Upload</span>        </li>')),d=a('<div id="'+this.options.uuid+'-tab-upload-content"        class="'+this.widgetName+'-tab tab-upload"></div>'),c.append(d),d.halloimageupload({uuid:this.options.uuid,uploadCallback:this.options.upload,uploadUrl:this.options.uploadUrl,imageWidget:this,entity:this.options.entity})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloimagecurrent",{options:{imageWidget:null,startPlace:"",draggables:[],maxWidth:400,maxHeight:200},_create:function(){return this.element.html('<div>        <div class="activeImageContainer">          <div class="rotationWrapper">            <div class="hintArrow"></div>              <img src="" class="activeImage" />            </div>            <img src="" class="activeImage activeImageBg" />          </div>        </div>'),this.element.hide(),this._prepareDnD()},_init:function(){var b,c;return b=a(this.options.editable.element),c=this,a("img",b).each(function(a,d){return c._initDraggable(d,b)}),a("p",b).each(function(b,d){return a(d).data("jquery_droppable_initialized")?void 0:(a(d).droppable({tolerance:"pointer",drop:function(a,b){return c._handleDropEvent(a,b)
},over:function(a,b){return c._handleOverEvent(a,b)},out:function(a,b){return c._handleLeaveEvent(a,b)}}),a(d).data("jquery_droppable_initialized",!0))})},_prepareDnD:function(){var b,c,d;return d=this,b=a(this.options.editable.element),this.options.offset=b.offset(),this.options.third=parseFloat(b.width()/3),c={width:this.options.third,height:b.height()},this.overlay={big:a("<div/>").addClass("bigOverlay").css({width:2*this.options.third,height:b.height()}),left:a("<div/>").addClass("smallOverlay smallOverlayLeft"),right:a("<div/>").addClass("smallOverlay smallOverlayRight")},this.overlay.left.css(c),this.overlay.right.css(c).css("left",2*this.options.third),b.on("halloactivated",function(){return d._enableDragging()}),b.on("hallodeactivated",function(){return d._disableDragging()})},setImage:function(b){return b?(this.element.show(),a(".activeImage",this.element).attr("src",b.url),b.label&&a("input",this.element).val(b.label),this._initImage(a(this.options.editable.element))):void 0},_delayAction:function(a,b){var c;return c=clearTimeout(c),c?void 0:c=setTimeout(a,b)},_calcDropPosition:function(a,b){var c,d;return c=a.left+this.options.third,d=a.left+2*this.options.third,b.pageX>=c&&b.pageX<=d?"middle":b.pageX<c?"left":b.pageX>d?"right":void 0},_createInsertElement:function(b,c){var d,e;return d=a("<img>"),e=new Image,a(e).on("load",function(){}),e.src=b.src,d.attr({src:e.src,alt:c?void 0:a(b).attr("alt"),"class":c?"halloTmp":"imageInText"}),d.show(),d},_createLineFeedbackElement:function(){return a("<div/>").addClass("halloTmpLine")},_removeFeedbackElements:function(){return this.overlay.big.remove(),this.overlay.left.remove(),this.overlay.right.remove(),a(".halloTmp, .halloTmpLine",this.options.editable.element).remove()},_removeCustomHelper:function(){return a(".customHelper").remove()},_showOverlay:function(b){var c,d;switch(d=a(this.options.editable.element),c=d.height(),c+=parseFloat(d.css("paddingTop")),c+=parseFloat(d.css("paddingBottom")),this.overlay.big.css({height:c}),this.overlay.left.css({height:c}),this.overlay.right.css({height:c}),b){case"left":return this.overlay.big.addClass("bigOverlayLeft"),this.overlay.big.removeClass("bigOverlayRight"),this.overlay.big.css({left:this.options.third}),this.overlay.big.show(),this.overlay.left.hide(),this.overlay.right.hide();case"middle":return this.overlay.big.removeClass("bigOverlayLeft bigOverlayRight"),this.overlay.big.hide(),this.overlay.left.show(),this.overlay.right.show();case"right":return this.overlay.big.addClass("bigOverlayRight"),this.overlay.big.removeClass("bigOverlayLeft"),this.overlay.big.css({left:0}),this.overlay.big.show(),this.overlay.left.hide(),this.overlay.right.hide()}},_checkOrigin:function(b){return 0!==a(b.target).parents("[contenteditable]").length?!0:!1},_createFeedback:function(a,b){var c;return"middle"===b?this._createLineFeedbackElement():(c=this._createInsertElement(a,!0),c.addClass("inlineImage-"+b))},_handleOverEvent:function(b,c){var d,e,f;return f=this,d=a(this.options.editable),e=function(){var e,g;return window.waitWithTrash=clearTimeout(window.waitWithTrash),e=f._calcDropPosition(f.options.offset,b),a(".trashcan",c.helper).remove(),d[0].element.append(f.overlay.big),d[0].element.append(f.overlay.left),d[0].element.append(f.overlay.right),f._removeFeedbackElements(),g=a(b.target),g.prepend(f._createFeedback(c.draggable[0],e)),"middle"===e?(g.prepend(f._createFeedback(c.draggable[0],"right")),a(".halloTmp",b.target).hide()):(g.prepend(f._createFeedback(c.draggable[0],"middle")),a(".halloTmpLine",b.target).hide()),f._showOverlay(e)},setTimeout(e,5)},_handleDragEvent:function(b){var c,d,e;return c=this._calcDropPosition(this.options.offset,b),c!==this._lastPositionDrag?(this._lastPositionDrag=c,d=a(".halloTmp",this.options.editable.element),e=a(".halloTmpLine",this.options.editable.element),"middle"===c?(e.show(),d.hide()):(e.hide(),d.removeClass("inlineImage-left inlineImage-right"),d.addClass("inlineImage-"+c),d.show()),this._showOverlay(c)):void 0},_handleLeaveEvent:function(b,c){var d;return d=function(){return a("div.trashcan",c.helper).length?void 0:(a(c.helper).append(a('<div class="trashcan"></div>')),a(".bigOverlay, .smallOverlay").remove())},window.waitWithTrash=setTimeout(d,200),this._removeFeedbackElements()},_handleStartEvent:function(b){var c;return c=this._checkOrigin(b),c&&a(b.target).remove(),a(document).trigger("startPreventSave"),this.options.startPlace=a(b.target)},_handleStopEvent:function(b){var c;return c=this._checkOrigin(b),c?a(b.target).remove():a(this.options.editable.element).trigger("change"),this.overlay.big.hide(),this.overlay.left.hide(),this.overlay.right.hide(),a(document).trigger("stopPreventSave")},_handleDropEvent:function(b,c){var d,e,f,g,h,i;return e=a(this.options.editable.element),g=this._checkOrigin(b),i=this._calcDropPosition(this.options.offset,b),this._removeFeedbackElements(),this._removeCustomHelper(),f=this._createInsertElement(c.draggable[0],!1),d="inlineImage-middle inlineImage-left inlineImage-right","middle"===i?(f.show(),f.removeClass(d),h=e.width(),h+=parseFloat(e.css("paddingLeft")),h+=parseFloat(e.css("paddingRight")),h-=f.attr("width"),f.addClass("inlineImage-"+i).css({position:"relative",left:h/2}),f.insertBefore(a(b.target))):(f.removeClass(d),f.addClass("inlineImage-"+i),f.css("display","block"),a(b.target).prepend(f)),this.overlay.big.hide(),this.overlay.left.hide(),this.overlay.right.hide(),e.trigger("change"),this._initImage(e)},_createHelper:function(b){return a("<div>").css({backgroundImage:"url("+a(b.currentTarget).attr("src")+")"}).addClass("customHelper").appendTo("body")},_initDraggable:function(b,c){var d;return d=this,b.jquery_draggable_initialized||(b.jquery_draggable_initialized=!0,a(b).draggable({cursor:"move",helper:function(a){return d._createHelper(a)},drag:function(a,b){return d._handleDragEvent(a,b)},start:function(a,b){return d._handleStartEvent(a,b)},stop:function(a,b){return d._handleStopEvent(a,b)},disabled:!c.hasClass("inEditMode"),cursorAt:{top:50,left:50}})),d.options.draggables.push(b)},_initImage:function(b){var c;return c=this,a(".rotationWrapper img",this.options.dialog).each(function(a,d){return c._initDraggable(d,b)})},_enableDragging:function(){return a.each(this.options.draggables,function(b,c){return a(c).draggable("option","disabled",!1)})},_disableDragging:function(){return a.each(this.options.draggables,function(b,c){return a(c).draggable("option","disabled",!0)})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloimagesearch",{options:{imageWidget:null,searchCallback:null,searchUrl:null,limit:5},_create:function(){return this.element.html('<div>        <form method="get">          <input type="text" class="searchInput" placeholder="Search" />          <input type="submit" class="btn searchButton" value="OK" />        </form>        <div class="searchResults imageThumbnailContainer">          <div class="activitySpinner">Loading images...</div>          <ul></ul>        </div>      </div>')},_init:function(){var b=this;return this.options.searchUrl&&!this.options.searchCallback&&(this.options.searchCallback=this._ajaxSearch),a(".activitySpinner",this.element).hide(),a("form",this.element).submit(function(c){var d;return c.preventDefault(),a(".activitySpinner",b.element).show(),d=a(".searchInput",b.element.element).val(),b.options.searchCallback(d,b.options.limit,0,function(a){return b._showResults(a)})})},_showResult:function(b){var c,d=this;return b.label||(b.label=b.alt),c=a('<li>        <img src="'+b.url+'" class="imageThumbnail"          title="'+b.label+'"></li>'),c.on("click",function(){return d.options.imageWidget.setCurrent(b)}),a("img",c).on("mousedown",function(a){return a.preventDefault(),d.options.imageWidget.setCurrent(b)}),a(".imageThumbnailContainer ul",this.element).append(c)},_showNextPrev:function(b){var c,d=this;return c=a("imageThumbnailContainer ul",this.element),c.prepend(a('<div class="pager-prev" style="display:none" />')),c.append(a('<div class="pager-next" style="display:none" />')),b.offset>0&&a(".pager-prev",c).show(),b.offset<b.total&&a(".pager-next",c).show(),a(".pager-prev",c).click(function(){var a;return a=b.offset-d.options.limit,d.options.searchCallback(query,d.options.limit,a,function(a){return d._showResults(a)})}),a(".pager-next",c).click(function(){var a;return a=b.offset+d.options.limit,d.options.searchCallback(query,d.options.limit,a,function(a){return d._showResults(a)})})},_showResults:function(b){var c,d,e,f;for(a(".activitySpinner",this.element).hide(),a(".imageThumbnailContainer ul",this.element).empty(),a(".imageThumbnailContainer ul",this.element).show(),f=b.assets,d=0,e=f.length;e>d;d++)c=f[d],this._showResult(c);return this.options.imageWidget.setCurrent(b.assets.shift()),this._showNextPrev(b)},_ajaxSearch:function(b,c,d,e){var f;return f=this.searchUrl+"?"+a.param({q:b,limit:c,offset:d}),a.getJSON(f,e)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloimagesuggestions",{loaded:!1,options:{entity:null,vie:null,dbPediaUrl:null,getSuggestions:null,thumbnailUri:"<http://dbpedia.org/ontology/thumbnail>"},_create:function(){return this.element.html('      <div id="'+this.options.uuid+'-tab-suggestions">        <div class="imageThumbnailContainer">          <div class="activitySpinner">Loading images...</div>          <ul></ul>        </div>      </div>')},_init:function(){return a(".activitySpinner",this.element).hide()},_normalizeRelated:function(a){return _.isString(a)?a:_.isArray(a)?a.join(","):a.pluck("@subject").join(",")},_prepareVIE:function(){return this.options.vie||(this.options.vie=new VIE),!this.options.vie.services.dbpedia&&this.options.dbPediaUrl?this.options.vie.use(new vie.DBPediaService({url:this.options.dbPediaUrl,proxyDisabled:!0})):void 0},_getSuggestions:function(){var b,c,d;if(!this.loaded&&this.options.entity)return a(".activitySpinner",this.element).show(),d=this.options.entity.get("skos:related"),0===d.length?void a("#activitySpinner").html("No images found."):(a(".imageThumbnailContainer ul",this.element).empty(),c=this._normalizeRelated(d),b=this.options.limit,this.options.getSuggestions&&this.options.getSuggestions(c,b,0,this._showSuggestions),this._prepareVIE(),this.options.vie.services.dbpedia&&this._getSuggestionsDbPedia(d),this.loaded=!0)},_getSuggestionsDbPedia:function(b){var c,d;return d=this,c=1,_.each(b,function(b){return vie.load({entity:b}).using("dbpedia").execute().done(function(c){return a(".activitySpinner",this.element).hide(),_.each(c,function(a){var c,e;return(e=a.attributes[d.options.thumbnailUri])?(_.isObject(e)&&(c=e[0].value),_.isString(e)&&(c=d.options.entity.fromReference(e)),d._showSuggestion({url:c,label:b})):void 0})})})},_showSuggestion:function(b){var c,d=this;return c=a('<li>        <img src="'+b.url+'" class="imageThumbnail"          title="'+b.label+'">        </li>'),c.on("click",function(){return d.options.imageWidget.setCurrent(b)}),a(".imageThumbnailContainer ul",this.element).append(c)},_showSuggestions:function(b){var c=this;return a(".activitySpinner",this.element).hide(),_.each(b,function(a){return c._showSuggestion(a)})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloimageupload",{options:{uploadCallback:null,uploadUrl:null,imageWidget:null,entity:null},_create:function(){return this.element.html('        <form class="upload">        <input type="file" class="file" name="userfile" accept="image/*" />        <input type="hidden" name="tags" value="" />        <input type="text" class="caption" name="caption" placeholder="Title" />        <button class="uploadSubmit">Upload</button>        </form>      ')},_init:function(){var b;return b=this,b.options.uploadUrl&&!b.options.uploadCallback&&(b.options.uploadCallback=b._iframeUpload),a(".uploadSubmit",this.element).on("click",function(a){return a.preventDefault(),a.stopPropagation(),b.options.uploadCallback({widget:b,success:function(a){return b.options.imageWidget.setCurrent({url:a,label:""})}})})},_prepareIframe:function(b){var c,d;return d=""+b.widgetName+"_postframe_"+b.options.uuid,d=d.replace(/-/g,"_"),c=a("#"+d),c.length?c:(c=a('<iframe name="'+d+'" id="'+d+'"        class="hidden" style="display:none" />'),this.element.append(c),c.get(0).name=d,c)},_iframeUpload:function(b){var c,d,e,f;return f=b.widget,c=f._prepareIframe(f),d=a("form.upload",f.element),e="function"==typeof f.options.uploadUrl?f.options.uploadUrl(f.options.entity):f.options.uploadUrl,c.on("load",function(){var a;return a=c.get(0).contentWindow.location.href,f.element.hide(),b.success(a)}),d.attr("action",e),d.attr("method","post"),d.attr("target",c.get(0).name),d.attr("enctype","multipart/form-data"),d.attr("encoding","multipart/form-data"),d.submit()}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallo-image-insert-edit",{options:{editable:null,toolbar:null,uuid:"",insert_file_dialog_ui_url:null,lang:"en",dialogOpts:{autoOpen:!1,width:560,height:"auto",modal:!1,resizable:!0,draggable:!0,dialogClass:"insert-image-dialog"},dialog:null,buttonCssClass:null},translations:{en:{title_insert:"Insert Image",title_properties:"Image Properties",insert:"Insert",chage_image:"Change Image:",source:"URL",width:"Width",height:"Height",alt:"Alt Text",padding:"Padding","float":"Float",float_left:"left",float_right:"right",float_none:"No"},de:{title_insert:"Bild einfgen",title_properties:"Bildeigenschaften",insert:"Einfgen",chage_image:"Bild ndern:",source:"URL",width:"Breite",height:"Hhe",alt:"Alt Text",padding:"Padding","float":"Float",float_left:"Links",float_right:"Rechts",float_none:"Nein"}},texts:null,dialog_image_selection_ui_loaded:!1,$image:null,populateToolbar:function(b){var c,d,e,f;return f=this,this.texts=this.translations[this.options.lang],this.options.toolbar=b,e="<div id='hallo_img_properties'></div>",this.options.insert_file_dialog_ui_url&&(e+="<div id='hallo_img_file_select_ui'></div>"),this.options.dialog=a("<div>").attr("id",""+this.options.uuid+"-insert-image-dialog").html(e),d=a("<span>").addClass(this.widgetName),c=a("<span>"),c.hallobutton({label:this.texts.title_insert,icon:"icon-picture",editable:this.options.editable,command:null,queryState:!1,uuid:this.options.uuid,cssClass:this.options.buttonCssClass}),d.append(c),this.button=c,this.button.click(function(){return f.options.dialog.dialog("isOpen")?f._closeDialog():(f.lastSelection=f.options.editable.getSelection(),f._openDialog()),!1}),this.options.editable.element.on("halloselected, hallounselected",function(){return f.options.dialog.dialog("isOpen")?f.lastSelection=f.options.editable.getSelection():void 0}),this.options.editable.element.on("hallodeactivated",function(){return f._closeDialog()}),a(this.options.editable.element).on("click","img",function(){return f._openDialog(a(this)),!1}),this.options.editable.element.on("halloselected",function(c,d){var e;return e=f.options.editable.options.toolbar,"halloToolbarContextual"===e&&a(d.originalEvent.target).is("img")?(b.hide(),!1):void 0}),b.append(d),this.options.dialog.dialog(this.options.dialogOpts)},_openDialog:function(b){var c,d,e,f,g=this;return this.$image=b,d=this,c=a(this.options.editable.element),e=c.offset().left+c.outerWidth()+10,f=this.$image?this.$image.offset().top-a(document).scrollTop():this.options.toolbar.offset().top-a(document).scrollTop(),this.options.dialog.dialog("option","position",[e,f]),this.options.editable.keepActivated(!0),this.options.dialog.dialog("open"),this.$image?(this.options.dialog.dialog("option","title",this.texts.title_properties),a(document).keyup(function(b){return(46===b.keyCode||8===b.keyCode)&&(a(document).off(),d._closeDialog(),d.$image.remove(),d.$image=null),b.preventDefault()}),this.options.editable.element.on("click",function(){return d.$image=null,d._closeDialog()})):(this.options.dialog.children("#hallo_img_properties").hide(),this.options.dialog.dialog("option","title",this.texts.title_insert),a("#hallo_img_file_select_title").length>0&&a("#hallo_img_file_select_title").text("")),this._load_dialog_image_properties_ui(),this.options.dialog.on("dialogclose",function(){var b;return a("label",g.button).removeClass("ui-state-active"),b=a(document).scrollTop(),g.options.editable.element.focus(),a(document).scrollTop(b),g.options.editable.keepActivated(!1)}),this.options.insert_file_dialog_ui_url&&!this.dialog_image_selection_ui_loaded?(this.options.dialog.on("click",".reload_link",function(){return d._load_dialog_image_selection_ui(),!1}),this.options.dialog.on("click",".file_preview img",function(){var b;return d.$image?(b=a(this).attr("src").replace(/-thumb/,""),d.$image.attr("src",b),a("#hallo_img_source").val(b)):d._insert_image(a(this).attr("src").replace(/-thumb/,"")),!1}),this._load_dialog_image_selection_ui()):void 0},_insert_image:function(a){return this.options.editable.restoreSelection(this.lastSelection),document.execCommand("insertImage",null,a),this.options.editable.element.trigger("change"),this.options.editable.removeAllSelections(),this._closeDialog()},_closeDialog:function(){return this.options.dialog.dialog("close")},_load_dialog_image_selection_ui:function(){var b;return b=this,a.ajax({url:this.options.insert_file_dialog_ui_url,success:function(a){var c,d,e;return d="",c=b.options.dialog.children("#hallo_img_properties"),c.is(":visible")&&(d=b.texts.change_image),e="<div id='hallo_img_file_select_title'>"+d+"</div>",b.options.dialog.children("#hallo_img_file_select_ui").html(e+a),b.dialog_image_selection_ui_loaded=!0},beforeSend:function(){return b.options.dialog.children("#hallo_img_file_select_ui").html('<div class="hallo_insert_file_loader"></div>')}})},_load_dialog_image_properties_ui:function(){var b,c,d,e,f,g;return f=this,b=this.options.dialog.children("#hallo_img_properties"),this.$image?(g=this.$image.is("[width]")?this.$image.attr("width"):"",d=this.$image.is("[height]")?this.$image.attr("height"):"",e=this._property_input_html("source",this.$image.attr("src"),{label:this.texts.source})+this._property_input_html("alt",this.$image.attr("alt")||"",{label:this.texts.alt})+this._property_row_html(this._property_input_html("width",g,{label:this.texts.width,row:!1})+this._property_input_html("height",d,{label:this.texts.height,row:!1}))+this._property_input_html("padding",this.$image.css("padding"),{label:this.texts.padding})+this._property_row_html(this._property_cb_html("float_left","left"===this.$image.css("float"),{label:this.texts.float_left,row:!1})+this._property_cb_html("float_right","right"===this.$image.css("float"),{label:this.texts.float_right,row:!1})+this._property_cb_html("unfloat","none"===this.$image.css("float"),{label:this.texts.float_none,row:!1}),this.texts[float]),b.html(e),b.show()):this.options.insert_file_dialog_ui_url||(b.html(this._property_input_html("source","",{label:this.texts.source})),b.show()),this.$image?(this.options.insert_file_dialog_ui_url||a("#insert_image_btn").remove(),a("#hallo_img_file_select_title").length>0&&a("#hallo_img_file_select_title").text(this.texts.chage_image),a("#hallo_img_properties #hallo_img_source").keyup(function(){return f.$image.attr("src",this.value)}),a("#hallo_img_properties #hallo_img_alt").keyup(function(){return f.$image.attr("alt",this.value)}),a("#hallo_img_properties #hallo_img_padding").keyup(function(){return f.$image.css("padding",this.value)}),a("#hallo_img_properties #hallo_img_height").keyup(function(){return f.$image.css("height",this.value),f.$image.attr("height",this.value)}),a("#hallo_img_properties #hallo_img_width").keyup(function(){return f.$image.css("width",this.value),f.$image.attr("width",this.value)}),a("#hallo_img_properties #hallo_img_float_left").click(function(){return this.checked?(f.$image.css("float","left"),a("#hallo_img_properties #hallo_img_float_right").removeAttr("checked"),a("#hallo_img_properties #hallo_img_unfloat").removeAttr("checked")):!1}),a("#hallo_img_properties #hallo_img_float_right").click(function(){return this.checked?(f.$image.css("float","right"),a("#hallo_img_properties #hallo_img_unfloat").removeAttr("checked"),a("#hallo_img_properties #hallo_img_float_left").removeAttr("checked")):!1}),a("#hallo_img_properties #hallo_img_unfloat").click(function(){return this.checked?(f.$image.css("float","none"),a("#hallo_img_properties #hallo_img_float_right").removeAttr("checked"),a("#hallo_img_properties #hallo_img_float_left").removeAttr("checked")):!1})):this.options.insert_file_dialog_ui_url?void 0:(c='<button id="insert_image_btn">'+this.texts.insert+"</button>",b.after(c),a("#insert_image_btn").click(function(){var b;return b=a("#hallo_img_properties #hallo_img_source"),f._insert_image(b.val())}))},_property_col_html:function(a){return"<div class='hallo_img_property_col'>"+a+"</div>"},_property_row_html:function(a,b){return null==b&&(b=""),a=this._property_col_html(b)+this._property_col_html(a),"<div class='hallo_img_property_row'>"+a+"</div>"},_property_html:function(a,b){var c;return null==b&&(b={}),b.row===!1?(b.label&&(c=""+b.label+" "+a,a="<span class='img_property_entry'>"+c+"</span>"),a):(c="<span class='img_property_entry'>"+a+"</span>",this._property_row_html(c,b.label))},_property_input_html:function(a,b,c){var d;return null==c&&(c={}),d="<input type='text' id='hallo_img_"+a+"' value='"+b+"'>",this._property_html(d,c)},_property_cb_html:function(a,b,c){var d,e;return null==c&&(c={}),e=b?"checked=checked":"",d="<input type='checkbox' id='hallo_img_"+a+"' "+e+"'>",this._property_html(d,c)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloindicator",{options:{editable:null,className:"halloEditIndicator"},_create:function(){var a=this;return this.element.on("halloenabled",function(){return a.buildIndicator()})},populateToolbar:function(){},buildIndicator:function(){var b;return b=a('<div><i class="icon-edit"></i> Edit</div>'),b.addClass(this.options.className),b.hide(),this.element.before(b),this.bindIndicator(b),this.setIndicatorPosition(b)},bindIndicator:function(b){var c=this;return b.on("click",function(){return c.options.editable.element.focus()}),this.element.on("halloactivated",function(){return b.hide()}),this.element.on("hallodisabled",function(){return b.remove()}),this.options.editable.element.hover(function(){return a(this).hasClass("inEditMode")?void 0:b.show()},function(c){return a(this).hasClass("inEditMode")||c.relatedTarget===b.get(0)?void 0:b.hide()})},setIndicatorPosition:function(a){var b;return a.css("position","absolute"),b=this.element.position(),a.css("top",b.top+2),a.css("left",b.left+2)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallojustify",{options:{editable:null,toolbar:null,uuid:"",buttonCssClass:null},populateToolbar:function(b){var c,d,e=this;return d=a('<span class="'+this.widgetName+'"></span>'),c=function(b){var c;return c=a("<span></span>"),c.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:b,command:"justify"+b,icon:"icon-align-"+b.toLowerCase(),cssClass:e.options.buttonCssClass}),d.append(c)},c("Left"),c("Center"),c("Right"),d.hallobuttonset(),b.append(d)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallolink",{options:{editable:null,uuid:"",link:!0,image:!0,defaultUrl:"http://",dialogOpts:{autoOpen:!1,width:540,height:200,title:"Enter Link",buttonTitle:"Insert",buttonUpdateTitle:"Update",modal:!0,resizable:!1,draggable:!1,dialogClass:"hallolink-dialog"},buttonCssClass:null},populateToolbar:function(b){var c,d,e,f,g,h,i,j,k,l,m=this;return l=this,h=""+this.options.uuid+"-dialog",c=this.options.dialogOpts.buttonTitle,d=this.options.dialogOpts.buttonUpdateTitle,g=a('<div id="'+h+'">        <form action="#" method="post" class="linkForm">          <input class="url" type="text" name="url"            value="'+this.options.defaultUrl+'" />          <input type="submit" id="addlinkButton" value="'+c+'"/>        </form></div>'),k=a("input[name=url]",g),j=function(a){return new RegExp(/^\s*$/).test(a)?!0:a===l.options.defaultUrl?!0:!1},i=function(b){var c,d;return b.preventDefault(),c=k.val(),g.dialog("close"),l.options.editable.restoreSelection(l.lastSelection),j(c)?document.execCommand("unlink",null,""):(/:\/\//.test(c)||/^mailto:/.test(c)||(c="http://"+c),void 0===l.lastSelection.startContainer.parentNode.href?l.lastSelection.collapsed?(d=a("<a href='"+c+"'>"+c+"</a>")[0],l.lastSelection.insertNode(d)):document.execCommand("createLink",null,c):l.lastSelection.startContainer.parentNode.href=c),l.options.editable.element.trigger("change"),!1},g.find("input[type=submit]").click(i),f=a('<span class="'+l.widgetName+'"></span>'),e=function(b){var e,h,i;return i=""+m.options.uuid+"-"+b,h=a("<span></span>"),h.hallobutton({label:"Link",icon:"icon-link",editable:m.options.editable,command:null,queryState:!1,uuid:m.options.uuid,cssClass:m.options.buttonCssClass}),f.append(h),e=h,e.on("click",function(){var b,e;return l.lastSelection=l.options.editable.getSelection(),k=a("input[name=url]",g),e=l.lastSelection.startContainer.parentNode,e.href?(k.val(a(e).attr("href")),b="input[type=submit]",a(k[0].form).find(b).val(d)):(k.val(l.options.defaultUrl),a(k[0].form).find("input[type=submit]").val(c)),l.options.editable.keepActivated(!0),g.dialog("open"),g.on("dialogclose",function(){return l.options.editable.restoreSelection(l.lastSelection),a("label",h).removeClass("ui-state-active"),l.options.editable.element.focus(),l.options.editable.keepActivated(!1)}),!1}),m.element.on("keyup paste change mouseup",function(){var b,c;return c=a(l.options.editable.getSelection().startContainer),b=c.prop("nodeName")?c.prop("nodeName"):c.parent().prop("nodeName"),b&&"A"===b.toUpperCase()?void a("label",e).addClass("ui-state-active"):a("label",e).removeClass("ui-state-active")})},this.options.link&&e("A"),this.options.link?(b.append(f),f.hallobuttonset(),g.dialog(this.options.dialogOpts)):void 0}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallolists",{options:{editable:null,toolbar:null,uuid:"",lists:{ordered:!0,unordered:!0},buttonCssClass:null},populateToolbar:function(b){var c,d,e=this;return d=a('<span class="'+this.widgetName+'"></span>'),c=function(b,c){var f;return f=a("<span></span>"),f.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:c,command:"insert"+b+"List",icon:"icon-list-"+c.toLowerCase(),cssClass:e.options.buttonCssClass}),d.append(f)},this.options.lists.ordered&&c("Ordered","OL"),this.options.lists.unordered&&c("Unordered","UL"),d.hallobuttonset(),b.append(d)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallooverlay",{options:{editable:null,toolbar:null,uuid:"",overlay:null,padding:10,background:null},_create:function(){var b;return b=this,this.options.bound?void 0:(this.options.bound=!0,this.options.editable.element.on("halloactivated",function(c){return b.options.currentEditable=a(c.target),b.options.visible?void 0:b.showOverlay()}),this.options.editable.element.on("hallomodified",function(c){return b.options.currentEditable=a(c.target),b.options.visible?b.resizeOverlay():void 0}),this.options.editable.element.on("hallodeactivated",function(c){return b.options.currentEditable=a(c.target),b.options.visible?b.hideOverlay():void 0}))},showOverlay:function(){return this.options.visible=!0,null===this.options.overlay&&(a("#halloOverlay").length>0?this.options.overlay=a("#halloOverlay"):(this.options.overlay=a('<div id="halloOverlay"            class="halloOverlay">'),a(document.body).append(this.options.overlay)),this.options.overlay.on("click",a.proxy(this.options.editable.turnOff,this.options.editable))),this.options.overlay.show(),null===this.options.background&&(a("#halloBackground").length>0?this.options.background=a("#halloBackground"):(this.options.background=a('<div id="halloBackground"            class="halloBackground">'),a(document.body).append(this.options.background))),this.resizeOverlay(),this.options.background.show(),this.options.originalZIndex||(this.options.originalZIndex=this.options.currentEditable.css("z-index")),this.options.currentEditable.css("z-index","350")},resizeOverlay:function(){var a;return a=this.options.currentEditable.offset(),this.options.background.css({top:a.top-this.options.padding,left:a.left-this.options.padding,width:this.options.currentEditable.width()+2*this.options.padding,height:this.options.currentEditable.height()+2*this.options.padding})},hideOverlay:function(){return this.options.visible=!1,this.options.overlay.hide(),this.options.background.hide(),this.options.currentEditable.css("z-index",this.options.originalZIndex)},_findBackgroundColor:function(a){var b;return b=a.css("background-color"),"rgba(0, 0, 0, 0)"!==b&&"transparent"!==b?b:a.is("body")?"white":this._findBackgroundColor(a.parent())}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloreundo",{options:{editable:null,toolbar:null,uuid:"",buttonCssClass:null},populateToolbar:function(b){var c,d,e=this;return d=a('<span class="'+this.widgetName+'"></span>'),c=function(b,c){var f;return f=a("<span></span>"),f.hallobutton({uuid:e.options.uuid,editable:e.options.editable,label:c,icon:"undo"===b?"icon-undo":"icon-repeat",command:b,queryState:!1,cssClass:e.options.buttonCssClass}),d.append(f)},c("undo","Undo"),c("redo","Redo"),d.hallobuttonset(),b.append(d)}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallotoolbarlinebreak",{options:{editable:null,uuid:"",breakAfter:[]},populateToolbar:function(b){var c,d,e,f,g,h,i,j,k,l,m;for(e=a(".ui-buttonset",b),f=a(),h=0,m=this.options.breakAfter,i=0,k=m.length;k>i;i++)for(g=m[i],h++,c='<div          class="halloButtonrow halloButtonrow-'+h+'" />',j=0,l=e.length;l>j;j++)if(d=e[j],f=a(f).add(a(d)),a(d).hasClass(g)){f.wrapAll(c),e=e.not(f),f=a();break}return e.length>0?(h++,c='<div          class="halloButtonrow halloButtonrow-'+h+'" />',e.wrapAll(c)):void 0}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloToolbarContextual",{toolbar:null,options:{parentElement:"body",editable:null,toolbar:null,positionAbove:!1},_create:function(){var b=this;return this.toolbar=this.options.toolbar,a(this.options.parentElement).append(this.toolbar),this._bindEvents(),a(window).resize(function(a){return b._updatePosition(b._getPosition(a))})},_getPosition:function(a,b){var c,d;if(a)switch(c=a.type){case"keydown":case"keyup":case"keypress":return this._getCaretPosition(b);case"click":case"mousedown":case"mouseup":return d={top:a.pageY,left:a.pageX}}},_getCaretPosition:function(b){var c,d,e;return e=a("<span/>"),c=rangy.createRange(),c.setStart(b.endContainer,b.endOffset),c.insertNode(e.get(0)),d={top:e.offset().top,left:e.offset().left},e.remove(),d},setPosition:function(){return"body"!==this.options.parentElement&&(this.options.parentElement="body",a(this.options.parentElement).append(this.toolbar)),this.toolbar.css("position","absolute"),this.toolbar.css("top",this.element.offset().top-20),this.toolbar.css("left",this.element.offset().left)},_updatePosition:function(b,c){var d,e,f,g,h;return null==c&&(c=null),b&&b.top&&b.left?(f=this.toolbar.outerHeight()+10,c&&!c.collapsed&&c.nativeRange?(e=c.nativeRange.getBoundingClientRect(),h=this.options.positionAbove?e.top-f:e.bottom+10,g=a(window).scrollTop()+h,d=a(window).scrollLeft()+e.left):(h=this.options.positionAbove?-10-f:20,g=b.top+h,d=b.left-this.toolbar.outerWidth()/2+30),this.toolbar.css("top",g),this.toolbar.css("left",d)):void 0},_bindEvents:function(){var a=this;return this.element.on("click",function(b){var c,d;return c={},d=$("window").scrollTop(),c.top=b.clientY+d,c.left=b.clientX,a._updatePosition(c,null),""!==a.toolbar.html()?a.toolbar.show():void 0}),this.element.on("halloselected",function(b,c){var d;return(d=a._getPosition(c.originalEvent,c.selection))?(a._updatePosition(d,c.selection),""!==a.toolbar.html()?a.toolbar.show():void 0):void 0}),this.element.on("hallounselected",function(){return a.toolbar.hide()}),this.element.on("hallodeactivated",function(){return a.toolbar.hide()
})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloToolbarFixed",{toolbar:null,options:{parentElement:"body",editable:null,toolbar:null,affix:!0,affixTopOffset:2},_create:function(){var b,c,d=this;return this.toolbar=this.options.toolbar,this.toolbar.show(),a(this.options.parentElement).append(this.toolbar),this._bindEvents(),a(window).resize(function(){return d.setPosition()}),a(window).scroll(function(){return d.setPosition()}),"body"===this.options.parentElement?(b=a(this.element),c=parseFloat(b.css("padding-left")),c+=parseFloat(b.css("padding-right")),c+=parseFloat(b.css("border-left-width")),c+=parseFloat(b.css("border-right-width")),c+=2*parseFloat(b.css("outline-width")),c+=2*parseFloat(b.css("outline-offset")),a(this.toolbar).css("width",b.width()+c)):void 0},_getPosition:function(a){var b,c,d;if(a)return d=parseFloat(this.element.css("outline-width")),b=d+parseFloat(this.element.css("outline-offset")),c={top:this.element.offset().top-this.toolbar.outerHeight()-b,left:this.element.offset().left-b}},_getCaretPosition:function(b){var c,d,e;return e=a("<span/>"),c=rangy.createRange(),c.setStart(b.endContainer,b.endOffset),c.insertNode(e.get(0)),d={top:e.offset().top,left:e.offset().left},e.remove(),d},setPosition:function(){var b,c,d,e,f,g;if("body"===this.options.parentElement)return this.toolbar.css("position","absolute"),this.toolbar.css("top",this.element.offset().top-this.toolbar.outerHeight()),this.options.affix&&(f=a(window).scrollTop(),e=this.element.offset(),d=this.element.height(),g=this.options.affixTopOffset,c=e.top-(this.toolbar.height()+this.options.affixTopOffset),b=d-g+(e.top-this.toolbar.height()),f>c&&b>f&&(this.toolbar.css("position","fixed"),this.toolbar.css("top",this.options.affixTopOffset))),this.toolbar.css("left",this.element.offset().left-2)},_updatePosition:function(){},_bindEvents:function(){var a=this;return this.element.on("halloactivated",function(){return a.setPosition(),a.toolbar.show()}),this.element.on("hallodeactivated",function(){return a.toolbar.hide()})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.halloToolbarInstant",{toolbar:null,options:{parentElement:"body",editable:null,toolbar:null,positionAbove:!1},_create:function(){var b=this;return this.toolbar=this.options.toolbar,a(this.options.parentElement).append(this.toolbar),this._bindEvents(),a(window).resize(function(a){return b._updatePosition(b._getPosition(a))})},_getPosition:function(a,b){var c,d;if(a)switch(c=a.type){case"keydown":case"keyup":case"keypress":return this._getCaretPosition(b);case"click":case"mousedown":case"mouseup":return d={top:a.pageY,left:a.pageX}}},_getCaretPosition:function(b){var c,d,e;return e=a("<span/>"),c=rangy.createRange(),c.setStart(b.endContainer,b.endOffset),c.insertNode(e.get(0)),d={top:e.offset().top,left:e.offset().left},e.remove(),d},setPosition:function(){return"body"!==this.options.parentElement&&(this.options.parentElement="body",a(this.options.parentElement).append(this.toolbar)),this.toolbar.css("position","absolute"),this.toolbar.css("top",this.element.offset().top-20),this.toolbar.css("left",this.element.offset().left)},_updatePosition:function(b,c){var d,e,f,g,h;return null==c&&(c=null),b&&b.top&&b.left?(f=this.toolbar.outerHeight()+10,c&&!c.collapsed&&c.nativeRange?(e=c.nativeRange.getBoundingClientRect(),h=this.options.positionAbove?e.top-f:e.bottom+10,g=a(window).scrollTop()+h,d=a(window).scrollLeft()+e.left):(h=this.options.positionAbove?-10-f:20,g=b.top+h,d=b.left-this.toolbar.outerWidth()/2+30),this.toolbar.css("top",g),this.toolbar.css("left",d)):void 0},_bindEvents:function(){var a=this;return this.element.on("click",function(b){var c,d;return c={},d=$("window").scrollTop(),c.top=b.clientY+d,c.left=b.clientX,a._updatePosition(c,null),""!==a.toolbar.html()?a.toolbar.show():void 0}),this.element.on("halloselected",function(b,c){var d;return(d=a._getPosition(c.originalEvent,c.selection))?(a._updatePosition(d,c.selection),""!==a.toolbar.html()?a.toolbar.show():void 0):void 0}),this.element.on("hallounselected",function(){return a.toolbar.hide()}),this.element.on("hallodeactivated",function(){return a.toolbar.hide()})}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallobutton",{button:null,isChecked:!1,options:{uuid:"",label:null,icon:null,editable:null,command:null,commandValue:null,queryState:!0,cssClass:null},_create:function(){var a,b,c,d,e=this;return null==(d=this.options).icon&&(d.icon="icon-"+this.options.label.toLowerCase()),b=""+this.options.uuid+"-"+this.options.label,c=this.options,this.button=this._createButton(b,c.command,c.label,c.icon),this.element.append(this.button),this.options.cssClass&&this.button.addClass(this.options.cssClass),this.options.editable.options.touchScreen&&this.button.addClass("btn-large"),this.button.data("hallo-command",this.options.command),this.options.commandValue&&this.button.data("hallo-command-value",this.options.commandValue),a="ui-state-hover",this.button.on("mouseenter",function(){return e.isEnabled()?e.button.addClass(a):void 0}),this.button.on("mouseleave",function(){return e.button.removeClass(a)})},_init:function(){var a,b,c,d=this;return this.button||(this.button=this._prepareButton()),this.element.append(this.button),c=this.options.queryState===!0?function(){var a,b,c;if(d.options.command)try{return d.options.commandValue?(c=document.queryCommandValue(d.options.command),a=c.match(new RegExp(d.options.commandValue,"i")),d.checked(a?!0:!1)):d.checked(document.queryCommandState(d.options.command))}catch(e){b=e}}:this.options.queryState,this.options.command&&this.button.on("click",function(){return d.options.commandValue?d.options.editable.execute(d.options.command,d.options.commandValue):d.options.editable.execute(d.options.command),"function"==typeof c&&c(),!1}),this.options.queryState?(a=this.options.editable.element,b="keyup paste change mouseup hallomodified",a.on(b,c),a.on("halloenabled",function(){return a.on(b,c)}),a.on("hallodisabled",function(){return a.off(b,c)})):void 0},enable:function(){return this.button.removeAttr("disabled")},disable:function(){return this.button.attr("disabled","true")},isEnabled:function(){return"true"!==this.button.attr("disabled")},refresh:function(){return this.isChecked?this.button.addClass("ui-state-active"):this.button.removeClass("ui-state-active")},checked:function(a){return this.isChecked=a,this.refresh()},_createButton:function(b,c,d,e){var f;return f=["ui-button","ui-widget","ui-state-default","ui-corner-all","ui-button-text-only",""+c+"_button"],a('<button id="'+b+'"        class="'+f.join(" ")+'" title="'+d+'">          <span class="ui-button-text">            <i class="'+e+'"></i>          </span>        </button>')}}),a.widget("IKS.hallobuttonset",{buttons:null,_create:function(){return this.element.addClass("ui-buttonset")},_init:function(){return this.refresh()},refresh:function(){var a;return a="rtl"===this.element.css("direction"),this.buttons=this.element.find(".ui-button"),this.buttons.removeClass("ui-corner-all ui-corner-left ui-corner-right"),a?(this.buttons.filter(":first").addClass("ui-corner-right"),this.buttons.filter(":last").addClass("ui-corner-left")):(this.buttons.filter(":first").addClass("ui-corner-left"),this.buttons.filter(":last").addClass("ui-corner-right"))}})}(jQuery)}.call(this),function(){!function(a){return a.widget("IKS.hallodropdownbutton",{button:null,options:{uuid:"",label:null,icon:null,editable:null,target:"",cssClass:null},_create:function(){var a;return null!=(a=this.options).icon?(a=this.options).icon:a.icon="icon-"+this.options.label.toLowerCase()},_init:function(){var b,c=this;return b=a(this.options.target),b.css("position","absolute"),b.addClass("dropdown-menu"),b.hide(),this.button||(this.button=this._prepareButton()),this.button.on("click",function(){return b.hasClass("open")?void c._hideTarget():c._showTarget()}),b.on("click",function(){return c._hideTarget()}),this.options.editable.element.on("hallodeactivated",function(){return c._hideTarget()}),this.element.append(this.button)},_showTarget:function(){var b;return b=a(this.options.target),this._updateTargetPosition(),b.addClass("open"),b.show()},_hideTarget:function(){var b;return b=a(this.options.target),b.removeClass("open"),b.hide()},_updateTargetPosition:function(){var b,c,d,e;return c=a(this.options.target),e=this.button.position(),d=e.top,b=e.left,d+=this.button.outerHeight(),c.css("top",d),c.css("left",b-20)},_prepareButton:function(){var b,c,d;return d=""+this.options.uuid+"-"+this.options.label,c=["ui-button","ui-widget","ui-state-default","ui-corner-all","ui-button-text-only"],b=a('<button id="'+d+'"       class="'+c.join(" ")+'" title="'+this.options.label+'">       <span class="ui-button-text"><i class="'+this.options.icon+'"></i></span>       </button>'),this.options.cssClass&&b.addClass(this.options.cssClass),b}})}(jQuery)}.call(this),function(a,b){"use strict";a.widget("Midgard.midgardCreate",{options:{toolbar:"full",saveButton:null,state:"browse",highlight:!0,highlightColor:"#67cc08",editorWidgets:{"default":"hallo"},editorOptions:{hallo:{widget:"halloWidget"}},collectionWidgets:{"default":"midgardCollectionAdd"},url:function(){},storagePrefix:"node",workflows:{url:null},notifications:{},vie:null,domService:"rdfa",stanbolUrl:null,dbPediaUrl:null,metadata:{},buttonContainer:".create-ui-toolbar-statustoolarea .create-ui-statustools",templates:{buttonContent:'<%= label %> <i class="icon-<%= icon %>"></i>',button:'<li id="<%= id %>"><a class="create-ui-btn"><%= buttonContent %></a></li>'},localize:function(a,b){return window.midgardCreate.localize(a,b)},language:null},_create:function(){this.vie=this._setupVIE(this.options),this.domService=this.vie.service(this.options.domService);var b=this;window.setTimeout(function(){b._checkSession()},10),this.options.language||(this.options.language=a("html").attr("lang")),this._enableToolbar(),this._enableMetadata(),this._saveButton(),this._editButton(),this._prepareStorage(),this.element.midgardWorkflows&&this.element.midgardWorkflows(this.options.workflows),this.element.midgardNotifications&&this.element.midgardNotifications(this.options.notifications),this._bindShortcuts()},destroy:function(){this.element.midgardStorage("destroy"),this.element.midgardToolbar("destroy"),this.domService.findSubjectElements(this.element).each(function(){a(this).midgardEditable("destroy")}),this.element.midgardWorkflows&&this.element.midgardWorkflows("destroy"),this.element.midgardNotifications&&this.element.midgardNotifications("destroy"),_.isEmpty(this.options.metadata)||this.element.midgardMetadata("destroy"),a.Widget.prototype.destroy.call(this)},_setupVIE:function(a){var b;return b=a.vie?a.vie:new VIE,b.hasService(this.options.domService)||"rdfa"!==this.options.domService||b.use(new b.RdfaService),!b.hasService("stanbol")&&a.stanbolUrl&&b.use(new b.StanbolService({proxyDisabled:!0,url:a.stanbolUrl})),!b.hasService("dbpedia")&&a.dbPediaUrl&&b.use(new b.DBPediaService({proxyDisabled:!0,url:a.dbPediaUrl})),b},_prepareStorage:function(){this.element.midgardStorage({vie:this.vie,url:this.options.url,localize:this.options.localize,language:this.options.language,storagePrefix:this.options.storagePrefix});var b=this;this.element.on("midgardstoragesave",function(){a("#midgardcreate-save a").html(_.template(b.options.templates.buttonContent,{label:b.options.localize("Saving",b.options.language),icon:"upload"}))}),this.element.on("midgardstoragesaved midgardstorageerror",function(){a("#midgardcreate-save a").html(_.template(b.options.templates.buttonContent,{label:b.options.localize("Save",b.options.language),icon:"ok"}))})},_init:function(){this.setState(this.options.state)},setState:function(a){this._setOption("state",a),"edit"===a?this._enableEdit():this._disableEdit(),this._setEditButtonState(a)},setToolbar:function(a){this.options.toolbar=a,(this.element.data("Midgard-midgardToolbar")||this.element.data("midgardToolbar"))&&this.element.midgardToolbar("setDisplay",a)},showNotification:function(a){return this.element.midgardNotifications?this.element.midgardNotifications("create",a):void 0},configureEditor:function(a,b,c){this.options.editorOptions[a]={widget:b,options:c}},setEditorForContentType:function(a,c){if(this.options.editorOptions[c]===b&&null!==c)throw new Error("No editor "+c+" configured");this.options.editorWidgets[a]=c},setEditorForProperty:function(a,c){if(this.options.editorOptions[c]===b&&null!==c)throw new Error("No editor "+c+" configured");this.options.editorWidgets[a]=c},_checkSession:function(){if(window.sessionStorage){var a=this.options.storagePrefix+"Midgard.create.toolbar";window.sessionStorage.getItem(a)&&this.setToolbar(window.sessionStorage.getItem(a));var b=this.options.storagePrefix+"Midgard.create.state";window.sessionStorage.getItem(b)&&this.setState(window.sessionStorage.getItem(b)),this.element.on("midgardcreatestatechange",function(a,c){window.sessionStorage.setItem(b,c.state)})}},_bindShortcuts:function(){if(window.Mousetrap){var a=this;window.Mousetrap.bind(["command+e","ctrl+e"],function(){"edit"!==a.options.state&&a.setState("edit")}),window.Mousetrap.bind("esc",function(b){"browse"!==a.options.state&&(b.stopPropagation(),a.setState("browse"))}),window.Mousetrap.bind(["command+s","ctrl+s"],function(b){b.preventDefault(),a.options.saveButton&&(a.options.saveButton.hasClass("ui-state-disabled")||a.options.saveButton.click())})}},_saveButton:function(){if(this.options.saveButton)return this.options.saveButton;var b=this;a(this.options.buttonContainer,this.element).append(a(_.template(this.options.templates.button,{id:"midgardcreate-save",buttonContent:_.template(this.options.templates.buttonContent,{label:b.options.localize("Save",b.options.language),icon:"ok"})}))),this.options.saveButton=a("#midgardcreate-save",this.element),this.options.saveButton.hide(),this.options.saveButton.click(function(){b.element.midgardStorage("saveRemoteAll")}),this.element.on("midgardeditablechanged midgardstorageloaded",function(){b.options.saveButton.button({disabled:!1})}),this.element.on("midgardstoragesaved",function(){b.options.saveButton.button({disabled:!0})}),this.element.on("midgardeditableenable",function(){b.options.saveButton.button({disabled:!0}),b.options.saveButton.show()}),this.element.on("midgardeditabledisable",function(){b.options.saveButton.hide()})},_editButton:function(){var b=this;a(this.options.buttonContainer,this.element).append(a(_.template(this.options.templates.button,{id:"midgardcreate-edit",buttonContent:""}))),a("#midgardcreate-edit",this.element).on("click",function(){return"edit"===b.options.state?void b.setState("browse"):void b.setState("edit")})},_setEditButtonState:function(b){var c=this,d={edit:_.template(this.options.templates.buttonContent,{label:c.options.localize("Cancel",c.options.language),icon:"remove"}),browse:_.template(this.options.templates.buttonContent,{label:c.options.localize("Edit",c.options.language),icon:"edit"})},e=a("#midgardcreate-edit a",this.element);e&&("edit"===b&&e.addClass("selected"),e.html(d[b]))},_enableToolbar:function(){var a=this;this.element.on("midgardtoolbarstatechange",function(b,c){a.setToolbar(c.display),window.sessionStorage&&window.sessionStorage.setItem(a.options.storagePrefix+"Midgard.create.toolbar",c.display)}),this.element.midgardToolbar({display:this.options.toolbar,vie:this.vie})},_enableMetadata:function(){_.isEmpty(this.options.metadata)||a(".create-ui-tool-metadataarea",this.element).midgardMetadata({vie:this.vie,localize:this.options.localize,language:this.options.language,editors:this.options.metadata,createElement:this.element,editableNs:"midgardeditable"})},_enableEdit:function(){this._setOption("state","edit");var b=this,c={toolbarState:b.options.toolbar,disabled:!1,vie:b.vie,domService:b.options.domService,widgets:b.options.editorWidgets,editors:b.options.editorOptions,collectionWidgets:b.options.collectionWidgets,localize:b.options.localize,language:b.options.language};b.options.enableEditor&&(c.enableEditor=b.options.enableEditor),b.options.disableEditor&&(c.disableEditor=b.options.disableEditor),this.domService.findSubjectElements(this.element).each(function(){var d=this;if(b.options.highlight){var e=function(c,e){a(e.element).is(":visible")&&e.entityElement.get(0)===d&&(window.Mousetrap&&e.element.addClass("mousetrap"),e.element.stop(!0,!0),e.element.effect("highlight",{color:b.options.highlightColor},3e3))};a(this).on("midgardeditableenableproperty",e)}a(this).on("midgardeditabledisable",function(){a(this).off("midgardeditableenableproperty",e)}),a(this).midgardEditable(c)}),this._trigger("statechange",null,{state:"edit"})},_disableEdit:function(){var b=this,c={disabled:!0,vie:b.vie,domService:b.options.domService,editorOptions:b.options.editorOptions,localize:b.options.localize,language:b.options.language};this.domService.findSubjectElements(this.element).each(function(){a(this).midgardEditable(c),a(this).removeClass("ui-state-disabled")}),this._setOption("state","browse"),this._trigger("statechange",null,{state:"browse"})}})}(jQuery),function(a,b){"use strict";a.widget("Midgard.midgardEditable",{options:{propertyEditors:{},collections:[],model:null,propertyEditorWidgetsConfiguration:{hallo:{widget:"halloWidget",options:{}}},propertyEditorWidgets:{"default":"hallo"},collectionWidgets:{"default":"midgardCollectionAdd"},toolbarState:"full",vie:null,domService:"rdfa",predicateSelector:"[property]",disabled:!1,localize:function(a,b){return window.midgardCreate.localize(a,b)},language:null,state:null,acceptStateChange:!0,stateChange:null,decorateEditableEntity:null,decoratePropertyEditor:null,editables:[],editors:{},widgets:{}},_params:function(a,b){var c={entity:this.options.model,editableEntity:this,entityElement:this.element,editable:this,element:this.element,instance:this.options.model},d=a?{predicate:a,propertyEditor:this.options.propertyEditors[a],propertyElement:this.options.propertyEditors[a].element,property:a,element:this.options.propertyEditors[a].element}:{};return _.extend(c,d,b)},_create:function(){if(this.options.widgets&&(this.options.propertyEditorWidgets=_.extend(this.options.propertyEditorWidgets,this.options.widgets)),this.options.editors&&(this.options.propertyEditorWidgetsConfiguration=_.extend(this.options.propertyEditorWidgetsConfiguration,this.options.editors)),this.vie=this.options.vie,this.domService=this.vie.service(this.options.domService),!this.options.model){var a=this;this.vie.load({element:this.element}).from(this.options.domService).execute().done(function(b){a.options.model=b[0]})}_.isFunction(this.options.decorateEditableEntity)&&this.options.decorateEditableEntity(this._params())},_init:function(){return this.options.widgets&&(this.options.propertyEditorWidgets=_.extend(this.options.propertyEditorWidgets,this.options.widgets)),this.options.editors&&(this.options.propertyEditorWidgetsConfiguration=_.extend(this.options.propertyEditorWidgetsConfiguration,this.options.editors)),this.options.disabled===!0?void this.setState("inactive"):this.options.disabled===!1&&"inactive"===this.options.state?void this.setState("candidate"):(this.options.disabled=!1,this.options.state?void this.setState(this.options.state):void this.setState("candidate"))},setState:function(a,c,d,e){var f=this.options.state,g=a;if(g!==f){if(this.options.acceptStateChange===b||!_.isFunction(this.options.acceptStateChange))return this._doSetState(f,g,c,d),void(_.isFunction(e)&&e(!0));var h=this;this.options.acceptStateChange(f,g,c,d,function(a){a&&h._doSetState(f,g,c,d),_.isFunction(e)&&e(a)})}},getState:function(){return this.options.state},_doSetState:function(a,b,c,d){this.options.state=b,"inactive"===b?this.disable():null!==a&&"inactive"!==a||"inactive"===b||this.enable(),this._trigger("statechange",null,this._params(c,{previous:a,current:b,context:d}))},findEditablePredicateElements:function(b){this.domService.findPredicateElements(this.options.model.id,a(this.options.predicateSelector,this.element),!1).each(b)},getElementPredicate:function(a){return this.domService.getElementPredicate(a)},enable:function(){var b=this;this.options.model&&(this.findEditablePredicateElements(function(){b._enablePropertyEditor(a(this))}),this._trigger("enable",null,this._params()),this.vie.view&&this.vie.view.Collection&&_.each(this.domService.views,function(a){if(a instanceof this.vie.view.Collection&&this.options.model===a.owner){var c=a.collection.predicate,d=_.clone(this.options);d.state=null;var e=this.enableCollection({model:this.options.model,collection:a.collection,property:c,definition:this.getAttributeDefinition(c),view:a,element:a.el,vie:b.vie,editableOptions:d});b.options.collections.push(e)}},this))},disable:function(){_.each(this.options.propertyEditors,function(a){this.disablePropertyEditor({widget:this,editable:a,entity:this.options.model,element:a.element})},this),this.options.propertyEditors={},this.options.editables=[],_.each(this.options.collections,function(a){var b=_.clone(this.options);b.state="inactive",this.disableCollection({widget:this,model:this.options.model,element:a,vie:this.vie,editableOptions:b})},this),this.options.collections=[],this._trigger("disable",null,this._params())},_enablePropertyEditor:function(a){var b=this,c=this.getElementPredicate(a);if(!c)return!0;if(this.options.model.get(c)instanceof Array)return!0;var d=this.enablePropertyEditor({widget:this,element:a,entity:this.options.model,property:c,vie:this.vie,decorate:this.options.decoratePropertyEditor,decorateParams:_.bind(this._params,this),changed:function(a){b.setState("changed",c);var d={};d[c]=a,b.options.model.set(d,{silent:!0}),b._trigger("changed",null,b._params(c))},activating:function(){b.setState("activating",c)},activated:function(){b.setState("active",c),b._trigger("activated",null,b._params(c))},deactivated:function(){b.setState("candidate",c),b._trigger("deactivated",null,b._params(c))}});if(d){var e=d.data("createWidgetName");this.options.propertyEditors[c]=d.data("Midgard-"+e),this.options.propertyEditors[c]||(this.options.propertyEditors[c]=d.data(e)),this.options.editables.push(d),this._trigger("enableproperty",null,this._params(c))}},_propertyEditorName:function(a){if(this.options.propertyEditorWidgets[a.property]!==b)return this.options.propertyEditorWidgets[a.property];var c="default",d=this.getAttributeDefinition(a.property);return d&&(c=d.range[0]),this.options.propertyEditorWidgets[c]!==b?this.options.propertyEditorWidgets[c]:this.options.propertyEditorWidgets["default"]},_propertyEditorWidget:function(a){return this.options.propertyEditorWidgetsConfiguration[a].widget},_propertyEditorOptions:function(a){return this.options.propertyEditorWidgetsConfiguration[a].options},getAttributeDefinition:function(a){var b=this.options.model.get("@type");if(b&&b.attributes)return b.attributes.get(a)},enableEditor:function(a){return this.enablePropertyEditor(a)},enablePropertyEditor:function(b){var c=this._propertyEditorName(b);if(null!==c){var d=this._propertyEditorWidget(c);if(b.editorOptions=this._propertyEditorOptions(c),b.toolbarState=this.options.toolbarState,b.disabled=!1,b.editorName=c,b.editorWidget=d,"function"!=typeof a(b.element)[d])throw new Error(d+" widget is not available");return a(b.element)[d](b),a(b.element).data("createWidgetName",d),a(b.element)}},disableEditor:function(a){return this.disablePropertyEditor(a)},disablePropertyEditor:function(b){b.element[b.editable.widgetName]({disabled:!0}),a(b.element).removeClass("ui-state-disabled"),b.element.is(":focus")&&b.element.blur()},collectionWidgetName:function(a){if(this.options.collectionWidgets[a.property]!==b)return this.options.collectionWidgets[a.property];var c="default",d=this.getAttributeDefinition(a.property);return d&&(c=d.range[0]),this.options.collectionWidgets[c]!==b?this.options.collectionWidgets[c]:this.options.collectionWidgets["default"]},enableCollection:function(b){var c=this.collectionWidgetName(b);if(null!==c){if(b.disabled=!1,"function"!=typeof a(b.element)[c])throw new Error(c+" widget is not available");return a(b.element)[c](b),a(b.element).data("createCollectionWidgetName",c),a(b.element)}},disableCollection:function(b){var c=a(b.element).data("createCollectionWidgetName");null!==c&&(b.disabled=!0,c&&(a(b.element)[c](b),a(b.element).removeClass("ui-state-disabled")))}})}(jQuery),function(a){"use strict";a.widget("Midgard.midgardMetadata",{contentArea:null,editorElements:{},options:{vie:null,templates:{button:'<button class="create-ui-btn"><i class="icon-<%= icon %>"></i> <%= label %></button>',contentArea:'<div class="dropdown-menu"></div>'},localize:function(a,b){return window.midgardCreate.localize(a,b)},language:null,createElement:"body",editableNs:"midgardeditable"},_create:function(){this._render()},_init:function(){this._prepareEditors(),this._bindEditables()},_prepareEditors:function(){_.each(this.options.editors,function(b,c){var d=a("<div></div>").addClass(c);if(this.contentArea.append(d),!_.isFunction(d[c]))throw new Error("Metadata editor widget "+c+" is not available");_.extend(b,{vie:this.options.vie,language:this.options.language,localize:this.options.localize,createElement:this.options.createElement,editableNs:this.options.editableNs}),d[c](b),this.editorElements[c]=d},this)},activateEditors:function(a){this.element.show(),_.each(this.options.editors,function(b,c){this.editorElements[c]&&this.editorElements[c][c]("activate",a)},this)},_bindEditables:function(){var b=this,c=a(this.options.createElement);c.on(this.options.editableNs+"activated",function(a,c){b.activateEditors({entity:c.entity,entityElement:c.entityElement,predicate:c.predicate})})},_prepareEditorArea:function(){var b=a(_.template(this.options.templates.contentArea,{}));return b.hide(),b},_render:function(){var b=this,c=a(_.template(this.options.templates.button,{icon:"info-sign",label:this.options.localize("Metadata",this.options.language)}));this.element.empty(),this.element.append(c),this.element.hide(),this.contentArea=this._prepareEditorArea(c),c.after(this.contentArea),c.on("click",function(a){a.preventDefault();var d=c.position();b.contentArea.css({position:"absolute",left:d.left}),b.contentArea.toggle()})}})}(jQuery),function(a){"use strict";var b=[],c=function(c,d){var e={class_prefix:"midgardNotifications",timeout:3e3,auto_show:!0,body:"",bindTo:null,gravity:"T",effects:{onShow:function(a,b){a.animate({opacity:"show"},600,b)},onHide:function(a,b){a.animate({opacity:"hide"},600,b)}},actions:[],callbacks:{}},f={},g={},h=null,i=null,j=null,k=c,l=null,m={constructor:function(a){f=_.extend(e,a||{}),g={container:f.class_prefix+"-container",item:{wrapper:f.class_prefix+"-item",arrow:f.class_prefix+"-arrow",disregard:f.class_prefix+"-disregard",content:f.class_prefix+"-content",actions:f.class_prefix+"-actions",action:f.class_prefix+"-action"}},this._generate()},getId:function(){return i},getElement:function(){return h},_generate:function(){var c,d,e=this,j=null;if(h=c=a('<div class="'+g.item.wrapper+'-outer"/>'),c.css({display:"none"}),d=a('<div class="'+g.item.wrapper+'-inner"/>'),d.appendTo(c),f.bindTo){c.addClass(g.item.wrapper+"-binded");var m=a('<div class="'+g.item.arrow+'"/>');m.appendTo(c)}else c.addClass(g.item.wrapper+"-normal");if(j=a('<div class="'+g.item.content+'"/>'),j.html(f.body),j.appendTo(d),f.actions.length){var n=a('<div class="'+g.item.actions+'"/>');n.appendTo(d),a.each(f.actions,function(b,c){var d=a('<button name="'+c.name+'" class="button-'+c.name+'">'+c.label+"</button>").button();d.on("click",function(a){l?c.cb(a,l,e):c.cb(a,e)}),c.className&&d.addClass(c.className),n.append(d)})}h.on("click",function(a){f.callbacks.onClick?f.callbacks.onClick(a,e):l||e.close()}),f.auto_show&&this.show(),this._setPosition(),i=b.push(this),k.append(h)},_calculatePositionForGravity:function(a,b,c,d){switch(a.find("."+g.item.arrow).addClass(g.item.arrow+"_"+b),b){case"TL":return{left:c.left,top:c.top+c.height+"px"};case"TR":return{left:c.left+c.width-d.width+"px",top:c.top+c.height+"px"};case"BL":return{left:c.left+"px",top:c.top-d.height+"px"};case"BR":return{left:c.left+c.width-d.width+"px",top:c.top-d.height+"px"};case"LT":return{left:c.left+c.width+"px",top:c.top+"px"};case"LB":return{left:c.left+c.width+"px",top:c.top+c.height-d.height+"px"};case"RT":return{left:c.left-d.width+"px",top:c.top+"px"};case"RB":return{left:c.left-d.width+"px",top:c.top+c.height-d.height+"px"};case"T":return{left:c.left+c.width/2-d.width/2+"px",top:c.top+c.height+"px"};case"R":return{left:c.left-d.width+"px",top:c.top+c.height/2-d.height/2+"px"};case"B":return{left:c.left+c.width/2-d.width/2+"px",top:c.top-d.height+"px"};case"L":return{left:c.left+c.width+"px",top:c.top+c.height/2-d.height/2+"px"}}},_isFixed:function(a){if(a===document)return!1;if("fixed"===a.css("position"))return!0;var b=a.offsetParent();return b.get(0)===a.get(0)?!1:this._isFixed(b)},_setPosition:function(){var c;if(f.bindTo){var d={width:h.width()?h.width():280,height:h.height()?h.height():109};j=a(f.bindTo);var e={},g={width:j.outerWidth(),height:j.outerHeight()};return this._isFixed(j)?(e.position="fixed",g.left=j.offset().left,g.top=j.position().top):(e.position="absolute",g.left=j.offset().left,g.top=j.offset().top),c=this._calculatePositionForGravity(h,f.gravity,g,d),e.top=c.top,e.left=c.left,void h.css(e)}f.position||(f.position="top right");var i=a(".create-ui-toolbar-wrapper").outerHeight(!0)+6;c={position:"fixed"};var k,l=function(b){var c=0;return a.each(b,function(a,b){b&&(c+=b.getElement().height())}),c};f.position.match(/top/)&&(c.top=i+l(b)+"px"),f.position.match(/bottom/)&&(c.bottom=b.length-1*k.height()+k.height()+10+"px"),f.position.match(/right/)&&(c.right="20px"),f.position.match(/left/)&&(c.left="20px"),h.css(c)},show:function(){var b,c,d,e,g,i,j=this;if(f.callbacks.beforeShow&&f.callbacks.beforeShow(j),f.bindTo){var k=a(f.bindTo);b=a(window).scrollTop(),c=a(window).scrollTop()+a(window).height(),e=parseFloat(h.offset().top,10),g=k.offset().top,i=k.outerHeight(),e>g&&(e=g),d=parseFloat(h.offset().top,10)+h.height(),g+i>d&&(d=g+i)}f.timeout>0&&!f.actions.length&&window.setTimeout(function(){j.close()},f.timeout),f.bindTo&&(b>e||e>c)||b>d||d>c?a("html, body").stop().animate({scrollTop:e},500,"easeInOutExpo",function(){f.effects.onShow(h,function(){f.callbacks.afterShow&&f.callbacks.afterShow(j)})}):f.effects.onShow(h,function(){f.callbacks.afterShow&&f.callbacks.afterShow(j)})},close:function(){var a=this;f.callbacks.beforeClose&&f.callbacks.beforeClose(a),f.effects.onHide(h,function(){f.callbacks.afterClose&&f.callbacks.afterClose(a),a.destroy()})},destroy:function(){var c=this;a.each(b,function(a,d){d&&d.getId()==c.getId()&&delete b[a]}),a(h).remove()},setStory:function(a){l=a},setName:function(a){h.addClass(g.item.wrapper+"-custom-"+a),this.name=a}};return m.constructor(d),delete m.constructor,m},d=function(b,d){var e={},f={},g={},h=null,i=null,j=null,k=null,l={constructor:function(a){f=_.extend(e,a||{})},setStoryline:function(b){var c={content:"",actions:[],show_actions:!0,notification:{},back:null,back_label:null,forward:null,forward_label:null,beforeShow:null,afterShow:null,beforeClose:null,afterClose:null};g={},k=null,h=null,i=null,j=null;var d=this;return a.each(b,function(b,e){var f=a.extend({},c,e);f.name=b;var k=a.extend({},c.notification,e.notification||{});if(k.body=f.content,k.auto_show=!1,f.actions.length&&(k.delay=0),k.callbacks={beforeShow:function(a){f.beforeShow&&f.beforeShow(a,d)},afterShow:function(a){f.afterShow&&f.afterShow(a,d)},beforeClose:function(a){f.beforeClose&&f.beforeClose(a,d)},afterClose:function(a){f.afterClose&&f.afterClose(a,d),h=a.name}},k.actions=[],f.show_actions){if(f.back){var l=f.back_label;l||(l="Back"),k.actions.push({name:"back",label:l,cb:function(a,b){b.previous()}})}if(f.forward){var m=f.forward_label;m||(m="Back"),k.actions.push({name:"forward",label:m,cb:function(a,b){b.next()}})}f.actions.length&&a.each(f.actions,function(a){k.actions.push(f.actions[a])
})}i||(i=b),j=b,f.notification=k,g[b]=f}),g},start:function(){this._showNotification(g[i])},stop:function(){k.close(),k=null,h=null},next:function(){if(k.close(),g[k.name].forward){var a=g[k.name].forward;this._showNotification(g[a])}else this._showNotification(g[j])},previous:function(){if(h)if(k.close(),g[k.name].back){var a=g[k.name].back;this._showNotification(g[a])}else this._showNotification(g[h]);else this.stop()},_showNotification:function(b){return k=new c(a("body"),b.notification),k.setStory(this),k.setName(b.name),k.show(),k}};return l.constructor(b),delete l.constructor,d&&l.setStoryline(d),l},e={start:{content:"Welcome to CreateJS tutorial!",forward:"toolbar_toggle",forward_label:"Start tutorial",actions:[{name:"quit",label:"Quit",cb:function(a,b){b.stop()}}]},toolbar_toggle:{content:"This is the CreateJS toolbars toggle button.<br />You can hide and show the full toolbar by clicking here.<br />Try it now.",forward:"edit_button",show_actions:!1,afterShow:function(b,c){a("body").on("midgardtoolbarstatechange",function(b,d){"full"==d.display&&(c.next(),a("body").off("midgardtoolbarstatechange"))})},notification:{bindTo:"#midgard-bar-hidebutton",timeout:0,gravity:"TL"}},edit_button:{content:"This is the edit button.<br />Try it now.",show_actions:!1,afterShow:function(b,c){a("body").on("midgardcreatestatechange",function(b,d){"edit"==d.state&&(c.next(),a("body").off("midgardcreatestatechange"))})},notification:{bindTo:".ui-button[for=midgardcreate-edit]",timeout:0,gravity:"TL"}},end:{content:"Thank you for watching!<br />Happy content editing times await you!"}};a.widget("Midgard.midgardNotifications",{options:{notification_defaults:{class_prefix:"midgardNotifications",position:"top right"}},_create:function(){this.classes={container:this.options.notification_defaults.class_prefix+"-container"},a("."+this.classes.container,this.element).length?(this.container=a("."+this.classes.container,this.element),this._parseFromDOM()):(this.container=a('<div class="'+this.classes.container+'" />'),this.element.append(this.container))},destroy:function(){this.container.remove(),a.Widget.prototype.destroy.call(this)},_init:function(){},_parseFromDOM:function(){},showStory:function(a,b){var c=new d(a,b);return c.start(),c},create:function(b){b=a.extend({},this.options.notification_defaults,b||{});var d=new c(this.container,b);return d.show(),d},showTutorial:function(){this.showStory({},e)}})}(jQuery),function(a){"use strict";a.widget("Midgard.midgardStorage",{saveEnabled:!0,options:{localStorage:!1,storagePrefix:"",removeLocalstorageOnIgnore:!0,vie:null,url:"",autoSave:!1,autoSaveInterval:5e3,saveReferencedNew:!1,saveReferencedChanged:!1,editableNs:"midgardeditable",editSelector:"#midgardcreate-edit a",localize:function(a,b){return window.midgardCreate.localize(a,b)},language:null},_create:function(){var a=this;this.changedModels=[],window.localStorage&&(this.options.localStorage=!0),this.vie=this.options.vie,this.vie.entities.on("add",function(b){b.url=a.options.url,b.toJSON=b.toJSONLD}),a._bindEditables(),a.options.autoSave&&a._autoSave()},_autoSave:function(){var a=this;a.saveEnabled=!0;var b=function(){a.saveEnabled&&0!==a.changedModels.length&&a.saveRemoteAll({silent:!0})},c=window.setInterval(b,a.options.autoSaveInterval);this.element.on("startPreventSave",function(){c&&(window.clearInterval(c),c=null),a.disableAutoSave()}),this.element.on("stopPreventSave",function(){c||(c=window.setInterval(b,a.options.autoSaveInterval)),a.enableAutoSave()})},enableAutoSave:function(){this.saveEnabled=!0},disableAutoSave:function(){this.saveEnabled=!1},_bindEditables:function(){var a=this;this.restorables=[];var b;a.element.on(a.options.editableNs+"changed",function(b,c){-1===_.indexOf(a.changedModels,c.instance)?(a.changedModels.push(c.instance),c.instance.midgardStorageVersion=1):c.instance.midgardStorageVersion++,a._saveLocal(c.instance)}),a.element.on(a.options.editableNs+"disable",function(b,c){a.revertChanges(c.instance)}),a.element.on(a.options.editableNs+"enable",function(b,c){c.instance._originalAttributes||(c.instance._originalAttributes=_.clone(c.instance.attributes)),!c.instance.isNew()&&a._checkLocal(c.instance)&&a.restorables.push(c.instance)}),a.element.on("midgardcreatestatechange",function(c,d){return"browse"===d.state||0===a.restorables.length?(a.restorables=[],void(b&&b.close())):void(b=a.checkRestore())}),a.element.on("midgardstorageloaded",function(b,c){-1===_.indexOf(a.changedModels,c.instance)&&a.changedModels.push(c.instance)})},checkRestore:function(){var b=this;if(0!==b.restorables.length){var c,d;c=1===b.restorables.length?_.template(b.options.localize("localModification",b.options.language),{label:b.restorables[0].getSubjectUri()}):_.template(b.options.localize("localModifications",b.options.language),{number:b.restorables.length});var e=function(){b.restoreLocalAll(),d.close()},f=function(){b.ignoreLocal(),d.close()};return d=a("body").midgardNotifications("create",{bindTo:b.options.editSelector,gravity:"TR",body:c,timeout:0,actions:[{name:"restore",label:b.options.localize("Restore",b.options.language),cb:e,className:"create-ui-btn"},{name:"ignore",label:b.options.localize("Ignore",b.options.language),cb:f,className:"create-ui-btn"}],callbacks:{beforeShow:function(){window.Mousetrap&&(window.Mousetrap.bind(["command+shift+r","ctrl+shift+r"],function(a){a.preventDefault(),e()}),window.Mousetrap.bind(["command+shift+i","ctrl+shift+i"],function(a){a.preventDefault(),f()}))},afterClose:function(){window.Mousetrap&&(window.Mousetrap.unbind(["command+shift+r","ctrl+shift+r"]),window.Mousetrap.unbind(["command+shift+i","ctrl+shift+i"]))}}})}},restoreLocalAll:function(){_.each(this.restorables,function(a){this.readLocal(a)},this),this.restorables=[]},ignoreLocal:function(){this.options.removeLocalstorageOnIgnore&&_.each(this.restorables,function(a){this._removeLocal(a)},this),this.restorables=[]},saveReferences:function(a){_.each(a.attributes,function(a){a&&a.isCollection&&a.each(function(a){return-1===this.changedModels.indexOf(a)?a.isNew()&&this.options.saveReferencedNew?a.save():a.hasChanged()&&this.options.saveReferencedChanged?a.save():void 0:void 0},this)},this)},saveRemote:function(a,b){this.saveReferences(a),this._trigger("saveentity",null,{entity:a,options:b});var c=this,d=a.midgardStorageVersion;a.save(null,_.extend({},b,{success:function(e,f){a._originalAttributes=_.clone(a.attributes),c._removeLocal(a),window.setTimeout(function(){a.midgardStorageVersion==d&&c.changedModels.splice(c.changedModels.indexOf(a),1)},0),_.isFunction(b.success)&&b.success(e,f),c._trigger("savedentity",null,{entity:a,options:b})},error:function(a,c){_.isFunction(b.error)&&b.error(a,c)}}))},saveRemoteAll:function(b){var c=this;if(0!==c.changedModels.length){c._trigger("save",null,{entities:c.changedModels,options:b,models:c.changedModels});var d,e=c.changedModels.length;d=e>1?_.template(c.options.localize("saveSuccessMultiple",c.options.language),{number:e}):_.template(c.options.localize("saveSuccess",c.options.language),{label:c.changedModels[0].getSubjectUri()}),c.disableAutoSave(),_.each(c.changedModels,function(f){this.saveRemote(f,{success:function(f,g){e--,0>=e&&(c._trigger("saved",null,{options:b}),b&&_.isFunction(b.success)&&b.success(f,g),a("body").midgardNotifications("create",{body:d}),c.enableAutoSave())},error:function(d,e){b&&_.isFunction(b.error)&&b.error(d,e),a("body").midgardNotifications("create",{body:_.template(c.options.localize("saveError",c.options.language),{error:e.responseText||""}),timeout:0}),c._trigger("error",null,{instance:f})}})},this)}},_saveLocal:function(a){if(this.options.localStorage){if(a.isNew()){if(!a.primaryCollection)return;return this._saveLocalReferences(a.primaryCollection.subject,a.primaryCollection.predicate,a)}var b=this.options.storagePrefix+a.getSubjectUri();window.localStorage.setItem(b,JSON.stringify(a.toJSONLD()))}},_getReferenceId:function(a,b){return a.id+":"+b},_saveLocalReferences:function(a,b,c){if(this.options.localStorage&&a&&b){var d=this.options.storagePrefix+a+":"+b,e=c.toJSONLD();if(window.localStorage.getItem(d)){var f=JSON.parse(window.localStorage.getItem(d)),g=_.pluck(f,"@").indexOf(e["@"]);return-1!==g?f[g]=e:f.push(e),void window.localStorage.setItem(d,JSON.stringify(f))}window.localStorage.setItem(d,JSON.stringify([e]))}},_checkLocal:function(a){if(!this.options.localStorage)return!1;var b=this.options.storagePrefix+a.getSubjectUri(),c=window.localStorage.getItem(b);return c?!0:!1},hasLocal:function(a){if(!this.options.localStorage)return!1;var b=this.options.storagePrefix+a.getSubjectUri();return window.localStorage.getItem(b)?!0:!1},readLocal:function(a){if(this.options.localStorage){var b=this.options.storagePrefix+a.getSubjectUri(),c=window.localStorage.getItem(b);if(c){a._originalAttributes||(a._originalAttributes=_.clone(a.attributes));var d=JSON.parse(c),e=this.vie.entities.addOrUpdate(d,{overrideAttributes:!0});this._trigger("loaded",null,{instance:e})}}},_readLocalReferences:function(a,b,c){if(this.options.localStorage){var d=this.options.storagePrefix+this._getReferenceId(a,b),e=window.localStorage.getItem(d);e&&c.add(JSON.parse(e))}},revertChanges:function(a){var b=this;if(a)return _.each(a.attributes,function(a){if(a instanceof b.vie.Collection){var c=[];a.forEach(function(a){a.isNew()&&c.push(a)}),a.remove(c)}}),a.changedAttributes()?void a.set(a.previousAttributes()):void(a._originalAttributes&&a.set(a._originalAttributes))},_removeLocal:function(a){if(this.options.localStorage){var b=this.options.storagePrefix+a.getSubjectUri();window.localStorage.removeItem(b)}}})}(jQuery),function(a){"use strict";a.widget("Midgard.midgardToolbar",{options:{display:"full",templates:{minimized:'<div class="create-ui-logo"><a class="create-ui-toggle" id="create-ui-toggle-toolbar"></a></div>',full:'<div class="create-ui-toolbar-wrapper"><div class="create-ui-toolbar-toolarea"><%= dynamic %><%= status %></div></div>',toolcontainer:'<div class="create-ui-toolbar-<%= name %>toolarea"><ul class="create-ui-<%= name %>tools"><%= content %></ul></div>',toolarea:'<li class="create-ui-tool-<%= name %>area"></li>'}},_create:function(){this.element.append(this._getMinimized()),this.element.append(this._getFull());var b=this;a(".create-ui-toggle",this.element).click(function(){b.setDisplay("full"===b.options.display?"minimized":"full")}),a(this.element).on("midgardcreatestatechange",function(a,c){"browse"==c.state&&b._clearWorkflows()}),a(this.element).on("midgardworkflowschanged",function(c,d){b._clearWorkflows(),d.workflows.length&&d.workflows.each(function(c){var e=a("body").data("Midgard-midgardWorkflows");e||(e=a("body").data("midgardWorkflows"));var f=e.prepareItem(d.instance,c,function(a){b._clearWorkflows(),a});a(".create-ui-tool-workflowarea",b.element).append(f)})})},_init:function(){this.setDisplay(this.options.display)},setDisplay:function(a){a!==this.options.display&&("minimized"===a?(this.hide(),this.options.display="minimized"):(this.show(),this.options.display="full"),this._trigger("statechange",null,this.options))},hide:function(){a("div.create-ui-toolbar-wrapper").fadeToggle("fast","linear")},show:function(){a("div.create-ui-toolbar-wrapper").fadeToggle("fast","linear")},_getMinimized:function(){return a(_.template(this.options.templates.minimized,{}))},_getFull:function(){return a(_.template(this.options.templates.full,{dynamic:_.template(this.options.templates.toolcontainer,{name:"dynamic",content:_.template(this.options.templates.toolarea,{name:"metadata"})+_.template(this.options.templates.toolarea,{name:"workflow"})+_.template(this.options.templates.toolarea,{name:"free"})}),status:_.template(this.options.templates.toolcontainer,{name:"status",content:""})}))},_clearWorkflows:function(){a(".create-ui-tool-workflowarea",this.element).empty()}})}(jQuery),function(a){"use strict";a.widget("Midgard.midgardWorkflows",{options:{url:function(){},templates:{button:'<button class="create-ui-btn" id="<%= id %>"><%= label %></button>'},renderers:{button:function(b,c,d,e){var f="midgardcreate-workflow_"+c.get("name"),g=a(_.template(this.options.templates.button,{id:f,label:c.get("label")})).button();return g.on("click",function(){d(b,c,e)}),g}},action_types:{backbone_save:function(a,b,c){var d=a.url,e=a.clone();e.url=d;var f=b.get("action");f.url&&(a.url=f.url),e.save(null,{success:function(){a.url=d,a.change(),c(null,a)},error:function(b,e){a.url=d,a.change(),c(e,a)}})},backbone_destroy:function(a,b,c){var d=a.url,e=a.clone();e.url=d;var f=b.get("action");f.url&&(a.url=f.url),a.destroy({success:function(b){a.url=d,a.change(),c(null,b)},error:function(b,e){a.url=d,a.change(),c(e,a)}})},http:function(b,c,d){var e=c.get("action");if(!e.url)return d("No action url defined!");var f={};e.http&&(f=e.http);var g=a.extend({url:e.url,type:"POST",data:b.toJSON(),success:function(){b.fetch({success:function(a){d(null,a)},error:function(a,b){d(b,a)}})}},f);a.ajax(g)}}},_init:function(){this._renderers={},this._action_types={},this._parseRenderersAndTypes(),this._last_instance=null,this.ModelWorkflowModel=Backbone.Model.extend({defaults:{name:"",label:"",type:"button",action:{type:"backbone_save"}}}),this.workflows={};var b=this;a(this.element).on("midgardeditableactivated",function(a,c){b._fetchWorkflows(c.instance)})},_fetchWorkflows:function(a){var b=this;if(a.isNew())return void b._trigger("changed",null,{instance:a,workflows:[]});if(b._last_instance==a)return void(b.workflows[a.cid]&&b._trigger("changed",null,{instance:a,workflows:b.workflows[a.cid]}));if(b._last_instance=a,b.workflows[a.cid])return void b._trigger("changed",null,{instance:a,workflows:b.workflows[a.cid]});if(b.options.url)b._fetchModelWorkflows(a);else{var c=new(b._generateCollectionFor(a))([],{});b._trigger("changed",null,{instance:a,workflows:c})}},_parseRenderersAndTypes:function(){var b=this;a.each(this.options.renderers,function(a,c){b.setRenderer(a,c)}),a.each(this.options.action_types,function(a,c){b.setActionType(a,c)})},setRenderer:function(a,b){this._renderers[a]=b},getRenderer:function(a){return this._renderers[a]?this._renderers[a]:!1},setActionType:function(a,b){this._action_types[a]=b},getActionType:function(a){return this._action_types[a]},prepareItem:function(a,b,c){var d=this,e=this.getRenderer(b.get("type")),f=this.getActionType(b.get("action").type);return e.call(this,a,b,f,function(e,f){delete d.workflows[a.cid],d._last_instance=null,"backbone_destroy"!==b.get("action").type&&d._fetchModelWorkflows(a),c(e,f)})},_generateCollectionFor:function(a){var b={model:this.ModelWorkflowModel};return this.options.url&&(b.url=this.options.url(a)),Backbone.Collection.extend(b)},_fetchModelWorkflows:function(a){if(!a.isNew()){var b=this;b.workflows[a.cid]=new(this._generateCollectionFor(a))([],{}),b.workflows[a.cid].fetch({success:function(c){b.workflows[a.cid].reset(c.models),b._trigger("changed",null,{instance:a,workflows:b.workflows[a.cid]})},error:function(){}})}}})}(jQuery),void 0===window.midgardCreate&&(window.midgardCreate={}),window.midgardCreate.localize=function(a,b){return window.midgardCreate.locale?window.midgardCreate.locale[b]&&window.midgardCreate.locale[b][a]?window.midgardCreate.locale[b][a]:window.midgardCreate.locale.en[a]?window.midgardCreate.locale.en[a]:a:a},function(a,b){"use strict";a.widget("Midgard.midgardCollectionAdd",{options:{editingWidgets:null,collection:null,model:null,definition:null,view:null,disabled:!1,vie:null,editableOptions:null,templates:{button:'<button class="btn"><i class="icon-<%= icon %>"></i> <%= label %></button>'}},_create:function(){this.addButtons=[];var a=this;if(!a.options.collection.localStorage)try{a.options.collection.url=a.options.model.url()}catch(b){window.console&&console.log(b)}a.options.collection.on("add",function(b){b.primaryCollection=a.options.collection,a.options.vie.entities.add(b),b.collection=a.options.collection}),a.options.collection.on("add remove reset",a.checkCollectionConstraints,a),a._bindCollectionView(a.options.view)},_bindCollectionView:function(a){var b=this;a.on("add",function(a){a.$el.effect("slide",function(){b._makeEditable(a)})})},_makeEditable:function(a){this.options.editableOptions.disabled=this.options.disabled,this.options.editableOptions.model=a.model,a.$el.midgardEditable(this.options.editableOptions)},_init:function(){return this.options.disabled?void this.disable():void this.enable()},hideButtons:function(){_.each(this.addButtons,function(a){a.hide()})},showButtons:function(){_.each(this.addButtons,function(a){a.show()})},checkCollectionConstraints:function(){return this.options.disabled?void 0:this.options.view.canAdd()?this.options.definition&&this.options.definition.max&&-1!==this.options.definition.max?this.options.collection.length<this.options.definition.max?void this.showButtons():void this.hideButtons():void this.showButtons():void this.hideButtons()},enable:function(){var b=this,c=a(_.template(this.options.templates.button,{icon:"plus",label:this.options.editableOptions.localize("Add",this.options.editableOptions.language)})).button();c.addClass("midgard-create-add"),c.click(function(){b.addItem(c)}),a(b.options.view.el).after(c),b.addButtons.push(c),b.checkCollectionConstraints()},disable:function(){_.each(this.addButtons,function(a){a.remove()}),this.addButtons=[]},_getTypeActions:function(a){var b=this,c=[];return _.each(this.options.definition.range,function(d){var e=b.options.collection.vie.namespaces.uri(d);b.options.view.canAdd(e)&&c.push({name:d,label:d,cb:function(){b.options.collection.add({"@type":d},a)},className:"create-ui-btn"})}),c},addItem:function(c,d){d===b&&(d={});var e=_.extend({},d,{validate:!1}),f={};if(this.options.definition&&this.options.definition.range){if(1!==this.options.definition.range.length)return void a("body").midgardNotifications("create",{bindTo:c,gravity:"L",body:this.options.editableOptions.localize("Choose type to add",this.options.editableOptions.language),timeout:0,actions:this._getTypeActions(e)});f["@type"]=this.options.definition.range[0]}else{var g=_.keys(this.options.view.templates);2==g.length&&(f["@type"]=g[0])}this.options.collection.add(f,e)}})}(jQuery),function(a){"use strict";a.widget("Midgard.midgardCollectionAddBetween",a.Midgard.midgardCollectionAdd,{_bindCollectionView:function(a){var b=this;a.on("add",function(a){b._makeEditable(a),b._refreshButtons()}),a.on("remove",function(){b._refreshButtons()})},_refreshButtons:function(){var a=this;window.setTimeout(function(){a.disable(),a.enable()},1)},prepareButton:function(b){var c=this,d=a(_.template(this.options.templates.button,{icon:"plus",label:""})).button();return d.addClass("midgard-create-add"),d.click(function(){c.addItem(d,{at:b})}),d},enable:function(){var b=this,c=b.prepareButton(0);a(b.options.view.el).prepend(c),b.addButtons.push(c),a.each(b.options.view.entityViews,function(c,d){var e=b.options.collection.indexOf(d.model),f=b.prepareButton(e+1);a(d.el).append(f),b.addButtons.push(f)}),this.checkCollectionConstraints()},disable:function(){var b=this;a.each(b.addButtons,function(a,b){b.remove()}),b.addButtons=[]}})}(jQuery),function(a){"use strict";a.widget("Midgard.editWidget",{options:{disabled:!1,vie:null},enable:function(){this.element.attr("contenteditable","true")},disable:function(){this.element.attr("contenteditable","false")},_create:function(){this._registerWidget(),this._initialize(),_.isFunction(this.options.decorate)&&_.isFunction(this.options.decorateParams)&&this.options.decorate(this.options.decorateParams(null,{propertyName:this.options.property,propertyEditor:this,propertyElement:this.element,editor:this,predicate:this.options.property,element:this.element}))},_init:function(){return this.options.disabled?void this.disable():void this.enable()},_initialize:function(){var b=this;this.element.on("focus",function(){b.options.disabled||b.options.activated()}),this.element.on("blur",function(){b.options.disabled||b.options.deactivated()});var c=this.element.text();this.element.on("keyup paste",function(){if(!b.options.disabled){var d=a(this).text();c!==d&&(c=d,b.options.changed(d))}})},_registerWidget:function(){this.element.data("createWidgetName",this.widgetName)}})}(jQuery),function(a){"use strict";a.widget("Midgard.alohaWidget",a.Midgard.editWidget,{_initialize:function(){},enable:function(){function a(){Aloha.activeEditable.isModified()&&(c.changed(Aloha.activeEditable.getContents()),Aloha.activeEditable.setUnmodified())}var b,c=this.options,d=Aloha.jQuery(c.element.get(0)).aloha();if(_.each(Aloha.editables,function(a){a.obj.get(0)===d.get(0)&&(b=a)}),b){b.vieEntity=c.entity;var e;Aloha.bind("aloha-editable-activated",function(d,f){f.editable===b&&(e=window.setInterval(a,500),c.activated())}),Aloha.bind("aloha-editable-deactivated",function(a,d){d.editable===b&&(window.clearInterval(e),c.deactivated())}),Aloha.bind("aloha-smart-content-changed",function(a,d){if(d.editable===b){if(!d.editable.isModified())return!0;c.changed(d.editable.getContents()),d.editable.setUnmodified()}}),this.options.disabled=!1}},disable:function(){Aloha.jQuery(this.options.element.get(0)).mahalo(),this.options.disabled=!0}})}(jQuery),function(a){"use strict";a.widget("Midgard.ckeditorWidget",a.Midgard.editWidget,{options:{editorOptions:{},disabled:!0,vie:null},enable:function(){this.element.attr("contentEditable","true"),this.editor=CKEDITOR.inline(this.element.get(0)),this.options.disabled=!1;var b=this;this.editor.on("focus",function(){b.options.activated()}),this.editor.on("blur",function(){b.options.activated(),b.options.changed(b.editor.getData())}),this.editor.on("change",function(){b.options.changed(b.editor.getData())}),this.editor.on("configLoaded",function(){a.each(b.options.editorOptions,function(a,c){b.editor.config[a]=c})})},disable:function(){this.editor&&(this.element.attr("contentEditable","false"),this.editor.destroy(),this.editor=null)},_initialize:function(){CKEDITOR.disableAutoInline=!0}})}(jQuery),function(a){"use strict";a.widget("Midgard.halloWidget",a.Midgard.editWidget,{options:{editorOptions:{},disabled:!0,toolbarState:"full",vie:null,entity:null},enable:function(){a(this.element).hallo({editable:!0}),this.options.disabled=!1},disable:function(){a(this.element).hallo({editable:!1}),this.options.disabled=!0},_initialize:function(){a(this.element).hallo(this.getHalloOptions());var b=this;a(this.element).on("halloactivated",function(){b.options.activated()}),a(this.element).on("hallodeactivated",function(){b.options.deactivated()}),a(this.element).on("hallomodified",function(a,c){b.options.changed(c.content),c.editable.setUnmodified()}),a(document).on("midgardtoolbarstatechange",function(a,c){if(c.display!==b.options.toolbarState&&(b.options.toolbarState=c.display,b.element.data("IKS-hallo")||b.element.data("hallo"))){var d=b.getHalloOptions();b.element.hallo("changeToolbar",d.parentElement,d.toolbar,!0)}})},getHalloOptions:function(){var b={plugins:{halloformat:{},halloblock:{},hallolists:{},hallolink:{},halloimage:{entity:this.options.entity}},buttonCssClass:"create-ui-btn-small",placeholder:"["+this.options.property+"]"};return"function"==typeof this.element.annotate&&this.options.vie.services.stanbol&&(b.plugins.halloannotate={vie:this.options.vie}),"full"===this.options.toolbarState?(b.parentElement=a(".create-ui-toolbar-dynamictoolarea .create-ui-tool-freearea"),b.toolbar="halloToolbarFixed"):(b.parentElement="body",b.toolbar="halloToolbarContextual"),_.extend(b,this.options.editorOptions)}})}(jQuery),function(a){"use strict";a.widget("Midgard.mediumWidget",a.Midgard.editWidget,{editor:null,listener:null,options:{editorOptions:{},disabled:!0},enable:function(){this.editor=new MediumEditor(this._buildSelector(),this.editorOptions),this.listener=function(){this.options.changed(a(this.element).text())}.bind(this),a(this.element).on("keyup",this.listener)},disable:function(){a(this.element).off("keyup",this.listener)},_buildSelector:function(){var a='[about="'+this.options.entity.getSubjectUri()+'"]',b='[property="'+this.options.property+'"]';return a+" "+b}})}(jQuery),function(a){"use strict";a.widget("Midgard.redactorWidget",a.Midgard.editWidget,{editor:null,options:{editorOptions:{},disabled:!0},enable:function(){a(this.element).redactor(this.getRedactorOptions()),this.options.disabled=!1},disable:function(){a(this.element).destroyEditor(),this.options.disabled=!0},_initialize:function(){var b=this;a(this.element).on("focus",function(){b.options.activated()})},getRedactorOptions:function(){var b=this,c={keyupCallback:function(){b.options.changed(a(b.element).getCode())},execCommandCallback:function(){b.options.changed(a(b.element).getCode())}};return _.extend(b.options.editorOptions,c)}})}(jQuery),function(a){"use strict";a.widget("Midgard.tinymceWidget",a.Midgard.editWidget,{enable:function(){this.element.attr("contentEditable","true");var a=this.element.attr("id");(!a||tinymce.get(a))&&(a=tinymce.DOM.uniqueId()),this.element.attr("id",a),this.editor=new tinymce.Editor(a,{inline:!0},tinymce.EditorManager),this.editor.render(!0),this.options.disabled=!1;var b=this;this.editor.on("focus",function(){b.options.activated()}),this.editor.on("blur",function(){b.options.activated(),b.options.changed(b.editor.getContent())}),this.editor.on("change",function(){b.options.changed(b.editor.getContent())})},disable:function(){this.editor&&(this.element.attr("contentEditable","false"),this.editor.remove(),this.editor=null)}})}(jQuery),function(a){"use strict";a.widget("Midgard.midgardGeo",{options:{layer:null,map:null,coordSystem:"EPSG:4326",defaultCenter:null,defaultZoomLevel:3,geoProperty:"http://schema.org/geo",geoCoordinateType:"http://schema.org/GeoCoordinates",geoLonProperty:"http://schema.org/longitude",geoLatProperty:"http://schema.org/latitude",marker:{url:"http://www.openlayers.org/dev/img/marker.png",size:{w:21,h:25},offset:{w:-10,h:-25}}},data:{},coordsObj:null,activate:function(a){this.data=a,this.coordsObj=null;var b=this.data.entity.get(this.options.geoProperty);if(_.isUndefined(b)){var c=this.data.entity.attributes["@type"];_.isArray(c)||(c=[c]),_.indexOf(c,"<"+this.options.geoCoordinateType+">")>0&&(this.coordsObj=this.data.entity)}else this.coordsObj=b.models[0];if(_.isNull(this.coordsObj))return void this.element.hide();this.element.show();var d=parseFloat(this.coordsObj.get(this.options.geoLatProperty)),e=parseFloat(this.coordsObj.get(this.options.geoLonProperty));this.centerMap(e,d)},_createMap:function(){if(_.isNull(this.options.map)){var b=this,c=a("<div>",{id:"midgardGeoMap",style:"height:200px; width:300px"});this.element.append(c),this.options.map=new OpenLayers.Map("midgardGeoMap"),_.isNull(this.options.layer)&&(this.options.layer=new OpenLayers.Layer.OSM("OSM")),this.options.map.addLayer(this.options.layer),this.options.markers=new OpenLayers.Layer.Markers("Markers"),this.options.map.addLayer(this.options.markers),OpenLayers.Control.Click=OpenLayers.Class(OpenLayers.Control,{defaultHandlerOptions:{single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1},initialize:function(){this.handlerOptions=OpenLayers.Util.extend({},this.defaultHandlerOptions),OpenLayers.Control.prototype.initialize.apply(this,arguments),this.handler=new OpenLayers.Handler.Click(this,{click:function(a){b.mapClick(a)}},this.handlerOptions)}});var d=new OpenLayers.Control.Click;this.options.map.addControl(d),d.activate();var e=this.options.defaultCenter.clone();e.transform(new OpenLayers.Projection(this.options.coordSystem),this.options.map.getProjectionObject()),this.options.map.setCenter(e,this.options.defaultZoomLevel)}},mapClick:function(a){var b=this.options.map.getLonLatFromPixel(a.xy);b.transform(this.options.map.getProjectionObject(),new OpenLayers.Projection(this.options.coordSystem));var c=b.clone();this.centerMap(c.lon,c.lat),this.setCoordinates(b.lat,b.lon)},disable:function(){},setCoordinates:function(a,b){var c=this.data.entity.get(this.options.geoProperty),d=c.models[0];d.set(this.options.geoLatProperty,a),d.set(this.options.geoLonProperty,b)},_init:function(){this.element.hide(),this.element.append(a("<h3>GEO</h3>")),_.isNull(this.options.defaultCenter)&&(this.options.defaultCenter=new OpenLayers.LonLat(0,0)),this._createMap()},centerMap:function(a,b){var c=new OpenLayers.LonLat(a,b).transform(new OpenLayers.Projection(this.options.coordSystem),this.options.map.getProjectionObject());this.options.centermark&&this.options.centermark.destroy();var d=new OpenLayers.Size(this.options.marker.size.w,this.options.marker.size.h),e=new OpenLayers.Pixel(this.options.marker.offset.w,this.options.marker.offset.h),f=new OpenLayers.Icon(this.options.marker.url,d,e);this.options.centermark=new OpenLayers.Marker(c,f),this.options.markers.addMarker(this.options.centermark),this.options.map.panTo(c)}})}(jQuery),function(a,b){"use strict";a.widget("Midgard.midgardTags",{enhanced:!1,options:{predicate:"skos:related",vie:null,templates:{tags:'<div class="create-ui-tags <%= type %>Tags"><h3><%= label %></h3><input type="text" class="tags" value="" /></div>'},localize:function(a,b){return window.midgardCreate.localize(a,b)},language:null},_init:function(){this.vie=this.options.vie},activate:function(a){var b=this._render(a.entity);this.loadTags(a.entity,a.predicate,b)},_normalizeSubject:function(a){return this.vie.entities.isReference(a)?a:("http://"!==a.substr(0,7)&&(a="urn:tag:"+a),a=this.vie.entities.toReference(a))},_tagLabel:function(a){return a=this.vie.entities.fromReference(a),"urn:tag:"===a.substr(0,8)&&(a=a.substr(8,a.length-1)),"http://"==a.substring(0,7)&&(a=a.substr(a.lastIndexOf("/")+1,a.length-1),a=a.replace(/_/g," ")),a},addTag:function(a,c,d,e){d===b&&(d=this._tagLabel(c)),c=this._normalizeSubject(c);var f=a.get(this.options.predicate);if(!(f&&f.isCollection&&f.get(c))){e&&!a.isReference(e)&&(e=a.toReference(e));var g=this.vie.entities.addOrUpdate({"@subject":c,"rdfs:label":d,"@type":e});return f?void f.addOrUpdate(g):void a.set(this.options.predicate,g)}},removeTag:function(a,b){var c=a.get(this.options.predicate);if(c){b=this._normalizeSubject(b);var d=c.get(b);d&&c.remove(b)}},_listenAnnotate:function(a,b){var c=this;b.on("annotateselect",function(b,d){c.addTag(a,d.linkedEntity.uri,d.linkedEntity.label,d.linkedEntity.type[0])}),b.on("annotateremove",function(b,d){c.removeTag(a,d.linkedEntity.uri)})},_render:function(b){this.element.empty();var c=a(_.template(this.options.templates.tags,{type:"article",label:this.options.localize("Item tags",this.options.language)})),d=a(_.template(this.options.templates.tags,{type:"suggested",label:this.options.localize("Suggested tags",this.options.language)}));return a("input",c).attr("id","articleTags-"+b.cid),a("input",d).attr("id","suggestedTags-"+b.cid),this.element.append(c),this.element.append(d),this._renderInputs(b,c,d),{tags:c,suggested:d}},_renderInputs:function(b,c,d){{var e=this;b.getSubject()}c.tagsInput({width:"auto",height:"auto",onAddTag:function(a){e.addTag(b,a)},onRemoveTag:function(a){e.removeTag(b,a)},defaultText:this.options.localize("add a tag",this.options.language)});var f=function(){var c=a.trim(a(this).text());e.addTag(b,c),d.removeTag(c)};d.tagsInput({width:"auto",height:"auto",interactive:!1,onAddTag:function(){a(".tag span",d).off("click",f),a(".tag span",d).on("click",f)},onRemoveTag:function(){a(".tag span",d).off("click",f),a(".tag span",d).on("click",f)},remove:!1})},_getTagStrings:function(a){var b=[];return _.isString(a)?(b.push(a),b):a.isCollection?(a.each(function(a){b.push(a.get("rdfs:label"))}),b):(_.each(a,function(a){b.push(this._tagLabel(a))},this),b)},loadTags:function(b,c,d){var e=this,f=b.get(this.options.predicate);if(f){var g=this._getTagStrings(f);_.each(g,d.tags.addTag,d.tags)}this.vie.services.stanbol||a(".suggestedTags",e.element).hide()},_getLabelLang:function(a){if(!_.isArray(a))return null;var b;return _.each(a,function(a){"en"===a["@language"]&&(b=a["@value"])}),b},_addEnhancement:function(a,b){if(b.isEntity){var c=this._getLabelLang(b.get("rdfs:label"));
if(c){var d=a.get(this.options.predicate);d&&d.isCollection&&-1!==d.indexOf(b)||this.suggestedTags.addTag(c)}}},enhance:function(b,c){if(!this.enhanced){this.enhanced=!0;var d=this;this.vie.analyze({element:a("[property]",c)}).using(["stanbol"]).execute().success(function(a){_.each(a,function(a){d._addEnhancement(b,a)})}).fail(function(){})}}})}(jQuery),void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.bg={Save:"",Saving:"",Cancel:"",Edit:"",localModification:' "<%= label %>"   ',localModifications:"<%= number %>       ",Restore:"",Ignore:"",saveSuccess:' "<%= label %>"   ',saveSuccessMultiple:"<%= number %>    ",saveError:"   <br /><%= error %>","Item tags":"  ","Suggested tags":" ",Tags:"","add a tag":" ",Add:"","Choose type to add":"   "},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.cs={Save:"Uloit",Saving:"Probh ukldn",Cancel:"Zruit",Edit:"Upravit",localModification:'Blok "<%= label %>" obsahuje lokln zmny',localModifications:"<%= number %> blok na tto strnce m lokln zmny",Restore:"Aplikovat lokln zmny",Ignore:"Zahodit lokln zmny",saveSuccess:'Blok "<%= label %>" byl spn uloen',saveSuccessMultiple:"<%= number %> blok bylo spn uloeno",saveError:"Pi ukldn dolo k chyb<br /><%= error %>","Item tags":"ttky bloku","Suggested tags":"Navrhovan ttky",Tags:"ttky","add a tag":"Pidat ttek",Add:"Pidat","Choose type to add":"Vyberte typ k pidn"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.da={Save:"Gem",Saving:"Gemmer",Cancel:"Annullr",Edit:"Rediger",localModification:'Element "<%= label %>" har lokale ndringer',localModifications:"<%= number %> elementer p denne side har lokale ndringer",Restore:"Gendan",Ignore:"Ignorer",saveSuccess:'Element "<%= label %>" er gemt',saveSuccessMultiple:"<%= number %> elementer er gemt",saveError:"Der opstod en fejl under lagring<br /><%= error %>","Item tags":"Element tags","Suggested tags":"Foreslede tags",Tags:"Tags","add a tag":"tilfj et tag",Add:"Tilfj","Choose type to add":"Vlg type der skal tilfjes"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.de={Save:"Speichern",Saving:"Speichert",Cancel:"Abbrechen",Edit:"Bearbeiten",localModification:'Das Dokument "<%= label %>" auf dieser Seite hat lokale nderungen',localModifications:"<%= number %> Dokumente auf dieser Seite haben lokale nderungen",Restore:"Wiederherstellen",Ignore:"Ignorieren",saveSuccess:'Dokument "<%= label %>" erfolgreich gespeichert',saveSuccessMultiple:"<%= number %> Dokumente erfolgreich gespeichert",saveError:"Fehler beim Speichern<br /><%= error %>","Item tags":"Schlagwrter des Dokuments","Suggested tags":"Schlagwortvorschlge",Tags:"Schlagwrter","add a tag":"Neues Schlagwort",Add:"Hinzufgen","Choose type to add":"Typ zum Hinzufgen whlen"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.en={Save:"Save",Saving:"Saving",Cancel:"Cancel",Edit:"Edit",localModification:'Item "<%= label %>" has local modifications',localModifications:"<%= number %> items on this page have local modifications",Restore:"Restore",Ignore:"Ignore",saveSuccess:'Item "<%= label %>" saved successfully',saveSuccessMultiple:"<%= number %> items saved successfully",saveError:"Error occurred while saving<br /><%= error %>","Item tags":"Item tags","Suggested tags":"Suggested tags",Tags:"Tags","add a tag":"add a tag",Add:"Add","Choose type to add":"Choose type to add"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.es={Save:"Guardar",Saving:"Guardando",Cancel:"Cancelar",Edit:"Editar",localModification:'El elemento "<%= label %>" tiene modificaciones locales',localModifications:"<%= number %> elementos en la pgina tienen modificaciones locales",Restore:"Restaurar",Ignore:"Ignorar",saveSuccess:'El elemento "<%= label %>" se guard exitosamente',saveSuccessMultiple:"<%= number %> elementos se guardaron exitosamente",saveError:"Ha ocurrido un error cuando se guardaban los datos<br /><%= error %>","Item tags":"Etiquetas de los elementos","Suggested tags":"Etiquetas sugeridas",Tags:"Etiquetas","add a tag":"aadir una etiqueta",Add:"Aadir","Choose type to add":"Escoge el tipo a aadir"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.fi={Save:"Tallenna",Saving:"Tallennetaan",Cancel:"Peruuta",Edit:"Muokkaa",localModification:'Dokumentilla "<%= label %>" on paikallisia muutoksia',localModifications:"<%= number %> dokumenttia sivulla omaa paikallisia muutoksia",Restore:"Palauta",Ignore:"Poista",saveSuccess:'Dokumentti "<%= label %>" tallennettu',saveSuccessMultiple:"<%= number %> dokumenttia tallennettu",saveError:"Virhe tallennettaessa<br /><%= error %>","Item tags":"Avainsanat","Suggested tags":"Ehdotukset",Tags:"Avainsanat","add a tag":"lis avainsana",Add:"Lis","Choose type to add":"Mit haluat list?"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.fr={Save:"Enregistrer",Saving:"Enregistrement en cours",Cancel:"Annuler",Edit:"diter",localModification:'L\'lment "<%= label %>" comporte des modifications locales',localModifications:"<%= number %> lments sur cette page comportent des modifications locales",Restore:"Restaurer",Ignore:"Ignorer",saveSuccess:'L\'lment "<%= label %>" a t enregistr avec succs',saveSuccessMultiple:"<%= number %> lments ont t enregistrs avec succs",saveError:"Une erreur est survenue durant l'enregistrement<br /><%= error %>","Item tags":"Tags des lments","Suggested tags":"Tags suggrs",Tags:"Tags","add a tag":"ajouter un tag",Add:"Ajouter","Choose type to add":"Choisir le type  ajouter"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.he={Save:"",Saving:"",Cancel:"",Edit:"",localModification:' "<%= label %>"  ',localModifications:"<%= number %>     ",Restore:"",Ignore:"",saveSuccess:' "<%= label %>"  ',saveSuccessMultiple:"<%= number %>   ",saveError:" <br /><%= error %>","Item tags":" ","Suggested tags":" ",Tags:"","add a tag":" ",Add:"","Choose type to add":"  "},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.it={Save:"Salva",Saving:"Salvataggio",Cancel:"Cancella",Edit:"Modifica",localModification:'Articolo "<%= label %>" in questa pagina hanno modifiche locali',localModifications:"<%= number %> articoli in questa pagina hanno modifiche locali",Restore:"Ripristina",Ignore:"Ignora",saveSuccess:'Articolo "<%= label %>" salvato con successo',saveSuccessMultiple:"<%= number %> articoli salvati con successo",saveError:"Errore durante il salvataggio<br /><%= error %>","Item tags":"Tags articolo","Suggested tags":"Tags suggerite",Tags:"Tags","add a tag":"Aggiungi una parola chiave",Add:"Aggiungi","Choose type to add":"Scegli il tipo da aggiungere"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.nl={Save:"Opslaan",Saving:"Bezig met opslaan",Cancel:"Annuleren",Edit:"Bewerken",localModification:'Items "<%= label %>" op de pagina heeft lokale wijzigingen',localModifications:"<%= number %> items op de pagina hebben lokale wijzigingen",Restore:"Herstellen",Ignore:"Negeren",saveSuccess:'Item "<%= label %>" succesvol opgeslagen',saveSuccessMultiple:"<%= number %> items succesvol opgeslagen",saveError:"Fout opgetreden bij het opslaan<br /><%= error %>","Item tags":"Item tags","Suggested tags":"Tag suggesties",Tags:"Tags","add a tag":"tag toevoegen",Add:"Toevoegen","Choose type to add":"Kies type om toe te voegen"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.no={Save:"Lagre",Saving:"Lagrer",Cancel:"Avbryt",Edit:"Rediger",localModification:'Element "<%= label %>" p denne siden er modifisert lokalt',localModifications:"<%= number %> elementer p denne siden er modifisert lokalt",Restore:"Gjenopprett",Ignore:"Ignorer",saveSuccess:'Element "<%= label %>" ble lagret',saveSuccessMultiple:"<%= number %> elementer ble lagret",saveError:"En feil oppstod under lagring<br /><%= error %>","Item tags":"Element-tagger","Suggested tags":"Anbefalte tagger",Tags:"Tagger","add a tag":"legg til tagg",Add:"Legg til","Choose type to add":"Velg type  legge til"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.pl={Save:"Zapisz",Saving:"Zapisuj",Cancel:"Anuluj",Edit:"Edytuj",localModification:'Artyku "<%= label %>" posiada lokalne modyfikacje',localModifications:"<%= number %> artykuw na tej stronie posiada lokalne modyfikacje",Restore:"Przywr",Ignore:"Ignoruj",saveSuccess:'Artyku "<%= label %>" zosta poprawnie zapisany',saveSuccessMultiple:"<%= number %> artykuw zostao poprawnie zapisanych",saveError:"Wystpi bd podczas zapisywania<br /><%= error %>","Item tags":"Tagi artykuw","Suggested tags":"Sugerowane tagi",Tags:"Tagi","add a tag":"dodaj tag",Add:"Dodaj","Choose type to add":"Wybierz typ do dodania"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.pt_BR={Save:"Salvar",Saving:"Salvando",Cancel:"Cancelar",Edit:"Editar",localModification:'Item "<%= label %>" nesta pgina possuem modificaes locais',localModifications:"<%= number %> itens nesta pgina possuem modificaes locais",Restore:"Restaurar",Ignore:"Ignorar",saveSuccess:'Item "<%= label %>" salvo com sucesso',saveSuccessMultiple:"<%= number %> itens salvos com sucesso",saveError:"Erro ocorrido ao salvar<br /><%= error %>","Item tags":"Tags de item","Suggested tags":"Tags sugeridas",Tags:"Tags","add a tag":"adicionar uma tag",Add:"Adicionar","Choose type to add":"Selecione o tipo para adicionar"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.ro={Save:"Salveaz",Saving:"Se salveaz",Cancel:"Anuleaz",Edit:"Editare",localModification:'Zona "<%= label %>" a fost modificat',localModifications:"<%= number %> zone din aceast pagin au fost modificate",Restore:"Revenire",Ignore:"Ignor",saveSuccess:'Zona "<%= label %>" a fost salvat',saveSuccessMultiple:"<%= number %> zone au fost salvate",saveError:"S-a produs o eroare n timpul salvrii<br /><%= error %>","Item tags":"Etichetele zonei","Suggested tags":"Etichete sugerate",Tags:"Etichete","add a tag":"adaug o etichet",Add:"Adugare","Choose type to add":"Alegei un tip pentru adugare"},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.ru={Save:"",Saving:"",Cancel:"",Edit:"",localModification:'  "<%= label %>"   ',localModifications:"     (<%= number %> .)   ",Restore:"",Ignore:"",saveSuccess:' "<%= label %>"   ',saveSuccessMultiple:"  (<%= number %> .)   ",saveError:"    <br /><%= error %>","Item tags":" ","Suggested tags":" ",Tags:"","add a tag":" ",Add:"","Choose type to add":"   "},void 0===window.midgardCreate&&(window.midgardCreate={}),void 0===window.midgardCreate.locale&&(window.midgardCreate.locale={}),window.midgardCreate.locale.sv={Save:"Spara",Saving:"Sparar",Cancel:"Avbryt",Edit:"Redigera",localModification:'Elementet "<%= label %>" har lokala frndringar',localModifications:"<%= number %> element p den hr sidan har lokala frndringar",Restore:"terstll",Ignore:"Ignorera",saveSuccess:'Elementet "<%= label %>" sparades',saveSuccessMultiple:"<%= number %> element sparades",saveError:"Ett fel uppstod under sparande<br /><%= error %>","Item tags":"Element-taggar","Suggested tags":"Freslagna taggar",Tags:"Taggar","add a tag":"lgg till en tagg",Add:"Lgg till","Choose type to add":"Vlj typ att lgga till"};